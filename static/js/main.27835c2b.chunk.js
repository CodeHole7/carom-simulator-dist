(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,i){},19:function(e,t,i){e.exports=i(34)},24:function(e,t,i){},25:function(e,t,i){},32:function(e,t,i){},33:function(e,t,i){},34:function(e,t,i){"use strict";i.r(t);var a=i(3),n=i.n(a),s=i(17),o=i.n(s),l=(i(24),i(25),i(1)),r=i(4),c=i(7),h=i(5),u=i(6),p=i(12),d=(i(13),function(e){function t(e){var i;return Object(l.a)(this,t),(i=Object(c.a)(this,Object(h.a)(t).call(this,e))).viewSelectorItemClicked=i.viewSelectorItemClicked.bind(Object(p.a)(i)),i}return Object(u.a)(t,e),Object(r.a)(t,[{key:"viewSelectorItemClicked",value:function(e){"function"===typeof this.props.viewSelectorItemClicked&&this.props.viewSelectorItemClicked(e)}},{key:"render",value:function(){var e=this,t="view-selector-item",i="view-selector-item";return"2d"===this.props.currentView?t+=" active":i+=" active",n.a.createElement("div",{className:"view-selector"},n.a.createElement("span",{className:t,onClick:function(){e.viewSelectorItemClicked("2d")}},"2D"),n.a.createElement("span",{className:i,onClick:function(){e.viewSelectorItemClicked("3d")}},"3D"))}}]),t}(a.Component)),f=i(14),m=i(2),b="table.babylon",v="bat.babylon",R=396,V=5.715,y=6,k=7,w=8,_=9,M=10,g=11,x=12,N=13,S=14,C=15,P=16,A=function e(){Object(l.a)(this,e),this.played=!1},Y=function e(){Object(l.a)(this,e)},B=function e(t,i){var a=this;Object(l.a)(this,e),this.delta_fgpas=.004375,this.RSG=1,this.fgpas=.00125,this.EPSILON=.86,this.frpas=3e-5,this.QCQ=2,this.Rfppas=75e-6,this.f1=.25,this.f2=.42,this.Rfp=.15,this.fbille=.05,this.pas=5e-4,this.fp1=.2,this.ARRET=0,this.TSP=3,this.fg=2.5,this.fr=.06,this.choc_bande=function(e){var t=NaN;if(a.X[e]>a.XMIN&&a.X[e]<a.XMAX&&a.Y[e]>a.YMIN&&a.Y[e]<a.YMAX)return!1;if(a.X[e]<a.XMIN&&a.Vx[e]>0)return!1;if(a.X[e]>a.XMAX&&a.Vx[e]<0)return!1;if(a.Y[e]>a.YMAX&&a.Vy[e]<0)return!1;if(a.Y[e]<a.YMIN&&a.Vy[e]>0)return!1;if(0==e&&(!a.choc12||!a.choc13)){var i=a,n=a.nbandes+1;if(i.nbandes=n,!a.choc12&&!a.choc13){i=a,n=a.nb_b_avant+1;i.nb_b_avant=n}}return a.etat[e]==a.RSG?(a.Rp[e]=-a.Vy[e],a.Rq[e]=a.Vx[e]):a.etat[e]==a.QCQ&&(a.Rp[e]=-a.Vy[e]+a.VQy[e],a.Rq[e]=a.Vx[e]-a.VQx[e]),a.init_pars(e),a.VMz=a.VT-a.VRr,a.VN0=-a.VN,a.VN=a.VN*-a.EPSILON,a.deltaVN=a.VN0+a.VN,a.intens=a.VN0/20,a.intens>1&&(a.intens=1),a.beta_adh=2/7*Math.sqrt(a.VMz*a.VMz+a.VRq*a.VRq),a.beta_gliss=a.f1*a.deltaVN,Math.abs(a.VMz)<1e-5?a.alpha_bande=Math.PI/2:a.alpha_bande=Math.abs(Math.atan(a.VRq/a.VMz)),t=Math.abs(a.fp1*a.deltaVN),Math.abs(a.VRp)<t?a.VRp=0:a.VRp>0?a.VRp=a.VRp-t:a.VRp=a.VRp+t,t=Math.abs(a.f2*a.deltaVN),a.VRq=a.VRq+t,a.beta_gliss>a.beta_adh?a.choc_adh(e):a.choc_gliss(e),a.recup_pars(e),a.VQx[e]=a.Vx[e]-a.Rq[e],a.VQy[e]=a.Vy[e]+a.Rp[e],a.etat[e]=a.QCQ,!0},this.fin_parcours=function(){var e=0;for(e=0;e<3;){if(a.etat[e]!=a.ARRET){if(!(a.Vx[e]*a.Vx[e]+a.Vy[e]*a.Vy[e]<a.frpas*a.frpas))return!1;if(!(Math.abs(a.Rr[e])<a.Rfppas))return a.etat[e]=a.TSP,!1;a.etat[e]=a.ARRET;var t=0;a.Vy[e]=0,a.Vx[e]=t;t=0;a.Rr[e]=0,a.Rq[e]=t,a.Rp[e]=t}e++}return!0},this.Calcul=function(e){console.log("parameter",e);var t,i,n=0,s=0,o=NaN,l=[];for(n=0;n<3;){for(a.nb_clefs[n]=0,s=0;s<a.nb_max_clefs;)a.evts[a.nb_max_clefs*n+s]=null,s++;n++}for(a.nb_sons=0,n=0;n<a.nb_max_sons;)a.evts_son[n]=null,n++;for(n=0;n<3;)a.X[n]=e.Xinit[n],a.Y[n]=e.Yinit[n],a.RAp[n]=e.RApInit[n],a.RAq[n]=e.RAqInit[n],a.RAr[n]=e.RArInit[n],a.add_clef(n),n++;a.el=e.el,a.er=e.er,a.alph=e.alphaQ,a.beta=e.betaQ,a.vqueue=e.Vqueue,a.calculs_finis=!1,a.nbandes=0,a.done=!1,a.distance13=2,a.first_bille_choquee=0,a.choc12=!1,a.choc13=!1,a.done=!1,a.deltaclef=a.resolution,a.date=0,a.beta=a.beta+Math.PI,a.Vinit=1.4*a.vqueue*Math.cos(a.alph/1.2),t=-2*a.Vinit/Math.cos(a.alph/1.1)*a.er/a.R;var r=Math.PI/20;o=a.alph>r?Math.PI/2/(Math.PI/2-r)*(a.alph-r):0,i=4*a.vqueue*Math.sin(o)*a.el/a.R,a.Vx[0]=a.Vinit*Math.cos(a.beta),a.Vx0=a.Vx[0],a.Vy[0]=a.Vinit*Math.sin(a.beta),a.Vy0=a.Vy[0];var c=t*Math.sin(a.beta)+i*Math.cos(a.beta);a.Rp[0]=t*Math.sin(a.beta)+i*Math.cos(a.beta),a.p0=c;c=-t*Math.cos(a.beta)+i*Math.sin(a.beta);a.Rq[0]=-t*Math.cos(a.beta)+i*Math.sin(a.beta),a.q0=c;c=2*a.el/a.R*a.Vinit;for(a.Rr[0]=2*a.el/a.R*a.Vinit,a.r0=c,a.VQx[0]=a.Vx[0]-a.Rq[0],a.VQy[0]=a.Vy[0]+a.Rp[0],a.etat[0]=a.QCQ,n=1;n<3;)a.Vx[n]=0,a.Vy[n]=0,a.VQx[n]=0,a.VQy[n]=0,a.Rp[n]=0,a.Rq[n]=0,a.Rr[n]=0,a.etat[n]=a.ARRET,a.add_clef(n),n++;for(a.evts_son[a.nb_sons]=new A,a.evts_son[a.nb_sons].played=!1,a.evts_son[a.nb_sons].temps=0,a.evts_son[a.nb_sons].intensite=a.Vinit/5.4,a.alph>Math.PI/4?a.evts_son[a.nb_sons].type_choc=0:a.evts_son[a.nb_sons].type_choc=1;!a.fin_parcours();)for(a.date+=1,a.choc_billes(l),n=0;n<3;){if(a.etat[n]!=a.ARRET){if(a.choc_bande(n)){a.add_clef(n),a.evts_son[a.nb_sons]=new A,a.evts_son[a.nb_sons].played=!1,a.evts_son[a.nb_sons].temps=a.date*a.pas,a.evts_son[a.nb_sons].intensite=a.intens,a.evts_son[a.nb_sons].type_choc=3;c=a;var h=a.nb_sons+1;c.nb_sons=h}a.mise_a_jour(n)&&a.add_clef(n)}(Math.abs(a.X[n]-a.X0[n])>a.deltaclef||Math.abs(a.Y[n]-a.Y0[n])>a.deltaclef||Math.abs(a.RAp[n]-a.RAp0[n])>a.deltaclefRot||Math.abs(a.RAq[n]-a.RAq0[n])>a.deltaclefRot||Math.abs(a.RAr[n]-a.RAr0[n])>a.deltaclefRot)&&a.add_clef(n),n++}if(a.fin_parcours()){a.calculs_finis=!0;for(n=0;n<3;n++)a.Xfin[n]=a.X[n],a.Yfin[n]=a.Y[n],a.RApfin[n]=a.RAp[n],a.RAqfin[n]=a.RAq[n],a.RArfin[n]=a.RAr[n],a.add_clef(n);a.duree=a.date*a.pas}else for(n=0;n<3;n++)a.add_clef(n);return a.evts},this.mise_a_jour=function(e){var t=NaN,i=NaN,n=NaN,s=NaN,o=NaN;if(0!=a.first_bille_choquee&&(a.nb3=3-a.first_bille_choquee,a.d13=Math.sqrt((a.X[0]-a.X[a.nb3])*(a.X[0]-a.X[a.nb3])+(a.Y[0]-a.Y[a.nb3])*(a.Y[0]-a.Y[a.nb3])),a.d13<a.distance13&&(a.distance13=a.d13)),a.etat[e]==a.RSG){if((t=Math.sqrt(a.Vx[e]*a.Vx[e]+a.Vy[e]*a.Vy[e]))<a.frpas){var l=0;a.Vy[e]=0,a.Vx[e]=l;l=0;if(a.Rq[e]=0,a.Rp[e]=l,Math.abs(a.Rr[e])<a.Rfppas)return a.etat[e]=a.ARRET,a.Rr[e]=0,a.add_clef(e),!0;a.etat[e]=a.TSP}a.etat[e]!=a.TSP&&(i=1-a.frpas/t,a.Vx[e]=a.Vx[e]*i,a.Vy[e]=a.Vy[e]*i,a.Rp[e]=-a.Vy[e],a.Rq[e]=a.Vx[e]),Math.abs(a.Rr[e])<a.Rfppas?a.Rr[e]=0:a.Rr[e]>0?a.Rr[e]=a.Rr[e]-a.Rfppas:a.Rr[e]=a.Rr[e]+a.Rfppas}if(a.etat[e]==a.QCQ&&((n=Math.sqrt(a.VQx[e]*a.VQx[e]+a.VQy[e]*a.VQy[e]))<a.delta_fgpas?a.etat[e]=a.RSG:(s=-a.fgpas*a.VQx[e]/n,o=-a.fgpas*a.VQy[e]/n,a.Vx[e]=a.Vx[e]+s,a.Vy[e]=a.Vy[e]+o,i=1-a.delta_fgpas/n,a.VQx[e]=a.VQx[e]*i,a.VQy[e]=a.VQy[e]*i),a.Rp[e]=-a.Vy[e]+a.VQy[e],a.Rq[e]=a.Vx[e]-a.VQx[e],Math.abs(a.Rr[e])<a.Rfppas?a.Rr[e]=0:a.Rr[e]>0?a.Rr[e]=a.Rr[e]-a.Rfppas:a.Rr[e]=a.Rr[e]+a.Rfppas),a.etat[e]==a.TSP){l=0;a.Vy[e]=0,a.Vx[e]=l;l=0;if(a.Rq[e]=0,a.Rp[e]=l,Math.abs(a.Rr[e])<a.Rfppas)return a.Rr[e]=0,a.etat[e]=a.ARRET,!0;a.Rr[e]>0?a.Rr[e]=a.Rr[e]-2*a.Rfppas:a.Rr[e]=a.Rr[e]+2*a.Rfppas}return a.X[e]=a.X[e]+a.Vx[e]*a.pas,a.Y[e]=a.Y[e]+a.Vy[e]*a.pas,a.RAp[e]=a.RAp[e]+a.Rp[e]*a.pas,a.RAq[e]=a.RAq[e]+a.Rq[e]*a.pas,a.RAr[e]=a.RAr[e]+a.Rr[e]*a.pas,!1},this.choc_gliss=function(e){a.VMz>0?(a.VT=a.VT-a.beta_gliss*Math.cos(a.alpha_bande),a.VRr=a.VRr+2.5*a.beta_gliss*Math.cos(a.alpha_bande)):(a.VT=a.VT+a.beta_gliss*Math.cos(a.alpha_bande),a.VRr=a.VRr-2.5*a.beta_gliss*Math.cos(a.alpha_bande))},this.choc_adh=function(e){var t,i,n=NaN,s=NaN,o=NaN,l=NaN,r=NaN,c=0;n=Math.abs(a.VT)<1e-5?90:180/Math.PI*Math.atan(a.VN0/a.VT),a.effet=100*a.R/2*a.VRr/Math.sqrt(a.VN0*a.VN0+a.VT*a.VT),a.effet<=-1.5?a.effet=-1.499:a.effet>1.5&&(a.effet=1.499),Math.abs(a.VT)<1e-5?s=a.effet>0?a.sorties[28]+(a.sorties[29]-a.sorties[28])*(a.effet/1.5):a.sorties[27]+(a.sorties[28]-a.sorties[27])*(a.effet+1.5)/1.5:(n=180/Math.PI*Math.atan(a.VN0/a.VT),c=parseInt(n/10),s=(o=a.effet>0?a.sorties[3*c+1]+(a.sorties[3*c+2]-a.sorties[3*c+1])*(a.effet/1.5):a.sorties[3*c+0]+(a.sorties[3*c+1]-a.sorties[3*c+0])*(a.effet+1.5)/1.5)+((a.effet>0?a.sorties[3*(c+1)+1]+(a.sorties[3*(c+1)+2]-a.sorties[3*(c+1)+1])*(a.effet/1.5):a.sorties[3*(c+1)+0]+(a.sorties[3*(c+1)+1]-a.sorties[3*(c+1)+0])*(a.effet+1.5)/1.5)-o)/10*(n-10*c)),Math.abs(s-90)<1e-5?a.VT=0:a.VT=s<90?a.VN/Math.tan(s/180*Math.PI):-a.VN*Math.tan((s-90)/180*Math.PI),Math.abs(a.VT)<1e-5?a.effet>0?a.e_s=a.eff_s[28]+(a.eff_s[29]-a.eff_s[28])*(a.effet/1.5):a.e_s=a.eff_s[27]+(a.eff_s[28]-a.eff_s[27])*(a.effet+1.5)/1.5:(a.effet>0?(l=a.eff_s[3*c+1]+(a.eff_s[3*c+2]-a.eff_s[3*c+1])*(a.effet/1.5),r=a.eff_s[3*(c+1)+1]+(a.eff_s[3*(c+1)+2]-a.eff_s[3*(c+1)+1])*(a.effet/1.5)):(l=a.eff_s[3*c+0]+(a.eff_s[3*c+1]-a.eff_s[3*c+0])*(a.effet+1.5)/1.5,r=a.eff_s[3*(c+1)+0]+(a.eff_s[3*(c+1)+1]-a.eff_s[3*(c+1)+0])*(a.effet+1.5)/1.5),a.e_s=l+(r-l)/10*(n-10*c)),i=(5*a.VN+2*a.VRq)/7,t=(5*a.VT-2*a.VRp)/7,a.VRr=.02*a.e_s/a.R*Math.sqrt(i*i+t*t)},this.recup_pars=function(e){a.X[e]>a.XMAX&&a.Vx[e]>0&&(a.Vx[e]=-a.VN,a.Rq[e]=-a.VRq,a.Vy[e]>0?(a.Vy[e]=a.VT,a.Rp[e]=a.VRp,a.Rr[e]=-a.VRr):(a.Vy[e]=-a.VT,a.Rp[e]=-a.VRp,a.Rr[e]=a.VRr)),a.X[e]<a.XMIN&&a.Vx[e]<0&&(a.Vx[e]=a.VN,a.Rq[e]=a.VRq,a.Vy[e]>0?(a.Vy[e]=a.VT,a.Rp[e]=a.VRp,a.Rr[e]=a.VRr):(a.Vy[e]=-a.VT,a.Rp[e]=-a.VRp,a.Rr[e]=-a.VRr)),a.Y[e]<a.YMIN&&a.Vy[e]<0&&(a.Vy[e]=a.VN,a.Rp[e]=-a.VRq,a.Vx[e]>0?(a.Vx[e]=a.VT,a.Rq[e]=-a.VRp,a.Rr[e]=-a.VRr):(a.Vx[e]=-a.VT,a.Rq[e]=a.VRp,a.Rr[e]=a.VRr)),a.Y[e]>a.YMAX&&a.Vy[e]>0&&(a.Vy[e]=-a.VN,a.Rp[e]=a.VRq,a.Vx[e]>0?(a.Vx[e]=a.VT,a.Rq[e]=-a.VRp,a.Rr[e]=a.VRr):(a.Vx[e]=-a.VT,a.Rq[e]=a.VRp,a.Rr[e]=-a.VRr))},this.init_pars=function(e){a.X[e]>a.XMAX&&a.Vx[e]>0&&(a.VN=-a.Vx[e],a.VRq=-a.Rq[e],a.Vy[e]>0?(a.VT=a.Vy[e],a.VRp=a.Rp[e],a.VRr=-a.Rr[e]):(a.VT=-a.Vy[e],a.VRp=-a.Rp[e],a.VRr=a.Rr[e])),a.X[e]<a.XMIN&&a.Vx[e]<0&&(a.VN=a.Vx[e],a.VRq=a.Rq[e],a.Vy[e]>0?(a.VT=a.Vy[e],a.VRp=a.Rp[e],a.VRr=a.Rr[e]):(a.VT=-a.Vy[e],a.VRp=-a.Rp[e],a.VRr=-a.Rr[e])),a.Y[e]<a.YMIN&&a.Vy[e]<0&&(a.VN=a.Vy[e],a.VRq=-a.Rp[e],a.Vx[e]>0?(a.VT=a.Vx[e],a.VRp=-a.Rq[e],a.VRr=-a.Rr[e]):(a.VT=-a.Vx[e],a.VRp=a.Rq[e],a.VRr=a.Rr[e])),a.Y[e]>a.YMAX&&a.Vy[e]>0&&(a.VN=-a.Vy[e],a.VRq=a.Rp[e],a.Vx[e]>0?(a.VT=a.Vx[e],a.VRp=-a.Rq[e],a.VRr=a.Rr[e]):(a.VT=-a.Vx[e],a.VRp=a.Rq[e],a.VRr=-a.Rr[e]))},this.add_clef=function(e){var t=a.nb_max_clefs*e+a.nb_clefs[e];a.evts[t]=new Y,a.evts[t].X=a.X[e],a.evts[t].Y=a.Y[e],a.evts[t].RAp=a.RAp[e],a.evts[t].RAq=a.RAq[e],a.evts[t].RAr=a.RAr[e],a.evts[t].time=a.date*a.pas;var i=a.nb_clefs,n=e,s=i[e]+1;i[n]=s,a.X0[e]=a.X[e],a.Y0[e]=a.Y[e],a.RAp0[e]=a.RAp[e],a.RAq0[e]=a.RAq[e],a.RAr0[e]=a.RAr[e]},this.choc_billes=function(e){var t=0,i=0,n=!1,s=NaN,o=NaN,l=NaN,r=NaN,c=NaN,h=NaN,u=NaN,p=NaN,d=NaN,f=NaN,m=NaN,b=NaN,v=NaN,R=NaN,V=NaN,y=NaN,k=NaN,w=NaN,_=NaN,M=NaN,g=!1,x=[];for(t=0;t<3;)x[t]=!1,t++;for(t=0;t<3;){if(!x[t]&&(n=!1,i=(t+1)%3,(s=(a.X[t]-a.X[i])*(a.X[t]-a.X[i])+(a.Y[t]-a.Y[i])*(a.Y[t]-a.Y[i]))<a.D*a.D&&(a.etat[t]!=a.ARRET||a.etat[i]!=a.ARRET)&&(a.Vx[t]-a.Vx[i])*(a.X[i]-a.X[t])+(a.Vy[t]-a.Vy[i])*(a.Y[i]-a.Y[t])>0&&(n=!0,g=!0,a.choc12||a.choc13||0!=t||(a.first_bille_choquee=i),0==t&&1==i&&(a.choc12=!0),2==t&&0==i&&(a.choc13=!0),e[0]=t,e[1]=i),n||(i=(t+2)%3,(s=(a.X[t]-a.X[i])*(a.X[t]-a.X[i])+(a.Y[t]-a.Y[i])*(a.Y[t]-a.Y[i]))<a.D*a.D&&(a.etat[t]!=a.ARRET||a.etat[i]!=a.ARRET)&&(a.Vx[t]-a.Vx[i])*(a.X[i]-a.X[t])+(a.Vy[t]-a.Vy[i])*(a.Y[i]-a.Y[t])>0&&(n=!0,g=!0,a.choc12||a.choc13||0!=t||(a.first_bille_choquee=i),1==t&&0==i&&(a.choc12=!0),0==t&&2==i&&(a.choc13=!0),e[0]=t,e[1]=i)),n)){a.add_clef(t),a.add_clef(i),x[t]=!0,a.etat[t]==a.RSG&&(a.Rp[t]=-a.Vy[t],a.Rq[t]=a.Vx[t]),a.etat[t]==a.QCQ&&(a.Rp[t]=-a.Vy[t]+a.VQy[t],a.Rq[t]=a.Vx[t]-a.VQx[t]),a.etat[t]==a.ARRET&&(a.Rp[t]=0,a.Rq[t]=0),x[i]=!0,a.etat[i]==a.RSG&&(a.Rp[i]=-a.Vy[i],a.Rq[i]=a.Vx[i]),a.etat[i]==a.QCQ&&(a.Rp[i]=-a.Vy[i]+a.VQy[i],a.Rq[i]=a.Vx[i]-a.VQx[i]),a.etat[i]==a.ARRET&&(a.Rp[i]=0,a.Rq[i]=0),l=(m=a.Vx[t]*(a.X[i]-a.X[t])+a.Vy[t]*(a.Y[i]-a.Y[t]))*(a.X[i]-a.X[t])/s,r=m*(a.Y[i]-a.Y[t])/s,c=a.Vx[t]-l,h=a.Vy[t]-r,u=(b=a.Vx[i]*(a.X[t]-a.X[i])+a.Vy[i]*(a.Y[t]-a.Y[i]))*(a.X[t]-a.X[i])/s,p=b*(a.Y[t]-a.Y[i])/s,d=a.Vx[i]-u,f=a.Vy[i]-p,R=l-u,V=r-p,a.intens=(R*R+V*V)/5,a.intens>1&&(a.intens=1),a.evts_son[a.nb_sons]=new A,a.evts_son[a.nb_sons].played=!1,a.evts_son[a.nb_sons].temps=a.date*a.pas,a.evts_son[a.nb_sons].intensite=a.intens,a.evts_son[a.nb_sons].type_choc=2;var N=a,S=a.nb_sons+1;N.nb_sons=S,v=l,l=u,u=v,u*=a.RendementChoc,l*=a.RendementChoc,v=r,r=p,p=v,p*=a.RendementChoc,r*=a.RendementChoc,a.Vx[t]=l+c,a.Vy[t]=r+h,a.VQx[t]=a.Vx[t]-a.Rq[t],a.VQy[t]=a.Vy[t]+a.Rp[t],a.etat[i]==a.ARRET&&(a.Vx[i]=.94*a.Vx[i],a.Vy[i]=.94*a.Vy[i],m/=o=Math.sqrt(s),m=Math.abs(m),_=a.fbille*m,y=Math.abs(a.Rp[t]*(a.Y[i]-a.Y[t])-a.Rq[t]*(a.X[i]-a.X[t]))/o,w=(a.Vx[t]*(a.Y[i]-a.Y[t])-a.Vy[t]*(a.X[i]-a.X[t]))/o-a.Rr[t],k=Math.abs(w)<1e-5?Math.PI/2:Math.abs(Math.atan(y/w)),M=(w>0?1:-1)*_*Math.cos(k),a.Rr[i]=2.5*M,a.Rr[t]=a.Rr[t]-2.5*M,d=M*(a.Y[i]-a.Y[t])/o,f=-M*(a.X[i]-a.X[t])/o),a.Vx[i]=u+d,a.Vy[i]=p+f,a.VQx[i]=a.Vx[i]-a.Rq[i],a.VQy[i]=a.Vy[i]+a.Rp[i],a.etat[i]=a.QCQ,a.etat[t]=a.QCQ}t++}return g};this.XMAX=t,this.YMAX=i,this.XMIN=-t,this.YMIN=-i,this.nb_max_clefs=1e4,this.nb_clefs=[];this.nb_clefs[2]=0,this.nb_clefs[1]=0,this.nb_clefs[0]=0,this.evts=[],this.nb_max_sons=50,this.nb_sons=0,this.evts_son=[],this.sorties=[],this.eff_s=[],this.etat=[],this.X0=[],this.Y0=[],this.X=[],this.Y=[],this.Xfin=[],this.Yfin=[],this.RAp=[],this.RAq=[],this.RAr=[],this.RAp0=[],this.RAq0=[],this.RAr0=[],this.RApfin=[],this.RAqfin=[],this.RArfin=[],this.Vx=[],this.Vy=[],this.Rp=[],this.Rq=[],this.Rr=[],this.VQx=[],this.VQy=[],this.etat=[],this.D=.06,this.R=.03,this.RendementChoc=.8,this.deltaclefRot=this.R*Math.PI/10,this.resolution=.01,this.done=!1,this.sorties[0]=0,this.sorties[1]=0,this.sorties[2]=0,this.sorties[3]=7.5,this.sorties[4]=7.5,this.sorties[5]=7.5,this.sorties[6]=16,this.sorties[7]=16,this.sorties[8]=16,this.sorties[9]=33,this.sorties[10]=32,this.sorties[11]=23.5,this.sorties[12]=52,this.sorties[13]=43,this.sorties[14]=31,this.sorties[15]=72,this.sorties[16]=53,this.sorties[17]=35,this.sorties[18]=86,this.sorties[19]=60,this.sorties[20]=38,this.sorties[21]=100,this.sorties[22]=69,this.sorties[23]=44,this.sorties[24]=108,this.sorties[25]=79,this.sorties[26]=53,this.sorties[27]=120,this.sorties[28]=90,this.sorties[29]=60,this.eff_s[0]=-1.5,this.eff_s[1]=0,this.eff_s[2]=1.5,this.eff_s[3]=-1.5,this.eff_s[4]=.5,this.eff_s[5]=1.2,this.eff_s[6]=-1.3,this.eff_s[7]=.7,this.eff_s[8]=1.3,this.eff_s[9]=-.5,this.eff_s[10]=1.3,this.eff_s[11]=1.2,this.eff_s[12]=-.5,this.eff_s[13]=1.3,this.eff_s[14]=1.1,this.eff_s[15]=-.3,this.eff_s[16]=.8,this.eff_s[17]=1.2,this.eff_s[18]=0,this.eff_s[19]=.7,this.eff_s[20]=1.2,this.eff_s[21]=0,this.eff_s[22]=.5,this.eff_s[23]=1.5,this.eff_s[24]=-.6,this.eff_s[25]=.2,this.eff_s[26]=1.5,this.eff_s[27]=-.65,this.eff_s[28]=0,this.eff_s[29]=1.5},X=function e(t,i){var a=this;Object(l.a)(this,e),this.RApInit=[],this.RArInit=[],this.RAqInit=[],this.Xinit=[],this.Yinit=[],this.HBande=.035,this.direction_beta=function(e,t,i){var n,s,o;return o=Math.sqrt((a.Xinit[0]-t)*(a.Xinit[0]-t)+(a.Yinit[0]-i)*(a.Yinit[0]-i)),e*=.06,n=Math.asin(e/o),(s=a.atanjimi(i-a.Yinit[0],t-a.Xinit[0]))-n>Math.PI?s-n-2*Math.PI:s-n<-Math.PI?s-n+2*Math.PI:s-n},this.ToucheBandeX=function(e){for(var t,i,n,s,o,l,r,c,h,u,p,d,f,m=NaN,b=NaN;a.betaQ<0;)a.betaQ=a.betaQ+2*Math.PI;for(;a.betaQ>=2*Math.PI;)a.betaQ=a.betaQ-2*Math.PI;return u=a.betaQ,h=e,b=Math.cos(u),f=Math.sin(u),p=Math.cos(h),d=Math.sin(h),o=((c=Math.sqrt(9e-4-a.er*a.er-a.el*a.el))*p-a.er*d)*b-a.el*f,l=c*d+a.er*p,r=(c*p-a.er*d)*f+a.el*b,m=a.Xinit[0]+o,t=.03+l,a.Yinit[0]+r,n=a.long_billard/2,!(Math.abs(b)<1e-5)&&(u>Math.PI/2&&u<3*Math.PI/2&&(b=-b,m=-m),!((s=(n-m)/b)>1.4)&&(i=.006+.009/1.4*s/p,!(s*d/p+t>a.HBande+i/p)))},this.atanjimi=function(e,t){var i;return Math.abs(t)<1e-6?e>0?Math.PI/2:-Math.PI/2:(i=Math.atan(e/t),t>0?i:e<0?i-Math.PI:i+Math.PI)},this.Quantite=function(){var e,t=0,i=[],n=[];for(e=a.betaQ+Math.PI,t=1;t<a.NBILLES;)i[t]=!1,(a.Xinit[t]-a.Xinit[0])*Math.cos(e)+(a.Yinit[t]-a.Yinit[0])*Math.sin(e)>0&&(n[t]=(a.Yinit[t]-a.Yinit[0])*Math.cos(e)-(a.Xinit[t]-a.Xinit[0])*Math.sin(e),n[t]<.06&&n[t]>-.06&&(i[t]=!0)),t++;a.bille_visee=-1;var s=100;for(t=1;t<a.NBILLES;)i[t]&&(a.Xinit[t]-a.Xinit[0])*(a.Xinit[t]-a.Xinit[0])+(a.Yinit[t]-a.Yinit[0])*(a.Yinit[t]-a.Yinit[0])<s&&(a.bille_visee=t,s=(a.Xinit[t]-a.Xinit[0])*(a.Xinit[t]-a.Xinit[0])+(a.Yinit[t]-a.Yinit[0])*(a.Yinit[t]-a.Yinit[0])),t++;return-1!=a.bille_visee?(a.noba=!0,a.quant=n[a.bille_visee]/2/.03):(a.noba=!1,a.quant=0),a.quant},this.ToucheBandeZ=function(e){for(var t,i,n,s,o,l,r,c,h,u,p,d,f,m=NaN,b=NaN;a.betaQ<0;)a.betaQ=a.betaQ+2*Math.PI;for(;a.betaQ>=2*Math.PI;)a.betaQ=a.betaQ-2*Math.PI;return u=a.betaQ,h=e,f=Math.cos(u),b=Math.sin(u),p=Math.cos(h),d=Math.sin(h),o=((c=Math.sqrt(9e-4-a.er*a.er-a.el*a.el))*p-a.er*d)*f-a.el*b,l=c*d+a.er*p,r=(c*p-a.er*d)*b+a.el*f,a.Xinit[0]+o,t=.03+l,m=a.Yinit[0]+r,n=a.larg_billard/2,!(Math.abs(b)<1e-5)&&(u>Math.PI&&(b=-b,m=-m),!((s=(n-m)/b)>1.4)&&(i=.006+.009/1.4*s/p,!(s*d/p+t>a.HBande+i/p)))},this.AlphaQmin=function(){for(var e=0;a.ToucheBandeZ(e)||a.ToucheBandeX(e)||a.ToucheBille(e);)e+=Math.PI/90;return e},this.ToucheBille=function(e){var t=NaN,i=NaN,n=NaN,s=NaN,o=NaN,l=NaN,r=NaN,c=NaN,h=NaN,u=NaN,p=NaN,d=0,f=e,m=a.betaQ;for(d=1;d<a.NBILLES;){for(t=a.Xinit[0]+.032*Math.cos(m)*Math.cos(f)-a.el*Math.sin(m)-a.er*Math.sin(f)*Math.cos(m),i=.03+.032*Math.sin(f)+a.er*Math.cos(f),n=a.Yinit[0]+.032*Math.sin(m)*Math.cos(f)+a.el*Math.cos(m)-a.er*Math.sin(f)*Math.sin(m),l=a.Xinit[d],r=.03,c=a.Yinit[d],o=0;o<1.4;){if(s=.006+.009/1.4*o,((h=t+o*Math.cos(f)*Math.cos(m))-l)*(h-l)+((u=i+o*Math.sin(f))-r)*(u-r)+((p=n+o*Math.cos(f)*Math.sin(m))-c)*(p-c)<(.03+s+.002)*(.03+s+.002))return!0;o+=.01}d++}return!1};var n=0;for(this.NBILLES=3,this.long_billard=t,this.larg_billard=i,this.Xinit=[],this.Yinit=[],this.RApInit=[],this.RAqInit=[],this.RArInit=[],n=0;n<3;)this.RApInit[n]=0,this.RAqInit[n]=0,this.RArInit[n]=0,n++;this.Xinit[0]=-.71,this.Yinit[0]=-.1775,this.Xinit[1]=-.71,this.Yinit[1]=0,this.Xinit[2]=.71,this.Yinit[2]=0,this.Vqueue=.08,this.el=0,this.er=.012,this.alphaQ=0,this.betaQ=0*Math.PI/4,this.Vqueue=3.19731,this.el=.0056,this.er=.004,this.alphaQ=.033916,this.betaQ=3.28339,this.Xinit[0]=0,this.Yinit[0]=0,this.Xinit[1]=-.051,this.Yinit[1]=.05,this.Xinit[2]=.05,this.Yinit[2]=.05,this.Vqueue=.4,this.el=0,this.er=0,this.alphaQ=.033916,this.betaQ=-7*Math.PI/8},j=function e(t,i,a,n){var s=this;Object(l.a)(this,e),this.mode_jeu=2,this.ralenti=1,this.largeur_bandes=.28,this.change_billard=function(e){if(s.arret_son(),s.myTimer.stop(),1==e){s.taille(280);var t=!1;s.bitmap_Bandes_310.visible=!1,s.bitmap_Billard_310.visible=t;t=!0;s.bitmap_Bandes_280.visible=!0,s.bitmap_Billard_280.visible=t;t=!1;s.bitmap_Bandes_260.visible=!1,s.bitmap_Billard_260.visible=t}else if(2==e){s.taille(260);t=!1;s.bitmap_Bandes_310.visible=!1,s.bitmap_Billard_310.visible=t;t=!1;s.bitmap_Bandes_280.visible=!1,s.bitmap_Billard_280.visible=t;t=!0;s.bitmap_Bandes_260.visible=!0,s.bitmap_Billard_260.visible=t}else if(0==e){s.taille(310);t=!0;s.bitmap_Bandes_310.visible=!0,s.bitmap_Billard_310.visible=t;t=!1;s.bitmap_Bandes_280.visible=!1,s.bitmap_Billard_280.visible=t;t=!1;s.bitmap_Bandes_260.visible=!1,s.bitmap_Billard_260.visible=t}s.ctrl.XC=s.Ech*s.longueur/2,s.ctrl.YC=s.Ech*s.largeur/2,s.Params.long_billard=2*(s.xmax+s.R),s.Params.larg_billard=2*(s.ymax+s.R),null!=s.Simulateur&&(s.Simulateur.XMAX=s.xmax,s.Simulateur.YMAX=s.ymax,s.Simulateur.XMIN=-s.xmax,s.Simulateur.YMIN=-s.ymax),s.tracer_grille(),s.tracer_lines(),s.Placer_billes_hasard(),s.Params.Vqueue=1,s.init_point()},this.arret_son=function(){},this.init_point=function(){s.arret_son(),s.myTimer.stop(),s.afficher_billes(),s.ctrl.aff_parametres(),s.placer_queue(s.dq0),s.queue.visible=!0,s.calculs_faits=!1,s.aff_trajets=!1,s.trajets.graphics.clear(),s.tracer_ligne_visee(),s.ligne_visee.visible=!0},this.update_modejeu=function(e){s.mode_jeu=e,s.arret_son(),0==e&&(s.Vqmax=3.5),1==e&&(s.Vqmax=3.5),2==e&&(s.Vqmax=4.2),3==e&&(s.Vqmax=3.5),4==e&&(s.Vqmax=3.5),5==e&&(s.Vqmax=5.4)},this.Simuler=function(e,t){return s.ralenti=e,s.arret_son(),s.Simulateur.Calcul(t)},this.taille=function(e){s.taille_billard=e,310==e&&(s.longueur=3.12),280==e&&(s.longueur=2.82),260==e&&(s.longueur=2.62),s.xmax=(s.longueur-s.largeur_bandes)/2-.03,s.ymax=(s.longueur-s.largeur_bandes)/4-.03,s.largeur=2*(s.ymax+.03)+s.largeur_bandes};var o=0;this.Ech=a,this.R=.03,this.Rb=36,this.type=0,this.taille(t),this.Params=new X(2*(this.xmax+this.R),2*(this.ymax+this.R));for(this.ombre=[],this.aff_trajets=!1,this.tous_trajets=!0,this.trajet_bille_joueur=!1,this.trajet_bille_visee=!1,this.billes=[],this.bille_visee=1,this.ecl=[],this.dq0=1.5*this.R*this.Ech,this.alphamin=!0,this.Vqmax=3.5,this.Simulateur=new B(this.xmax,this.ymax),this.ind_last_clef=[],o=0;o<3;)this.ind_last_clef[o]=this.Simulateur.nb_max_clefs*o,o++;for(this.calculs_faits=!1,this.ampl_recul_max=.1,this.RAp0=[],this.RAq0=[],this.RAr0=[],o=0;o<3;)this.RAp0[o]=0,this.RAq0[o]=0,this.RAr0[o]=0,o++;this.alphamin=!1,console.log(this)},I=function(){function e(t,i,a,n,s){var o=this;Object(l.a)(this,e),this.drawBallPath=function(e){var t=o,i=o.posPathCueWhite,a=o.pathCueWhite,n=o.posPathCueYellow,s=o.pathCueYellow,l=o.posPathTargetBall,r=o.pathTargetBall,c=[],h=[],u=!0,p=!1,d=void 0;try{for(var f,b=a[Symbol.iterator]();!(u=(f=b.next()).done);u=!0){f.value.dispose()}}catch(L){p=!0,d=L}finally{try{u||null==b.return||b.return()}finally{if(p)throw d}}var v=!0,R=!1,V=void 0;try{for(var y,k=s[Symbol.iterator]();!(v=(y=k.next()).done);v=!0)y.value.dispose()}catch(L){R=!0,V=L}finally{try{v||null==k.return||k.return()}finally{if(R)throw V}}var w=!0,_=!1,M=void 0;try{for(var g,x=r[Symbol.iterator]();!(w=(g=x.next()).done);w=!0)g.value.dispose()}catch(L){_=!0,M=L}finally{try{w||null==x.return||x.return()}finally{if(_)throw M}}for(var N in n)c.push(new m.Color4(1,1,0,1));for(var N in l)h.push(new m.Color4(1,0,0,1));if(!0===e)a.push(m.MeshBuilder.CreateLines("lines",{points:i},t.scene)),s.push(m.MeshBuilder.CreateLines("lines",{points:n,colors:c},t.scene)),r.push(m.MeshBuilder.CreateLines("lines",{points:l,colors:h},t.scene));else{var S=!0,C=!1,P=void 0;try{for(var A,Y=a[Symbol.iterator]();!(S=(A=Y.next()).done);S=!0){A.value.dispose()}}catch(L){C=!0,P=L}finally{try{S||null==Y.return||Y.return()}finally{if(C)throw P}}var B=!0,X=!1,j=void 0;try{for(var I,q=s[Symbol.iterator]();!(B=(I=q.next()).done);B=!0)I.value.dispose()}catch(L){X=!0,j=L}finally{try{B||null==q.return||q.return()}finally{if(X)throw j}}var T=!0,E=!1,O=void 0;try{for(var z,Q=r[Symbol.iterator]();!(T=(z=Q.next()).done);T=!0)z.value.dispose()}catch(L){E=!0,O=L}finally{try{T||null==Q.return||Q.return()}finally{if(E)throw O}}a=[],s=[],r=[]}},this.configCameras=function(){var e=o;e.cameras.arcCam=new m.ArcRotateCamera("Camera-Arc",4.44,1.05,300,m.Vector3.Zero(),e.scene),e.cameras.arcCam.attachControl(e.canvas),e.cameras.arcCam.upperBetaLimit=1.5,e.cameras.arcCam.wheelPrecision=.2,e.cameras.arcCam.upperRadiusLimit=500,e.cameras.arcCam.lowerRadiusLimit=100,e.cameras.topCam=new m.ArcRotateCamera("Camera-Top",-Math.PI/2,0,330,m.Vector3.Zero(),e.scene),e.cameras.topCam.upperBetaLimit=0,e.cameras.topCam.lowerBetaLimit=0,e.cameras.topCam.upperAlphaLimit=-Math.PI/2,e.cameras.topCam.lowerAlphaLimit=-Math.PI/2,e.cameras.topCam.upperRadiusLimit=330,e.cameras.topCam.lowerRadiusLimit=330,e.cameras.topCam.mode=m.Camera.ORTHOGRAPHIC_CAMERA,e.cameras.topCam.orthoTop=130,e.cameras.topCam.orthoBottom=-130,e.cameras.topCam.orthoLeft=-240,e.cameras.topCam.orthoRight=240,e.changeView(e.currentView)},this.loadModels=function(){var e=o,t=o.modelStorePath;m.SceneLoader.ImportMesh("",t,v,e.scene,function(i){e.objects.bat=i[0],e.objects.bat.position.y=50,e.objects.bat.position.z=90,e.objects.batLookatPoint=new m.MeshBuilder.CreateSphere("look-at",{diameter:4},e.scene),e.objects.batLookatPoint.position.y=30,e.objects.batLookatPoint.visibility=!1,m.SceneLoader.ImportMesh("",t,b,e.scene,function(i){e.objects.table=i;var a=!0,n=!1,s=void 0;try{for(var o,l=i[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var r=o.value;"carpet"===r.name&&(r.material.bumpTexture=new m.Texture(t+"carpet-bump.png",e.scene))}}catch(c){n=!0,s=c}finally{try{a||null==l.return||l.return()}finally{if(n)throw s}}e.configCueBalls(),e.updateBat(e.controlOptions)})})},this.updateControlOptions=function(e){o.controlOptions=e,o.updateBat(e)},this.updateBat=function(e){var t=e.cueLine,i=e.cueAngle,a=e.sideEnglish,n=e.topSpin,s=o.size,l=o.ballRadius,r=o.objects,c=r.bat,h=r.batLookatPoint,u=r.directionLine,p=r.cueBallWhite,d=R*a/s,f=R*n/s;c.position.x=p.position.x-d*Math.sin(t)-f*Math.sin(i)*Math.cos(t),c.position.z=p.position.z+d*Math.cos(t)-f*Math.sin(i)*Math.sin(t),c.position.y=l/2+f*Math.cos(i),c.rotation=new m.Vector3(0,-t,Math.PI/2+i);var b=Object.assign({},c.position);b.y+=40*Math.sin(i),b.x+=40*Math.cos(i)*Math.cos(t),b.z+=40*Math.cos(i)*Math.sin(t),h.position=b,h.lookAt(c.position),u.position.x=p.position.x,u.position.z=p.position.z,u.position.y=l/2,u.rotation.y=Math.PI-t},this.generateReflectionMaterial=function(e,t){for(var i=o.scene,a=new m.ReflectionProbe("satelliteProbe"+e.name,512,i),n=0;n<t.length;n++)a.renderList.push(t[n]);e.material.reflectionTexture=a.cubeTexture,e.material.reflectivityColor=new m.Color3(.2,.2,.2),e.material.reflectionFresnelParameters=new m.FresnelParameters,e.material.reflectionFresnelParameters.bias=0,a.attachToMesh(e)},this.configCueBalls=function(){var e,t,i=o,a=o.modelStorePath,n=o.ballRadius,s=o.objects.table,l=(o.cameras.arcCam,!0),r=!1,c=void 0;try{for(var h,u=s[Symbol.iterator]();!(l=(h=u.next()).done);l=!0){var p=h.value;"carpet"===p.name?e=p:"carpet-side"===p.name&&(t=p)}}catch(w){r=!0,c=w}finally{try{l||null==u.return||u.return()}finally{if(r)throw c}}var d=o.ballPositions,f=d.posCueBallWhite,b=d.posCueBallYellow,v=d.posTargetBall;i.objects.cueBallWhite=m.Mesh.CreateSphere("cue-ball-white",16,n,i.scene),i.objects.cueBallWhite.position.y=n/2,i.objects.cueBallWhite.position.x=f.x,i.objects.cueBallWhite.position.z=f.z;var R=new m.StandardMaterial("redMat",i.scene);R.diffuseTexture=new m.Texture(a+"cueball-white.jpg",i.scene),i.objects.cueBallWhite.material=R,i.objects.cueBallYellow=m.Mesh.CreateSphere("cue-ball-yellow",16,n,i.scene),i.objects.cueBallYellow.position.y=n/2,i.objects.cueBallYellow.position.x=b.x,i.objects.cueBallYellow.position.z=b.z;var V=new m.StandardMaterial("redMat",i.scene);V.diffuseTexture=new m.Texture(a+"cueball-yellow.jpg",i.scene),i.objects.cueBallYellow.material=V,i.objects.targetBall=m.Mesh.CreateSphere("cue-ball-red",16,n,i.scene),i.objects.targetBall.position.y=n/2,i.objects.targetBall.position.x=v.x,i.objects.targetBall.position.z=v.z;var y=new m.StandardMaterial("redMat",i.scene);y.diffuseTexture=new m.Texture(a+"targetball.jpg",i.scene),i.objects.targetBall.material=y,i.generateReflectionMaterial(i.objects.cueBallWhite,[i.objects.cueBallYellow,i.objects.targetBall,i.objects.bat,e,t]),i.generateReflectionMaterial(i.objects.cueBallYellow,[i.objects.cueBallWhite,i.objects.targetBall,i.objects.bat,e,t]),i.generateReflectionMaterial(i.objects.targetBall,[i.objects.cueBallWhite,i.objects.cueBallYellow,i.objects.bat,e,t]),i.objects.ray=new m.Ray,i.objects.rayHelper=new m.RayHelper(i.objects.ray);var k=new m.Vector3(0,0,1);i.objects.rayHelper.attachToMesh(i.objects.batLookatPoint,k)},this.configGrids=function(){for(var e=o,t=[new m.Color4(.7,.7,.7,1),new m.Color4(.7,.7,.7,1)],i=0;i<15;i++){var a=[new m.Vector3(7*-R/16+i*R/16,2,-R/4),new m.Vector3(7*-R/16+i*R/16,2,R/4)];e.grids.push(m.MeshBuilder.CreateLines("lines",{points:a,colors:t},e.scene))}for(i=0;i<7;i++){var n=[new m.Vector3(-R/2,2,3*-R/16+i*R/16),new m.Vector3(R/2,2,3*-R/16+i*R/16)];e.grids.push(m.MeshBuilder.CreateLines("lines",{points:n,colors:t},e.scene))}},this.toggleGrids=function(e){for(var t=o.grids,i=0;i<t.length;i++)t[i].visibility=e},this.initializeScene=function(e,t){var i=o;i.scene=e,i.canvas=t,i.scene.clearColor=new m.Color3(.05,.05,.05),i.objects.directionLine=new m.MeshBuilder.CreateLines("direction-line",{points:[new m.Vector3(0,0,0),new m.Vector3(600,0,0)],colors:[new m.Color4(0,0,.8,1),new m.Color4(0,0,.8,1)]}),new m.HemisphericLight("light",m.Vector3.Up(),e),i.configCameras(),i.loadModels(),i.configGrids(),i.scene.getEngine().runRenderLoop(function(){e&&(e.render(),i.animateBalls())}),t.addEventListener("pointerdown",i.onPointerDown,!1),t.addEventListener("pointerup",i.onPointerUp,!1),t.addEventListener("pointermove",i.onPointerMove,!1)},this.getGroundPosition=function(){var e=o.scene,t=e.pick(e.pointerX,e.pointerY,function(e){return"carpet"==e.name});return t.hit?t.pickedPoint:null},this.onPointerDown=function(e){var t=o,i=o.scene,a=o.canvas;if(0===e.button){var n=i.pick(i.pointerX,i.pointerY,function(e){return"cue-ball-white"===e.name||"cue-ball-yellow"===e.name||"cue-ball-red"===e.name});n.hit&&(t.currentMesh=n.pickedMesh,t.startingPoint=t.getGroundPosition(e),t.startingPoint&&setTimeout(function(){t.cameras.arcCam.detachControl(a)},0))}},this.onPointerUp=function(){var e=o,t=o.startingPoint,i=o.canvas;if(t)return e.cameras.arcCam.attachControl(i,!0),e.startingPoint=null,void(e.currentMesh=null)},this.onPointerMove=function(e){var t=o,i=o.startingPoint,a=o.currentMesh;if(i){var n=t.getGroundPosition(e);n&&(a.position=n,a.position.y=t.ballRadius/2,i=n,t.updateBat(t.controlOptions))}},this.moveAndRotateBall=function(e,t,i){for(var a=-1,n=o,s=1e4*i;s<1e4*(i+1);s++)n.pathData[s]&&n.pathData[s].time<t-n.t0&&(a=s);if(a>=0){var l=n.pathData[a];e.position.x=R*l.X/n.size,e.position.z=R*l.Y/n.size;var r=n.pathData[a].RAp,c=n.pathData[a].RAq,h=n.pathData[a].RAr,u=(r-n.RAp0[i])/.03,p=(c-n.RAq0[i])/.03,d=(h-n.RAr0[i])/.03;n.RAp0[i]=r,n.RAq0[i]=c,n.RAr0[i]=h,e.rotate(m.Axis.X,-u,m.Space.WORLD),e.rotate(m.Axis.Y,-d,m.Space.WORLD),e.rotate(m.Axis.Z,-p,m.Space.WORLD)}},this.animateBalls=function(){var e=o,t=o.objects,i=t.cueBallWhite,a=t.cueBallYellow,n=t.targetBall;if(e.pathData&&0!=e.pathData.length&&void 0!=e.t0){var s=(new Date).getTime()/1e3;o.moveAndRotateBall(i,s,0),o.moveAndRotateBall(a,s,1),o.moveAndRotateBall(n,s,2)}},this.playSimulation=function(){var e=o,t=(o.initBallPosition,o.controlOptions),i=o.objects,a=i.cueBallWhite,n=i.cueBallYellow,s=i.targetBall,l=o.billard.Simuler(1,{Xinit:[e.size*a.position.x/R,e.size*n.position.x/R,e.size*s.position.x/R],Yinit:[e.size*a.position.z/R,e.size*n.position.z/R,e.size*s.position.z/R],RApInit:[0,0,0],RAqInit:[0,0,0],RArInit:[0,0,0],el:t.sideEnglish,er:t.topSpin,alphaQ:t.cueAngle,betaQ:t.cueLine,Vqueue:t.speed});if(console.log(l),l&&0!=l.length){o.pathData=l;for(var r=[],c=0;c<1e4;c++)l[c]&&r.push(new m.Vector3(R*l[c].X/o.size,o.ballRadius/2,R*l[c].Y/o.size));m.MeshBuilder.CreateLines("lines",{points:r},o.scene);var h=[],u=[];for(c=1e4;c<2e4;c++)l[c]&&(h.push(new m.Vector3(R*l[c].X/o.size,o.ballRadius/2,R*l[c].Y/o.size)),u.push(new m.Color4(.8,.8,0,1)));m.MeshBuilder.CreateLines("lines",{points:h,colors:u},o.scene);var p=[],d=[];for(c=2e4;c<3e4;c++)l[c]&&(p.push(new m.Vector3(R*l[c].X/o.size,o.ballRadius/2,R*l[c].Y/o.size)),d.push(new m.Color4(.8,0,0,1)));m.MeshBuilder.CreateLines("lines",{points:p,colors:d},o.scene),o.t0=(new Date).getTime()/1e3}},this.scene=void 0,this.canvas=void 0,this.size=t,this.ballRadius=400*V/(100*this.size),this.modelStorePath=i,this.initBallPosition=n,this.ballPositions={posCueBallWhite:{x:R*n.posCueBallWhite.x/t,z:R*n.posCueBallWhite.z/t},posCueBallYellow:{x:R*n.posCueBallYellow.x/t,z:R*n.posCueBallYellow.z/t},posTargetBall:{x:R*n.posTargetBall.x/t,z:R*n.posTargetBall.z/t}},this.currentView=a,this.cameras={arcCam:void 0,topCam:void 0},this.objects={table:void 0,bat:void 0,cueBallWhite:void 0,cueBallYellow:void 0,targetBall:void 0,batContactLine:void 0,batLookatPoint:void 0,directionLine:void 0},this.controlOptions=s,this.grids=[],this.posPathCueWhite=[],this.pathCueWhite=[],this.posPathCueYellow=[],this.pathCueYellow=[],this.posPathTargetBall=[],this.pathTargetBall=[],this.billard=new j(310,void 0,300),this.timerCount=0,this.RAp0=[0,0,0],this.RAq0=[0,0,0],this.RAr0=[0,0,0]}return Object(r.a)(e,[{key:"changeView",value:function(e){"2d"===e?(this.scene.activeCamera=this.cameras.topCam,this.cameras.arcCam.detachControl(this.canvas),this.cameras.topCam.attachControl(this.canvas)):(this.scene.activeCamera=this.cameras.arcCam,this.cameras.arcCam.attachControl(this.canvas),this.cameras.topCam.detachControl(this.canvas))}}]),e}(),q=i(0),T=new q.o(0,0,0),E=new q.o(0,0,1);function O(e){return new q.o(e.x,e.y,e.z)}function z(e){return E.clone().cross(e)}function Q(e){return e.clone().normalize()}function L(e,t){return e.clone().add(t).dot(e)<=0}var W=function(){function e(){Object(l.a)(this,e),this.pos=new q.o(1,0,0),this.dir=new q.o(1,0,0),this.verticalOffset=0,this.sideOffset=0,this.angle=0,this.power=0}return Object(r.a)(e,[{key:"applyToController",value:function(e){return e.handleAim(this)}},{key:"copy",value:function(){return e.fromJson(this)}}],[{key:"fromJson",value:function(t){var i=new e;return i.pos=O(t.pos),i.dir=O(t.dir),i.angle=t.angle,i.verticalOffset=t.verticalOffset,i.sideOffset=t.sideOffset,i.power=t.power,i}}]),e}(),D=.006,G=9.8,F=.1,U=D*F*G*2/3*.4,K=7/(5*Math.sqrt(2))*D*F*G,H=.8;function Z(e,t){return e.clone().add(z(t)).setZ(0)}var J=Math.sin(9.25/32.5),$=Math.cos(9.25/32.5),ee=J*J,te=$*$;function ie(e,t){return new q.o(e.x*J-e.z*$+t.y,-e.y-t.z*$+t.x*J)}function ae(e){return e.x*$-e.z*$}var ne=7/(2*F),se=1/F;function oe(e,t,i,a){i.set(-e.x*(2/7*ee+(1+H)*te)-2/7*t.y*J,5/7*e.y+2/7*(t.x*J-t.z*$)-e.y,0);var n=ie(e,t),s=5*n.y/(2*F*ne);a.set(s*J,5/(2*F)*(-n.x/ne+J*ae(e)*(1+H)/se*($-J)),s*$)}var le=function(){function e(){Object(l.a)(this,e),this.initialiseMesh()}return Object(r.a)(e,[{key:"updatePosition",value:function(e){this.mesh.position.copy(e)}},{key:"updateRotation",value:function(e,t){var i=e.length()*t*Math.PI/2,a=(new q.h).identity().makeRotationAxis(Q(e),i);this.mesh.geometry.applyMatrix(a),this.arrow.setDirection(Q(e)),this.arrow.position.copy(this.mesh.position),this.arrow.setLength(1*e.length()+.4)}},{key:"initialiseMesh",value:function(){var e=new q.f(.5,1),t=new q.j({color:5592405,emissive:0});this.mesh=new q.i(e,t),this.mesh.castShadow=!0,this.mesh.receiveShadow=!0,this.mesh.name="ball",this.arrow=new q.b(E,T,2,13369344)}},{key:"addToScene",value:function(e){e.add(this.mesh),e.add(this.arrow)}}]),e}(),re={Stationary:"Stationary",Rolling:"Rolling",Sliding:"Sliding",Falling:"Falling",InPocket:"InPocket"},ce=function(){function e(t){Object(l.a)(this,e),this.vel=T.clone(),this.rvel=T.clone(),this.state=re.Stationary,this.transition=.05,this.pos=t.clone(),this.mesh=new le}return Object(r.a)(e,[{key:"update",value:function(e){this.updatePosition(e),this.updateVelocity(e),this.mesh.updateRotation(this.rvel,e)}},{key:"updatePosition",value:function(e){this.pos.addScaledVector(this.vel,e),this.mesh.updatePosition(this.pos)}},{key:"updateVelocity",value:function(e){this.inMotion()&&(this.isRolling()?this.updateVelocityRolling(e):this.updateVelocitySliding(e))}},{key:"updateVelocityRolling",value:function(e){var t,i;t=this.vel,i=this.rvel,t.sub(Z(t,i).multiplyScalar(.5)),i.copy(z(t));var a=new q.o,n=new q.o;!function(e,t,i){var a=new q.o(e.x,e.y,0).length(),n=5/7*K/a;t.set(-n*e.y,n*e.x,0),i.set(-n*e.x,-n*e.y,-n*e.z)}(this.rvel,a,n),a.multiplyScalar(e),n.multiplyScalar(e),L(this.rvel,n)||L(this.vel,a)?this.setStationary():(this.vel.add(a),this.rvel.add(n),this.state=re.Rolling)}},{key:"updateVelocitySliding",value:function(e){var t=new q.o,i=new q.o;!function(e,t,i,a){var n=Z(e,t);i.copy(Q(n).multiplyScalar(-D*G)),a.copy(Q(z(n)).multiplyScalar(2.5*D*G)),a.setZ(-2.5*U*Math.sign(t.z))}(this.vel,this.rvel,t,i),t.multiplyScalar(e),i.multiplyScalar(e),L(this.rvel,i)&&L(this.vel,t)?this.setStationary():(this.vel.add(t),this.rvel.add(i),this.state=re.Sliding)}},{key:"setStationary",value:function(){this.vel.copy(T),this.rvel.copy(T),this.state=re.Stationary}},{key:"isRolling",value:function(){return Z(this.vel,this.rvel).length()<this.transition&&0!=this.vel.length()}},{key:"onTable",value:function(){return this.state!=re.Falling}},{key:"inMotion",value:function(){return this.onTable()&&(0!=this.vel.length()||0!=this.rvel.length())}},{key:"futurePosition",value:function(e){return this.pos.clone().addScaledVector(this.vel,e)}},{key:"serialise",value:function(){return{pos:this.pos,vel:this.vel,rvel:this.rvel,state:this.state}}}],[{key:"fromSerialised",value:function(t){return e.updateFromSerialised(new e(O(t.pos)),t)}},{key:"updateFromSerialised",value:function(e,t){return e.pos.copy(t.pos),e.vel.copy(O(t.vel)),e.rvel.copy(O(t.rvel)),e.state=t.state,e}}]),e}(),he=function(){function e(t,i){Object(l.a)(this,e),this.pos=t,this.radius=i}return Object(r.a)(e,[{key:"bounce",value:function(e){var t=e.pos.clone().sub(this.pos).normalize(),i=t.dot(e.vel);e.vel.addScaledVector(t,-2*de.elasticity*i)}}],[{key:"willBounce",value:function(e,t){return t.distanceTo(e.pos)<.5+e.radius}},{key:"willBounceAny",value:function(t,i){var a=t.futurePosition(i);return t.onTable()&&pe.knuckles.find(function(t){return e.willBounce(t,a)})}}]),e}(),ue=function(){function e(t,i){Object(l.a)(this,e),this.pos=t,this.radius=i}return Object(r.a)(e,[{key:"fall",value:function(e,t){var i=e.pos.clone().sub(this.pos).normalize();e.vel.addScaledVector(i,1*t),e.vel.z=-1,e.state=re.Falling}}],[{key:"willFall",value:function(e,t){return t.distanceTo(e.pos)<.5+e.radius}},{key:"willFallAny",value:function(t,i){var a=t.futurePosition(i);return t.onTable()&&pe.pocketCenters.find(function(t){return e.willFall(t,a)})}}]),e}(),pe=function(){function e(){Object(l.a)(this,e)}return Object(r.a)(e,null,[{key:"addToScene",value:function(t){e.addCushions(t)}},{key:"pocketCylinder",value:function(t,i){e.cylinder(t.pos.clone().setZ(-.5),t.radius,.1,i)}},{key:"cylinder",value:function(t,i,a,n){var s=new q.d(i,i,a,16),o=new q.i(s,e.material);return o.position.copy(t),o.geometry.applyMatrix((new q.h).identity().makeRotationAxis(new q.o(1,0,0),Math.PI/2)),n.add(o),o}},{key:"addPockets",value:function(t){e.pocketCenters.forEach(function(i){return e.pocketCylinder(i,t)})}},{key:"addCushions",value:function(t){e.plane(new q.o(0,0,-6.5),2*e.X,2*e.Y,12,t);var i=.75,a=-.125,n=Math.abs(e.pockets.pocketNW.knuckleNE.pos.x-e.pockets.pocketN.knuckleNW.pos.x),s=Math.abs(e.pockets.pocketNW.knuckleSW.pos.y-e.pockets.pocketSW.knuckleNW.pos.y);e.plane(new q.o(e.X+.5,0,a),1,s,i,t),e.plane(new q.o(-e.X-.5,0,a),1,s,i,t),e.plane(new q.o(-e.X/2,e.Y+.5,a),n,1,i,t),e.plane(new q.o(-e.X/2,-e.Y-.5,a),n,1,i,t),e.plane(new q.o(e.X/2,e.Y+.5,a),n,1,i,t),e.plane(new q.o(e.X/2,-e.Y-.5,a),n,1,i,t)}},{key:"plane",value:function(t,i,a,n,s){var o=new q.c(i,a,n),l=new q.i(o,e.material);l.receiveShadow=!0,l.position.copy(t),s.add(l)}}]),e}();pe.tableX=14,pe.tableY=22/3,pe.X=pe.tableX+.5,pe.Y=pe.tableY+.5,pe.PX=pe.tableX+1.6,pe.PY=pe.tableY+1.6,pe.knuckleInset=0,pe.knuckleRadius=.5,pe.middleKnuckleInset=0,pe.middleKnuckleRadius=.5,pe.cornerRadius=1,pe.middleRadius=.4,pe.pockets={pocketNW:{pocket:new ue(new q.o(-pe.PX,pe.PY,0),pe.cornerRadius),knuckleNE:new he(new q.o(-pe.X+pe.knuckleInset,pe.Y+pe.knuckleRadius,0),pe.knuckleRadius),knuckleSW:new he(new q.o(-pe.X-pe.knuckleRadius,pe.Y-pe.knuckleInset,0),pe.knuckleRadius)},pocketN:{pocket:new ue(new q.o(0,pe.PY,0),pe.middleRadius),knuckleNE:new he(new q.o(pe.knuckleInset,pe.Y+pe.middleKnuckleRadius,0),pe.knuckleRadius),knuckleNW:new he(new q.o(-pe.middleKnuckleInset,pe.Y+pe.middleKnuckleRadius,0),pe.knuckleRadius)},pocketS:{pocket:new ue(new q.o(0,-pe.PY,0),pe.middleRadius),knuckleSE:new he(new q.o(pe.knuckleInset,-pe.Y-pe.middleKnuckleRadius,0),pe.knuckleRadius),knuckleSW:new he(new q.o(-pe.middleKnuckleInset,-pe.Y-pe.middleKnuckleRadius,0),pe.knuckleRadius)},pocketNE:{pocket:new ue(new q.o(pe.PX,pe.PY,0),pe.cornerRadius),knuckleNW:new he(new q.o(pe.X-pe.knuckleInset,pe.Y+pe.knuckleRadius,0),pe.knuckleRadius),knuckleSE:new he(new q.o(pe.X+pe.knuckleRadius,pe.Y-pe.knuckleInset,0),pe.knuckleRadius)},pocketSE:{pocket:new ue(new q.o(pe.PX,-pe.PY,0),pe.cornerRadius),knuckleNE:new he(new q.o(pe.X+pe.knuckleRadius,-pe.Y+pe.knuckleInset,0),pe.knuckleRadius),knuckleSW:new he(new q.o(pe.X-pe.knuckleInset,-pe.Y-pe.knuckleRadius,0),pe.knuckleRadius)},pocketSW:{pocket:new ue(new q.o(-pe.PX,-pe.PY,0),pe.cornerRadius),knuckleSE:new he(new q.o(-pe.X+pe.knuckleInset,-pe.Y-pe.knuckleRadius,0),pe.knuckleRadius),knuckleNW:new he(new q.o(-pe.X-pe.knuckleRadius,-pe.Y+pe.knuckleInset,0),pe.knuckleRadius)}},pe.knuckles=[pe.pockets.pocketNW.knuckleNE,pe.pockets.pocketNW.knuckleSW,pe.pockets.pocketN.knuckleNW,pe.pockets.pocketN.knuckleNE,pe.pockets.pocketS.knuckleSW,pe.pockets.pocketS.knuckleSE,pe.pockets.pocketNE.knuckleNW,pe.pockets.pocketNE.knuckleSE,pe.pockets.pocketSE.knuckleNE,pe.pockets.pocketSE.knuckleSW,pe.pockets.pocketSW.knuckleSE,pe.pockets.pocketSW.knuckleNW],pe.pocketCenters=[pe.pockets.pocketNW.pocket,pe.pockets.pocketSW.pocket,pe.pockets.pocketN.pocket,pe.pockets.pocketS.pocket,pe.pockets.pocketNE.pocket,pe.pockets.pocketSE.pocket],pe.material=new q.j({color:4478361,wireframe:!1,flatShading:!0});var de=function(){function e(){Object(l.a)(this,e)}return Object(r.a)(e,null,[{key:"willBounce",value:function(t,i){var a=t.futurePosition(i);return t.onTable()&&(e.willBounceLongSegment(pe.pockets.pocketNW.knuckleNE.pos.x,pe.pockets.pocketN.knuckleNW.pos.x,a)||e.willBounceLongSegment(pe.pockets.pocketN.knuckleNE.pos.x,pe.pockets.pocketNE.knuckleNW.pos.x,a)||e.willBounceShortSegment(pe.pockets.pocketNW.knuckleSW.pos.y,pe.pockets.pocketSW.knuckleNW.pos.y,a))}},{key:"willBounceLongSegment",value:function(e,t,i){return i.x>e&&i.x<t&&Math.abs(i.y)>pe.tableY}},{key:"willBounceShortSegment",value:function(e,t,i){return i.y>t&&i.y<e&&Math.abs(i.x)>pe.tableX}},{key:"bounce",value:function(t,i){var a=t.futurePosition(i);a.x>pe.tableX&&e.bounceIn(0,t),a.x<-pe.tableX&&e.bounceIn(Math.PI,t),a.y>pe.tableY&&e.bounceIn(-Math.PI/2,t),a.y<-pe.tableY&&e.bounceIn(Math.PI/2,t)}},{key:"bounceIn",value:function(e,t){var i=new q.o,a=new q.o;!function(e,t,i,a,n,s){s(t.clone().applyAxisAngle(E,e),i.clone().applyAxisAngle(E,e),a,n),a.applyAxisAngle(E,-e),n.applyAxisAngle(E,-e)}(e,t.vel,t.rvel,i,a,oe),t.vel.add(i),t.rvel.add(a)}}]),e}();de.elasticity=.8;var fe=function(){function e(){Object(l.a)(this,e),this.limit=.4,this.maxPower=5,this.aim=new W,this.length=1*pe.tableX,this.initialise(.05,.15,this.length)}return Object(r.a)(e,[{key:"initialise",value:function(t,i,a){var n=new q.d(t,i,a,16);this.mesh=new q.i(n,e.material),this.mesh.castShadow=!0,this.mesh.geometry.applyMatrix((new q.h).identity().makeRotationAxis(new q.o(1,0,0),-.1)).applyMatrix((new q.h).identity().makeRotationAxis(E,-Math.PI/2)).applyMatrix((new q.h).identity().makeTranslation(-a/2-1,0,1)),this.mesh.rotation.z=this.aim.angle}},{key:"rotateAim",value:function(e){this.aim.angle+=e,this.aim.dir.applyAxisAngle(E,e),this.mesh.rotation.z=this.aim.angle}},{key:"adjustHeight",value:function(e){this.aim.verticalOffset=q.g.clamp(this.aim.verticalOffset+e,-this.limit,this.limit),this.mesh.position.z=this.aim.verticalOffset}},{key:"adjustSide",value:function(e){this.aim.sideOffset=q.g.clamp(this.aim.sideOffset+e,-this.limit,this.limit)}},{key:"adjustPower",value:function(e){this.aim.power=Math.min(this.maxPower,this.aim.power+e)}},{key:"moveTo",value:function(e){this.aim.pos.copy(e),this.mesh.rotation.z=this.aim.angle;var t=z(this.aim.dir).multiplyScalar(this.aim.sideOffset).setZ(this.aim.verticalOffset),i=this.aim.dir.clone().multiplyScalar(-this.aim.power/2);this.mesh.position.copy(e.clone().add(t).add(i))}},{key:"update",value:function(e){this.moveTo(this.aim.pos)}},{key:"intersectsAnything",value:function(e){var t=e.balls[0].pos.clone().addScaledVector(this.aim.dir,-this.length/2);t.z=this.aim.verticalOffset;var i=this.aim.dir.clone().normalize();return new q.m(t,i,0,this.length/2-.6).intersectObjects(e.balls.map(function(e){return e.mesh.mesh})).length>0}}]),e}();fe.material=new q.j({color:8934775,wireframe:!1,flatShading:!1});var me=function(){function e(){Object(l.a)(this,e)}return Object(r.a)(e,null,[{key:"jitter",value:function(t){return t.clone().add(new q.o(e.noise*(Math.random()-.5),e.noise*(Math.random()-.5),0))}},{key:"cueBall",value:function(){return new ce(new q.o(-11,0,0))}},{key:"diamond",value:function(){var t=new q.o(0,e.gap,0),i=t.clone().applyAxisAngle(e.up,1*Math.PI/3),a=new q.o(pe.tableX/2,0,0),n=[];return n.push(e.cueBall()),n.push(new ce(e.jitter(a))),a.add(i),n.push(new ce(e.jitter(a))),a.sub(t),n.push(new ce(e.jitter(a))),a.add(i),n.push(new ce(e.jitter(a))),a.sub(t),n.push(new ce(e.jitter(a))),a.add(t),a.add(t),n.push(new ce(e.jitter(a))),a.add(i).sub(t),n.push(new ce(e.jitter(a))),a.sub(t),n.push(new ce(e.jitter(a))),a.add(i),n.push(new ce(e.jitter(a))),n}},{key:"cushion3",value:function(){var t=new q.o(0,e.gap,0),i=t.clone().applyAxisAngle(e.up,1*Math.PI/3),a=new q.o(pe.tableX/2,0,0),n=[];return n.push(e.cueBall()),n.push(new ce(e.jitter(a))),a.add(i).sub(t),n.push(new ce(e.jitter(a))),n}}]),e}();me.noise=.02,me.gap=1+2*me.noise,me.up=new q.o(0,0,-1);var be=function(e){function t(e){var i;return Object(l.a)(this,t),(i=Object(c.a)(this,Object(h.a)(t).call(this,e))).meshPicked=function(e){},i.drawBallPath=function(e){i.board.drawBallPath(e)},i.onSceneMount=function(e){var t=e.canvas,a=e.scene;i.board.initializeScene(a,t)},i.toggleGrids=function(e){i.board.toggleGrids(e)},i.playSimulation=function(){i.board.playSimulation()},i.updateControlOptions=function(e){i.board.updateControlOptions(e)},i.componentDidMount=function(){},i.state={showPath:!1},i.board=new I(i.props.size,i.props.modelStorePath,i.props.currentView,{posCueBallWhite:{x:i.props.posCueBallWhite.x,z:i.props.posCueBallWhite.z},posCueBallYellow:{x:i.props.posCueBallYellow.x,z:i.props.posCueBallYellow.z},posTargetBall:{x:i.props.posTargetBall.x,z:i.props.posTargetBall.z}},{cueLine:i.props.cueLine,cueAngle:i.props.cueAngle,sideEnglish:i.props.sideEnglish,topSpin:i.props.topSpin,speed:i.props.speed}),i.simulatorDom=new n.a.createRef,i}return Object(u.a)(t,e),Object(r.a)(t,[{key:"changeView",value:function(e){this.board.changeView(e)}},{key:"render",value:function(){return n.a.createElement(f.a,{canvasId:"carom-simulator-canvas"},n.a.createElement(f.b,{onMeshPicked:this.meshPicked,onSceneMount:this.onSceneMount}))}}]),t}(n.a.Component),ve=i(9),Re=i(10),Ve=(i(32),function(e){function t(e){var i;return Object(l.a)(this,t),(i=Object(c.a)(this,Object(h.a)(t).call(this,e))).componentWillReceiveProps=function(e){var t=e.value;i.setState({value:t})},i.updateValue=function(e){i.setState({value:e}),i.props.onUpdate(i.props.itemKey,e)},i.onChangeValue=function(e){var t=e.target.value;i.updateValue(t)},i.onMinusPressed=function(){var e=i.state.value,t=i.props,a=t.min,n=t.step;void 0===n&&(n=.1),(e=(10*e-(n*=10))/10)<a&&(e=a),i.updateValue(e)},i.onPlusPressed=function(){var e=i.state.value,t=i.props,a=t.max,n=t.step;void 0===n&&(n=.1),(e=(10*e+(n*=10))/10)>a&&(e=a),i.updateValue(e)},i.state={value:i.props.value?i.props.value:0},i}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state.value,t=this.props,i=t.containerClass,a=t.label,s=t.min,o=t.max,l=t.unitDom,r=t.step;return void 0===r&&(r=.1),n.a.createElement("div",{className:i},n.a.createElement("div",{style:{display:"flex"}},n.a.createElement(ve.a,{icon:Re.d,className:"btn-change-value",onClick:this.onMinusPressed}),n.a.createElement("span",{style:{flex:1,textAlign:"center"}},a,n.a.createElement("span",null," : ",e,l)),n.a.createElement(ve.a,{icon:Re.f,className:"btn-change-value",onClick:this.onPlusPressed})),n.a.createElement("input",{type:"range",min:s,max:o,value:e,className:"slider",step:r,onChange:this.onChangeValue}))}}]),t}(n.a.Component)),ye=(i(33),function(e){function t(e){var i;return Object(l.a)(this,t),(i=Object(c.a)(this,Object(h.a)(t).call(this,e))).onInputSliderUpdated=function(e,t){var a=Object.assign({},i.state);a[e]=parseFloat(t),i.setState(a);var n=Object.assign({},a);n.cueLine=Math.PI*a.cueLine/180,n.cueAngle=Math.PI*a.cueAngle/180,n.sideEnglish/=1e3,n.topSpin/=1e3,n.speed/=100,i.props.onControlOptionsUpdated(n)},i.state={cueLine:Math.round(1800*i.props.cueLine/Math.PI)/10,cueAngle:Math.round(1800*i.props.cueAngle/Math.PI)/10,sideEnglish:Math.round(1e4*i.props.sideEnglish)/10,topSpin:Math.round(1e4*i.props.topSpin)/10,speed:Math.round(100*i.props.speed)},i}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.state,i=t.cueLine,a=t.cueAngle,s=t.sideEnglish,o=t.topSpin,l=t.speed,r=this.props,c=r.showGrid,h=r.showPath,u="toggle-btn",p="toggle-btn";return!0===c&&(u+=" active"),!0===h&&(p+=" active"),n.a.createElement("div",null,n.a.createElement("div",{className:"common-controller-container"},n.a.createElement(ve.a,{className:u,icon:Re.h,onClick:function(){e.props.onToggleShowGrid(!c)}}),n.a.createElement(ve.a,{className:p,icon:Re.b,onClick:function(){e.props.onToggleShowPath(!h)}}),n.a.createElement(ve.a,{className:"toggle-btn",icon:Re.i})),n.a.createElement("div",null,n.a.createElement(Ve,{label:"Cue Line",containerClass:"slider-container",min:0,max:360,value:i,unitDom:n.a.createElement("sup",null,"o"),itemKey:"cueLine",onUpdate:this.onInputSliderUpdated}),n.a.createElement(Ve,{label:"Cue Angle",containerClass:"slider-container",min:2,max:89,value:a,unitDom:n.a.createElement("sup",null,"o"),itemKey:"cueAngle",onUpdate:this.onInputSliderUpdated}),n.a.createElement("br",null),n.a.createElement(Ve,{label:"Side English",containerClass:"slider-container",min:-15.1,max:15.1,value:s,unitDom:n.a.createElement("span",null,"mm"),itemKey:"sideEnglish",onUpdate:this.onInputSliderUpdated}),n.a.createElement(Ve,{label:"Top Spin",containerClass:"slider-container",min:-15.1,max:15.1,value:o,unitDom:n.a.createElement("span",null,"mm"),itemKey:"topSpin",onUpdate:this.onInputSliderUpdated}),n.a.createElement(Ve,{label:"Speed",containerClass:"slider-container",min:0,max:450,value:l,step:1,unitDom:n.a.createElement("span",null,"cm/s"),itemKey:"speed",onUpdate:this.onInputSliderUpdated})),n.a.createElement("div",{className:"play-controller-container"},n.a.createElement(ve.a,{className:"play-controller",icon:Re.a}),n.a.createElement(ve.a,{className:"play-controller",icon:Re.g}),n.a.createElement(ve.a,{className:"play-controller",icon:Re.e,onClick:this.props.onPlayPressed}),n.a.createElement(ve.a,{className:"play-controller",icon:Re.c})))}}]),t}(n.a.Component)),ke=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(h.a)(t).call(this))).componentWillMount=function(){e.updateSimulateInfo()},e.updateSimulateInfo=function(){var t=["Santiago  Soto Sanchez","...","0","310","2","1","1.1661666666666661","0.6288333333333332","0.8181666666666672","0.5041666666666665","-0.6036666666666667","-0.003833333333333161","4.015999999999998","0.520497057626843","0.21066799020683835","-0.0013500000000002585","-0.0146999999999997"],i={size:2.8,cueLine:parseFloat(t[S]),cueAngle:parseFloat(t[N]),sideEnglish:parseFloat(t[C]),topSpin:parseFloat(t[P]),speed:parseFloat(t[x]),posCueBallWhite:{x:parseFloat(t[y]),z:parseFloat(t[k])},posCueBallYellow:{x:parseFloat(t[w]),z:parseFloat(t[_])},posTargetBall:{x:parseFloat(t[M]),z:parseFloat(t[g])}};e.setState(i)},e.viewSelectorItemClicked=function(t){e.setState({currentView:t}),e.simulator.current.changeView(t)},e.onToggleShowGrid=function(t){e.setState({showGrid:t}),e.simulator.current.toggleGrids(t)},e.onToggleShowPath=function(t){e.setState({showPath:t}),e.simulator.current.drawBallPath(t)},e.onPlayPressed=function(){e.simulator.current.playSimulation()},e.onControlOptionsUpdated=function(t){e.simulator.current.updateControlOptions(t)},e.componentDidMount=function(){},e.state={currentView:"2d",showGrid:!0,showPath:!1,size:310,cueLine:30,cueAngle:5,sideEnglish:-8.7,topSpin:7.5,speed:380,posCueBallWhite:{},posCueBallYellow:{},posTargetBall:{}},e.simulator=n.a.createRef(),e}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.currentView,i=e.showGrid,a=e.showPath,s=e.size,o=e.cueLine,l=e.cueAngle,r=e.sideEnglish,c=e.topSpin,h=e.speed,u=e.posCueBallWhite,p=e.posCueBallYellow,f=e.posTargetBall;return n.a.createElement("div",{className:"simulator-container"},n.a.createElement(d,{currentView:t,viewSelectorItemClicked:this.viewSelectorItemClicked}),n.a.createElement(be,{modelStorePath:this.props.modelStorePath,ref:this.simulator,size:s,currentView:t,cueLine:o,cueAngle:l,sideEnglish:r,topSpin:c,speed:h,posCueBallWhite:u,posCueBallYellow:p,posTargetBall:f}),n.a.createElement(ye,{showGrid:i,showPath:a,cueLine:o,cueAngle:l,sideEnglish:r,topSpin:c,speed:h,onControlOptionsUpdated:this.onControlOptionsUpdated,onToggleShowGrid:this.onToggleShowGrid,onToggleShowPath:this.onToggleShowPath,onPlayPressed:this.onPlayPressed}))}}]),t}(n.a.Component);var we=function(){return n.a.createElement("div",{className:"simulator-container"},n.a.createElement(ke,{modelStorePath:"./models/"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(we,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[19,1,2]]]);
//# sourceMappingURL=main.27835c2b.chunk.js.map