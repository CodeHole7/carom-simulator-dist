(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,a){},18:function(e,t,a){e.exports=a(33)},23:function(e,t,a){},24:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var i=a(1),s=a.n(i),n=a(16),o=a.n(n),r=(a(23),a(24),a(3)),l=a(4),c=a(8),h=a(7),p=a(9),u=a(11),f=(a(12),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).viewSelectorItemClicked=a.viewSelectorItemClicked.bind(Object(u.a)(a)),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"viewSelectorItemClicked",value:function(e){"function"===typeof this.props.viewSelectorItemClicked&&this.props.viewSelectorItemClicked(e)}},{key:"render",value:function(){var e=this,t="view-selector-item",a="view-selector-item";return"2d"===this.props.currentView?t+=" active":a+=" active",s.a.createElement("div",{className:"view-selector"},s.a.createElement("span",{className:t,onClick:function(){e.viewSelectorItemClicked("2d")}},"2D"),s.a.createElement("span",{className:a,onClick:function(){e.viewSelectorItemClicked("3d")}},"3D"))}}]),t}(i.Component)),d=a(13),m=a(0),b="table.babylon",R="bat.babylon",V=400,_=5.715,v=6,M=7,g=8,y=9,x=10,N=11,C=12,w=13,A=14,B=15,Y=16,P=function e(){Object(r.a)(this,e),this.played=!1},X=function e(){Object(r.a)(this,e)},q=function e(t,a){var i=this;Object(r.a)(this,e),this.delta_fgpas=.004375,this.RSG=1,this.fgpas=.00125,this.EPSILON=.86,this.frpas=3e-5,this.QCQ=2,this.Rfppas=75e-6,this.f1=.25,this.f2=.42,this.Rfp=.15,this.fbille=.05,this.pas=5e-4,this.fp1=.2,this.ARRET=0,this.TSP=3,this.fg=2.5,this.fr=.06,this.choc_bande=function(e){var t=NaN;if(i.X[e]>i.XMIN&&i.X[e]<i.XMAX&&i.Y[e]>i.YMIN&&i.Y[e]<i.YMAX)return!1;if(i.X[e]<i.XMIN&&i.Vx[e]>0)return!1;if(i.X[e]>i.XMAX&&i.Vx[e]<0)return!1;if(i.Y[e]>i.YMAX&&i.Vy[e]<0)return!1;if(i.Y[e]<i.YMIN&&i.Vy[e]>0)return!1;if(0==e&&(!i.choc12||!i.choc13)){var a=i,s=i.nbandes+1;if(a.nbandes=s,!i.choc12&&!i.choc13){a=i,s=i.nb_b_avant+1;a.nb_b_avant=s}}return i.etat[e]==i.RSG?(i.Rp[e]=-i.Vy[e],i.Rq[e]=i.Vx[e]):i.etat[e]==i.QCQ&&(i.Rp[e]=-i.Vy[e]+i.VQy[e],i.Rq[e]=i.Vx[e]-i.VQx[e]),i.init_pars(e),i.VMz=i.VT-i.VRr,i.VN0=-i.VN,i.VN=i.VN*-i.EPSILON,i.deltaVN=i.VN0+i.VN,i.intens=i.VN0/20,i.intens>1&&(i.intens=1),i.beta_adh=2/7*Math.sqrt(i.VMz*i.VMz+i.VRq*i.VRq),i.beta_gliss=i.f1*i.deltaVN,Math.abs(i.VMz)<1e-5?i.alpha_bande=Math.PI/2:i.alpha_bande=Math.abs(Math.atan(i.VRq/i.VMz)),t=Math.abs(i.fp1*i.deltaVN),Math.abs(i.VRp)<t?i.VRp=0:i.VRp>0?i.VRp=i.VRp-t:i.VRp=i.VRp+t,t=Math.abs(i.f2*i.deltaVN),i.VRq=i.VRq+t,i.beta_gliss>i.beta_adh?i.choc_adh(e):i.choc_gliss(e),i.recup_pars(e),i.VQx[e]=i.Vx[e]-i.Rq[e],i.VQy[e]=i.Vy[e]+i.Rp[e],i.etat[e]=i.QCQ,!0},this.fin_parcours=function(){var e=0;for(e=0;e<3;){if(i.etat[e]!=i.ARRET){if(!(i.Vx[e]*i.Vx[e]+i.Vy[e]*i.Vy[e]<i.frpas*i.frpas))return!1;if(!(Math.abs(i.Rr[e])<i.Rfppas))return i.etat[e]=i.TSP,!1;i.etat[e]=i.ARRET;var t=0;i.Vy[e]=0,i.Vx[e]=t;t=0;i.Rr[e]=0,i.Rq[e]=t,i.Rp[e]=t}e++}return!0},this.Calcul=function(e){console.log("parameter",e);var t,a,s=0,n=0,o=NaN,r=[];for(s=0;s<3;){for(i.nb_clefs[s]=0,n=0;n<i.nb_max_clefs;)i.evts[i.nb_max_clefs*s+n]=null,n++;s++}for(i.nb_sons=0,s=0;s<i.nb_max_sons;)i.evts_son[s]=null,s++;for(s=0;s<3;)i.X[s]=e.Xinit[s],i.Y[s]=e.Yinit[s],i.RAp[s]=e.RApInit[s],i.RAq[s]=e.RAqInit[s],i.RAr[s]=e.RArInit[s],i.add_clef(s),s++;i.el=e.el,i.er=e.er,i.alph=e.alphaQ,i.beta=e.betaQ,i.vqueue=e.Vqueue,i.calculs_finis=!1,i.nbandes=0,i.done=!1,i.distance13=2,i.first_bille_choquee=0,i.choc12=!1,i.choc13=!1,i.done=!1,i.deltaclef=i.resolution,i.date=0,i.beta=i.beta+Math.PI,i.Vinit=1.4*i.vqueue*Math.cos(i.alph/1.2),t=-2*i.Vinit/Math.cos(i.alph/1.1)*i.er/i.R;var l=Math.PI/20;o=i.alph>l?Math.PI/2/(Math.PI/2-l)*(i.alph-l):0,a=4*i.vqueue*Math.sin(o)*i.el/i.R,i.Vx[0]=i.Vinit*Math.cos(i.beta),i.Vx0=i.Vx[0],i.Vy[0]=i.Vinit*Math.sin(i.beta),i.Vy0=i.Vy[0];var c=t*Math.sin(i.beta)+a*Math.cos(i.beta);i.Rp[0]=t*Math.sin(i.beta)+a*Math.cos(i.beta),i.p0=c;c=-t*Math.cos(i.beta)+a*Math.sin(i.beta);i.Rq[0]=-t*Math.cos(i.beta)+a*Math.sin(i.beta),i.q0=c;c=2*i.el/i.R*i.Vinit;for(i.Rr[0]=2*i.el/i.R*i.Vinit,i.r0=c,i.VQx[0]=i.Vx[0]-i.Rq[0],i.VQy[0]=i.Vy[0]+i.Rp[0],i.etat[0]=i.QCQ,s=1;s<3;)i.Vx[s]=0,i.Vy[s]=0,i.VQx[s]=0,i.VQy[s]=0,i.Rp[s]=0,i.Rq[s]=0,i.Rr[s]=0,i.etat[s]=i.ARRET,i.add_clef(s),s++;for(i.evts_son[i.nb_sons]=new P,i.evts_son[i.nb_sons].played=!1,i.evts_son[i.nb_sons].temps=0,i.evts_son[i.nb_sons].intensite=i.Vinit/5.4,i.alph>Math.PI/4?i.evts_son[i.nb_sons].type_choc=0:i.evts_son[i.nb_sons].type_choc=1;!i.fin_parcours();)for(i.date+=1,i.choc_billes(r),s=0;s<3;){if(i.etat[s]!=i.ARRET){if(i.choc_bande(s)){i.add_clef(s),i.evts_son[i.nb_sons]=new P,i.evts_son[i.nb_sons].played=!1,i.evts_son[i.nb_sons].temps=i.date*i.pas,i.evts_son[i.nb_sons].intensite=i.intens,i.evts_son[i.nb_sons].type_choc=3;c=i;var h=i.nb_sons+1;c.nb_sons=h}i.mise_a_jour(s)&&i.add_clef(s)}(Math.abs(i.X[s]-i.X0[s])>i.deltaclef||Math.abs(i.Y[s]-i.Y0[s])>i.deltaclef||Math.abs(i.RAp[s]-i.RAp0[s])>i.deltaclefRot||Math.abs(i.RAq[s]-i.RAq0[s])>i.deltaclefRot||Math.abs(i.RAr[s]-i.RAr0[s])>i.deltaclefRot)&&i.add_clef(s),s++}if(i.fin_parcours()){i.calculs_finis=!0;for(s=0;s<3;s++)i.Xfin[s]=i.X[s],i.Yfin[s]=i.Y[s],i.RApfin[s]=i.RAp[s],i.RAqfin[s]=i.RAq[s],i.RArfin[s]=i.RAr[s],i.add_clef(s);i.duree=i.date*i.pas}else for(s=0;s<3;s++)i.add_clef(s);return i.evts},this.mise_a_jour=function(e){var t=NaN,a=NaN,s=NaN,n=NaN,o=NaN;if(0!=i.first_bille_choquee&&(i.nb3=3-i.first_bille_choquee,i.d13=Math.sqrt((i.X[0]-i.X[i.nb3])*(i.X[0]-i.X[i.nb3])+(i.Y[0]-i.Y[i.nb3])*(i.Y[0]-i.Y[i.nb3])),i.d13<i.distance13&&(i.distance13=i.d13)),i.etat[e]==i.RSG){if((t=Math.sqrt(i.Vx[e]*i.Vx[e]+i.Vy[e]*i.Vy[e]))<i.frpas){var r=0;i.Vy[e]=0,i.Vx[e]=r;r=0;if(i.Rq[e]=0,i.Rp[e]=r,Math.abs(i.Rr[e])<i.Rfppas)return i.etat[e]=i.ARRET,i.Rr[e]=0,i.add_clef(e),!0;i.etat[e]=i.TSP}i.etat[e]!=i.TSP&&(a=1-i.frpas/t,i.Vx[e]=i.Vx[e]*a,i.Vy[e]=i.Vy[e]*a,i.Rp[e]=-i.Vy[e],i.Rq[e]=i.Vx[e]),Math.abs(i.Rr[e])<i.Rfppas?i.Rr[e]=0:i.Rr[e]>0?i.Rr[e]=i.Rr[e]-i.Rfppas:i.Rr[e]=i.Rr[e]+i.Rfppas}if(i.etat[e]==i.QCQ&&((s=Math.sqrt(i.VQx[e]*i.VQx[e]+i.VQy[e]*i.VQy[e]))<i.delta_fgpas?i.etat[e]=i.RSG:(n=-i.fgpas*i.VQx[e]/s,o=-i.fgpas*i.VQy[e]/s,i.Vx[e]=i.Vx[e]+n,i.Vy[e]=i.Vy[e]+o,a=1-i.delta_fgpas/s,i.VQx[e]=i.VQx[e]*a,i.VQy[e]=i.VQy[e]*a),i.Rp[e]=-i.Vy[e]+i.VQy[e],i.Rq[e]=i.Vx[e]-i.VQx[e],Math.abs(i.Rr[e])<i.Rfppas?i.Rr[e]=0:i.Rr[e]>0?i.Rr[e]=i.Rr[e]-i.Rfppas:i.Rr[e]=i.Rr[e]+i.Rfppas),i.etat[e]==i.TSP){r=0;i.Vy[e]=0,i.Vx[e]=r;r=0;if(i.Rq[e]=0,i.Rp[e]=r,Math.abs(i.Rr[e])<i.Rfppas)return i.Rr[e]=0,i.etat[e]=i.ARRET,!0;i.Rr[e]>0?i.Rr[e]=i.Rr[e]-2*i.Rfppas:i.Rr[e]=i.Rr[e]+2*i.Rfppas}return i.X[e]=i.X[e]+i.Vx[e]*i.pas,i.Y[e]=i.Y[e]+i.Vy[e]*i.pas,i.RAp[e]=i.RAp[e]+i.Rp[e]*i.pas,i.RAq[e]=i.RAq[e]+i.Rq[e]*i.pas,i.RAr[e]=i.RAr[e]+i.Rr[e]*i.pas,!1},this.choc_gliss=function(e){i.VMz>0?(i.VT=i.VT-i.beta_gliss*Math.cos(i.alpha_bande),i.VRr=i.VRr+2.5*i.beta_gliss*Math.cos(i.alpha_bande)):(i.VT=i.VT+i.beta_gliss*Math.cos(i.alpha_bande),i.VRr=i.VRr-2.5*i.beta_gliss*Math.cos(i.alpha_bande))},this.choc_adh=function(e){var t,a,s=NaN,n=NaN,o=NaN,r=NaN,l=NaN,c=0;s=Math.abs(i.VT)<1e-5?90:180/Math.PI*Math.atan(i.VN0/i.VT),i.effet=100*i.R/2*i.VRr/Math.sqrt(i.VN0*i.VN0+i.VT*i.VT),i.effet<=-1.5?i.effet=-1.499:i.effet>1.5&&(i.effet=1.499),Math.abs(i.VT)<1e-5?n=i.effet>0?i.sorties[28]+(i.sorties[29]-i.sorties[28])*(i.effet/1.5):i.sorties[27]+(i.sorties[28]-i.sorties[27])*(i.effet+1.5)/1.5:(s=180/Math.PI*Math.atan(i.VN0/i.VT),c=parseInt(s/10),n=(o=i.effet>0?i.sorties[3*c+1]+(i.sorties[3*c+2]-i.sorties[3*c+1])*(i.effet/1.5):i.sorties[3*c+0]+(i.sorties[3*c+1]-i.sorties[3*c+0])*(i.effet+1.5)/1.5)+((i.effet>0?i.sorties[3*(c+1)+1]+(i.sorties[3*(c+1)+2]-i.sorties[3*(c+1)+1])*(i.effet/1.5):i.sorties[3*(c+1)+0]+(i.sorties[3*(c+1)+1]-i.sorties[3*(c+1)+0])*(i.effet+1.5)/1.5)-o)/10*(s-10*c)),Math.abs(n-90)<1e-5?i.VT=0:i.VT=n<90?i.VN/Math.tan(n/180*Math.PI):-i.VN*Math.tan((n-90)/180*Math.PI),Math.abs(i.VT)<1e-5?i.effet>0?i.e_s=i.eff_s[28]+(i.eff_s[29]-i.eff_s[28])*(i.effet/1.5):i.e_s=i.eff_s[27]+(i.eff_s[28]-i.eff_s[27])*(i.effet+1.5)/1.5:(i.effet>0?(r=i.eff_s[3*c+1]+(i.eff_s[3*c+2]-i.eff_s[3*c+1])*(i.effet/1.5),l=i.eff_s[3*(c+1)+1]+(i.eff_s[3*(c+1)+2]-i.eff_s[3*(c+1)+1])*(i.effet/1.5)):(r=i.eff_s[3*c+0]+(i.eff_s[3*c+1]-i.eff_s[3*c+0])*(i.effet+1.5)/1.5,l=i.eff_s[3*(c+1)+0]+(i.eff_s[3*(c+1)+1]-i.eff_s[3*(c+1)+0])*(i.effet+1.5)/1.5),i.e_s=r+(l-r)/10*(s-10*c)),a=(5*i.VN+2*i.VRq)/7,t=(5*i.VT-2*i.VRp)/7,i.VRr=.02*i.e_s/i.R*Math.sqrt(a*a+t*t)},this.recup_pars=function(e){i.X[e]>i.XMAX&&i.Vx[e]>0&&(i.Vx[e]=-i.VN,i.Rq[e]=-i.VRq,i.Vy[e]>0?(i.Vy[e]=i.VT,i.Rp[e]=i.VRp,i.Rr[e]=-i.VRr):(i.Vy[e]=-i.VT,i.Rp[e]=-i.VRp,i.Rr[e]=i.VRr)),i.X[e]<i.XMIN&&i.Vx[e]<0&&(i.Vx[e]=i.VN,i.Rq[e]=i.VRq,i.Vy[e]>0?(i.Vy[e]=i.VT,i.Rp[e]=i.VRp,i.Rr[e]=i.VRr):(i.Vy[e]=-i.VT,i.Rp[e]=-i.VRp,i.Rr[e]=-i.VRr)),i.Y[e]<i.YMIN&&i.Vy[e]<0&&(i.Vy[e]=i.VN,i.Rp[e]=-i.VRq,i.Vx[e]>0?(i.Vx[e]=i.VT,i.Rq[e]=-i.VRp,i.Rr[e]=-i.VRr):(i.Vx[e]=-i.VT,i.Rq[e]=i.VRp,i.Rr[e]=i.VRr)),i.Y[e]>i.YMAX&&i.Vy[e]>0&&(i.Vy[e]=-i.VN,i.Rp[e]=i.VRq,i.Vx[e]>0?(i.Vx[e]=i.VT,i.Rq[e]=-i.VRp,i.Rr[e]=i.VRr):(i.Vx[e]=-i.VT,i.Rq[e]=i.VRp,i.Rr[e]=-i.VRr))},this.init_pars=function(e){i.X[e]>i.XMAX&&i.Vx[e]>0&&(i.VN=-i.Vx[e],i.VRq=-i.Rq[e],i.Vy[e]>0?(i.VT=i.Vy[e],i.VRp=i.Rp[e],i.VRr=-i.Rr[e]):(i.VT=-i.Vy[e],i.VRp=-i.Rp[e],i.VRr=i.Rr[e])),i.X[e]<i.XMIN&&i.Vx[e]<0&&(i.VN=i.Vx[e],i.VRq=i.Rq[e],i.Vy[e]>0?(i.VT=i.Vy[e],i.VRp=i.Rp[e],i.VRr=i.Rr[e]):(i.VT=-i.Vy[e],i.VRp=-i.Rp[e],i.VRr=-i.Rr[e])),i.Y[e]<i.YMIN&&i.Vy[e]<0&&(i.VN=i.Vy[e],i.VRq=-i.Rp[e],i.Vx[e]>0?(i.VT=i.Vx[e],i.VRp=-i.Rq[e],i.VRr=-i.Rr[e]):(i.VT=-i.Vx[e],i.VRp=i.Rq[e],i.VRr=i.Rr[e])),i.Y[e]>i.YMAX&&i.Vy[e]>0&&(i.VN=-i.Vy[e],i.VRq=i.Rp[e],i.Vx[e]>0?(i.VT=i.Vx[e],i.VRp=-i.Rq[e],i.VRr=i.Rr[e]):(i.VT=-i.Vx[e],i.VRp=i.Rq[e],i.VRr=-i.Rr[e]))},this.add_clef=function(e){var t=i.nb_max_clefs*e+i.nb_clefs[e];i.evts[t]=new X,i.evts[t].X=i.X[e],i.evts[t].Y=i.Y[e],i.evts[t].RAp=i.RAp[e],i.evts[t].RAq=i.RAq[e],i.evts[t].RAr=i.RAr[e],i.evts[t].time=i.date*i.pas;var a=i.nb_clefs,s=e,n=a[e]+1;a[s]=n,i.X0[e]=i.X[e],i.Y0[e]=i.Y[e],i.RAp0[e]=i.RAp[e],i.RAq0[e]=i.RAq[e],i.RAr0[e]=i.RAr[e]},this.choc_billes=function(e){var t=0,a=0,s=!1,n=NaN,o=NaN,r=NaN,l=NaN,c=NaN,h=NaN,p=NaN,u=NaN,f=NaN,d=NaN,m=NaN,b=NaN,R=NaN,V=NaN,_=NaN,v=NaN,M=NaN,g=NaN,y=NaN,x=NaN,N=!1,C=[];for(t=0;t<3;)C[t]=!1,t++;for(t=0;t<3;){if(!C[t]&&(s=!1,a=(t+1)%3,(n=(i.X[t]-i.X[a])*(i.X[t]-i.X[a])+(i.Y[t]-i.Y[a])*(i.Y[t]-i.Y[a]))<i.D*i.D&&(i.etat[t]!=i.ARRET||i.etat[a]!=i.ARRET)&&(i.Vx[t]-i.Vx[a])*(i.X[a]-i.X[t])+(i.Vy[t]-i.Vy[a])*(i.Y[a]-i.Y[t])>0&&(s=!0,N=!0,i.choc12||i.choc13||0!=t||(i.first_bille_choquee=a),0==t&&1==a&&(i.choc12=!0),2==t&&0==a&&(i.choc13=!0),e[0]=t,e[1]=a),s||(a=(t+2)%3,(n=(i.X[t]-i.X[a])*(i.X[t]-i.X[a])+(i.Y[t]-i.Y[a])*(i.Y[t]-i.Y[a]))<i.D*i.D&&(i.etat[t]!=i.ARRET||i.etat[a]!=i.ARRET)&&(i.Vx[t]-i.Vx[a])*(i.X[a]-i.X[t])+(i.Vy[t]-i.Vy[a])*(i.Y[a]-i.Y[t])>0&&(s=!0,N=!0,i.choc12||i.choc13||0!=t||(i.first_bille_choquee=a),1==t&&0==a&&(i.choc12=!0),0==t&&2==a&&(i.choc13=!0),e[0]=t,e[1]=a)),s)){i.add_clef(t),i.add_clef(a),C[t]=!0,i.etat[t]==i.RSG&&(i.Rp[t]=-i.Vy[t],i.Rq[t]=i.Vx[t]),i.etat[t]==i.QCQ&&(i.Rp[t]=-i.Vy[t]+i.VQy[t],i.Rq[t]=i.Vx[t]-i.VQx[t]),i.etat[t]==i.ARRET&&(i.Rp[t]=0,i.Rq[t]=0),C[a]=!0,i.etat[a]==i.RSG&&(i.Rp[a]=-i.Vy[a],i.Rq[a]=i.Vx[a]),i.etat[a]==i.QCQ&&(i.Rp[a]=-i.Vy[a]+i.VQy[a],i.Rq[a]=i.Vx[a]-i.VQx[a]),i.etat[a]==i.ARRET&&(i.Rp[a]=0,i.Rq[a]=0),r=(m=i.Vx[t]*(i.X[a]-i.X[t])+i.Vy[t]*(i.Y[a]-i.Y[t]))*(i.X[a]-i.X[t])/n,l=m*(i.Y[a]-i.Y[t])/n,c=i.Vx[t]-r,h=i.Vy[t]-l,p=(b=i.Vx[a]*(i.X[t]-i.X[a])+i.Vy[a]*(i.Y[t]-i.Y[a]))*(i.X[t]-i.X[a])/n,u=b*(i.Y[t]-i.Y[a])/n,f=i.Vx[a]-p,d=i.Vy[a]-u,V=r-p,_=l-u,i.intens=(V*V+_*_)/5,i.intens>1&&(i.intens=1),i.evts_son[i.nb_sons]=new P,i.evts_son[i.nb_sons].played=!1,i.evts_son[i.nb_sons].temps=i.date*i.pas,i.evts_son[i.nb_sons].intensite=i.intens,i.evts_son[i.nb_sons].type_choc=2;var w=i,A=i.nb_sons+1;w.nb_sons=A,R=r,r=p,p=R,p*=i.RendementChoc,r*=i.RendementChoc,R=l,l=u,u=R,u*=i.RendementChoc,l*=i.RendementChoc,i.Vx[t]=r+c,i.Vy[t]=l+h,i.VQx[t]=i.Vx[t]-i.Rq[t],i.VQy[t]=i.Vy[t]+i.Rp[t],i.etat[a]==i.ARRET&&(i.Vx[a]=.94*i.Vx[a],i.Vy[a]=.94*i.Vy[a],m/=o=Math.sqrt(n),m=Math.abs(m),y=i.fbille*m,v=Math.abs(i.Rp[t]*(i.Y[a]-i.Y[t])-i.Rq[t]*(i.X[a]-i.X[t]))/o,g=(i.Vx[t]*(i.Y[a]-i.Y[t])-i.Vy[t]*(i.X[a]-i.X[t]))/o-i.Rr[t],M=Math.abs(g)<1e-5?Math.PI/2:Math.abs(Math.atan(v/g)),x=(g>0?1:-1)*y*Math.cos(M),i.Rr[a]=2.5*x,i.Rr[t]=i.Rr[t]-2.5*x,f=x*(i.Y[a]-i.Y[t])/o,d=-x*(i.X[a]-i.X[t])/o),i.Vx[a]=p+f,i.Vy[a]=u+d,i.VQx[a]=i.Vx[a]-i.Rq[a],i.VQy[a]=i.Vy[a]+i.Rp[a],i.etat[a]=i.QCQ,i.etat[t]=i.QCQ}t++}return N};this.XMAX=t,this.YMAX=a,this.XMIN=-t,this.YMIN=-a,this.nb_max_clefs=1e4,this.nb_clefs=[];this.nb_clefs[2]=0,this.nb_clefs[1]=0,this.nb_clefs[0]=0,this.evts=[],this.nb_max_sons=50,this.nb_sons=0,this.evts_son=[],this.sorties=[],this.eff_s=[],this.etat=[],this.X0=[],this.Y0=[],this.X=[],this.Y=[],this.Xfin=[],this.Yfin=[],this.RAp=[],this.RAq=[],this.RAr=[],this.RAp0=[],this.RAq0=[],this.RAr0=[],this.RApfin=[],this.RAqfin=[],this.RArfin=[],this.Vx=[],this.Vy=[],this.Rp=[],this.Rq=[],this.Rr=[],this.VQx=[],this.VQy=[],this.etat=[],this.D=.06,this.R=.03,this.RendementChoc=.8,this.deltaclefRot=this.R*Math.PI/10,this.resolution=.01,this.done=!1,this.sorties[0]=0,this.sorties[1]=0,this.sorties[2]=0,this.sorties[3]=7.5,this.sorties[4]=7.5,this.sorties[5]=7.5,this.sorties[6]=16,this.sorties[7]=16,this.sorties[8]=16,this.sorties[9]=33,this.sorties[10]=32,this.sorties[11]=23.5,this.sorties[12]=52,this.sorties[13]=43,this.sorties[14]=31,this.sorties[15]=72,this.sorties[16]=53,this.sorties[17]=35,this.sorties[18]=86,this.sorties[19]=60,this.sorties[20]=38,this.sorties[21]=100,this.sorties[22]=69,this.sorties[23]=44,this.sorties[24]=108,this.sorties[25]=79,this.sorties[26]=53,this.sorties[27]=120,this.sorties[28]=90,this.sorties[29]=60,this.eff_s[0]=-1.5,this.eff_s[1]=0,this.eff_s[2]=1.5,this.eff_s[3]=-1.5,this.eff_s[4]=.5,this.eff_s[5]=1.2,this.eff_s[6]=-1.3,this.eff_s[7]=.7,this.eff_s[8]=1.3,this.eff_s[9]=-.5,this.eff_s[10]=1.3,this.eff_s[11]=1.2,this.eff_s[12]=-.5,this.eff_s[13]=1.3,this.eff_s[14]=1.1,this.eff_s[15]=-.3,this.eff_s[16]=.8,this.eff_s[17]=1.2,this.eff_s[18]=0,this.eff_s[19]=.7,this.eff_s[20]=1.2,this.eff_s[21]=0,this.eff_s[22]=.5,this.eff_s[23]=1.5,this.eff_s[24]=-.6,this.eff_s[25]=.2,this.eff_s[26]=1.5,this.eff_s[27]=-.65,this.eff_s[28]=0,this.eff_s[29]=1.5},S=function e(t,a){var i=this;Object(r.a)(this,e),this.RApInit=[],this.RArInit=[],this.RAqInit=[],this.Xinit=[],this.Yinit=[],this.HBande=.035,this.direction_beta=function(e,t,a){var s,n,o;return o=Math.sqrt((i.Xinit[0]-t)*(i.Xinit[0]-t)+(i.Yinit[0]-a)*(i.Yinit[0]-a)),e*=.06,s=Math.asin(e/o),(n=i.atanjimi(a-i.Yinit[0],t-i.Xinit[0]))-s>Math.PI?n-s-2*Math.PI:n-s<-Math.PI?n-s+2*Math.PI:n-s},this.ToucheBandeX=function(e){for(var t,a,s,n,o,r,l,c,h,p,u,f,d,m=NaN,b=NaN;i.betaQ<0;)i.betaQ=i.betaQ+2*Math.PI;for(;i.betaQ>=2*Math.PI;)i.betaQ=i.betaQ-2*Math.PI;return p=i.betaQ,h=e,b=Math.cos(p),d=Math.sin(p),u=Math.cos(h),f=Math.sin(h),o=((c=Math.sqrt(9e-4-i.er*i.er-i.el*i.el))*u-i.er*f)*b-i.el*d,r=c*f+i.er*u,l=(c*u-i.er*f)*d+i.el*b,m=i.Xinit[0]+o,t=.03+r,i.Yinit[0]+l,s=i.long_billard/2,!(Math.abs(b)<1e-5)&&(p>Math.PI/2&&p<3*Math.PI/2&&(b=-b,m=-m),!((n=(s-m)/b)>1.4)&&(a=.006+.009/1.4*n/u,!(n*f/u+t>i.HBande+a/u)))},this.atanjimi=function(e,t){var a;return Math.abs(t)<1e-6?e>0?Math.PI/2:-Math.PI/2:(a=Math.atan(e/t),t>0?a:e<0?a-Math.PI:a+Math.PI)},this.Quantite=function(){var e,t=0,a=[],s=[];for(e=i.betaQ+Math.PI,t=1;t<i.NBILLES;)a[t]=!1,(i.Xinit[t]-i.Xinit[0])*Math.cos(e)+(i.Yinit[t]-i.Yinit[0])*Math.sin(e)>0&&(s[t]=(i.Yinit[t]-i.Yinit[0])*Math.cos(e)-(i.Xinit[t]-i.Xinit[0])*Math.sin(e),s[t]<.06&&s[t]>-.06&&(a[t]=!0)),t++;i.bille_visee=-1;var n=100;for(t=1;t<i.NBILLES;)a[t]&&(i.Xinit[t]-i.Xinit[0])*(i.Xinit[t]-i.Xinit[0])+(i.Yinit[t]-i.Yinit[0])*(i.Yinit[t]-i.Yinit[0])<n&&(i.bille_visee=t,n=(i.Xinit[t]-i.Xinit[0])*(i.Xinit[t]-i.Xinit[0])+(i.Yinit[t]-i.Yinit[0])*(i.Yinit[t]-i.Yinit[0])),t++;return-1!=i.bille_visee?(i.noba=!0,i.quant=s[i.bille_visee]/2/.03):(i.noba=!1,i.quant=0),i.quant},this.ToucheBandeZ=function(e){for(var t,a,s,n,o,r,l,c,h,p,u,f,d,m=NaN,b=NaN;i.betaQ<0;)i.betaQ=i.betaQ+2*Math.PI;for(;i.betaQ>=2*Math.PI;)i.betaQ=i.betaQ-2*Math.PI;return p=i.betaQ,h=e,d=Math.cos(p),b=Math.sin(p),u=Math.cos(h),f=Math.sin(h),o=((c=Math.sqrt(9e-4-i.er*i.er-i.el*i.el))*u-i.er*f)*d-i.el*b,r=c*f+i.er*u,l=(c*u-i.er*f)*b+i.el*d,i.Xinit[0]+o,t=.03+r,m=i.Yinit[0]+l,s=i.larg_billard/2,!(Math.abs(b)<1e-5)&&(p>Math.PI&&(b=-b,m=-m),!((n=(s-m)/b)>1.4)&&(a=.006+.009/1.4*n/u,!(n*f/u+t>i.HBande+a/u)))},this.AlphaQmin=function(){for(var e=0;i.ToucheBandeZ(e)||i.ToucheBandeX(e)||i.ToucheBille(e);)e+=Math.PI/90;return e},this.ToucheBille=function(e){var t=NaN,a=NaN,s=NaN,n=NaN,o=NaN,r=NaN,l=NaN,c=NaN,h=NaN,p=NaN,u=NaN,f=0,d=e,m=i.betaQ;for(f=1;f<i.NBILLES;){for(t=i.Xinit[0]+.032*Math.cos(m)*Math.cos(d)-i.el*Math.sin(m)-i.er*Math.sin(d)*Math.cos(m),a=.03+.032*Math.sin(d)+i.er*Math.cos(d),s=i.Yinit[0]+.032*Math.sin(m)*Math.cos(d)+i.el*Math.cos(m)-i.er*Math.sin(d)*Math.sin(m),r=i.Xinit[f],l=.03,c=i.Yinit[f],o=0;o<1.4;){if(n=.006+.009/1.4*o,((h=t+o*Math.cos(d)*Math.cos(m))-r)*(h-r)+((p=a+o*Math.sin(d))-l)*(p-l)+((u=s+o*Math.cos(d)*Math.sin(m))-c)*(u-c)<(.03+n+.002)*(.03+n+.002))return!0;o+=.01}f++}return!1};var s=0;for(this.NBILLES=3,this.long_billard=t,this.larg_billard=a,this.Xinit=[],this.Yinit=[],this.RApInit=[],this.RAqInit=[],this.RArInit=[],s=0;s<3;)this.RApInit[s]=0,this.RAqInit[s]=0,this.RArInit[s]=0,s++;this.Xinit[0]=-.71,this.Yinit[0]=-.1775,this.Xinit[1]=-.71,this.Yinit[1]=0,this.Xinit[2]=.71,this.Yinit[2]=0,this.Vqueue=.08,this.el=0,this.er=.012,this.alphaQ=0,this.betaQ=0*Math.PI/4,this.Vqueue=3.19731,this.el=.0056,this.er=.004,this.alphaQ=.033916,this.betaQ=3.28339,this.Xinit[0]=0,this.Yinit[0]=0,this.Xinit[1]=-.051,this.Yinit[1]=.05,this.Xinit[2]=.05,this.Yinit[2]=.05,this.Vqueue=.4,this.el=0,this.er=0,this.alphaQ=.033916,this.betaQ=-7*Math.PI/8},I=function e(t,a,i,s){var n=this;Object(r.a)(this,e),this.mode_jeu=2,this.ralenti=1,this.largeur_bandes=.28,this.change_billard=function(e){if(n.arret_son(),n.myTimer.stop(),1==e){n.taille(280);var t=!1;n.bitmap_Bandes_310.visible=!1,n.bitmap_Billard_310.visible=t;t=!0;n.bitmap_Bandes_280.visible=!0,n.bitmap_Billard_280.visible=t;t=!1;n.bitmap_Bandes_260.visible=!1,n.bitmap_Billard_260.visible=t}else if(2==e){n.taille(260);t=!1;n.bitmap_Bandes_310.visible=!1,n.bitmap_Billard_310.visible=t;t=!1;n.bitmap_Bandes_280.visible=!1,n.bitmap_Billard_280.visible=t;t=!0;n.bitmap_Bandes_260.visible=!0,n.bitmap_Billard_260.visible=t}else if(0==e){n.taille(310);t=!0;n.bitmap_Bandes_310.visible=!0,n.bitmap_Billard_310.visible=t;t=!1;n.bitmap_Bandes_280.visible=!1,n.bitmap_Billard_280.visible=t;t=!1;n.bitmap_Bandes_260.visible=!1,n.bitmap_Billard_260.visible=t}n.ctrl.XC=n.Ech*n.longueur/2,n.ctrl.YC=n.Ech*n.largeur/2,n.Params.long_billard=2*(n.xmax+n.R),n.Params.larg_billard=2*(n.ymax+n.R),null!=n.Simulateur&&(n.Simulateur.XMAX=n.xmax,n.Simulateur.YMAX=n.ymax,n.Simulateur.XMIN=-n.xmax,n.Simulateur.YMIN=-n.ymax),n.tracer_grille(),n.tracer_lines(),n.Placer_billes_hasard(),n.Params.Vqueue=1,n.init_point()},this.arret_son=function(){},this.init_point=function(){n.arret_son(),n.myTimer.stop(),n.afficher_billes(),n.ctrl.aff_parametres(),n.placer_queue(n.dq0),n.queue.visible=!0,n.calculs_faits=!1,n.aff_trajets=!1,n.trajets.graphics.clear(),n.tracer_ligne_visee(),n.ligne_visee.visible=!0},this.update_modejeu=function(e){n.mode_jeu=e,n.arret_son(),0==e&&(n.Vqmax=3.5),1==e&&(n.Vqmax=3.5),2==e&&(n.Vqmax=4.2),3==e&&(n.Vqmax=3.5),4==e&&(n.Vqmax=3.5),5==e&&(n.Vqmax=5.4)},this.Simuler=function(e,t){return n.ralenti=e,n.arret_son(),n.Simulateur.Calcul(t)},this.taille=function(e){n.taille_billard=e,310==e&&(n.longueur=3.12),280==e&&(n.longueur=2.82),260==e&&(n.longueur=2.62),n.xmax=(n.longueur-n.largeur_bandes)/2-.03,n.ymax=(n.longueur-n.largeur_bandes)/4-.03,n.largeur=2*(n.ymax+.03)+n.largeur_bandes};var o=0;this.Ech=i,this.R=.03,this.Rb=36,this.type=0,this.taille(t),this.Params=new S(2*(this.xmax+this.R),2*(this.ymax+this.R));for(this.ombre=[],this.aff_trajets=!1,this.tous_trajets=!0,this.trajet_bille_joueur=!1,this.trajet_bille_visee=!1,this.billes=[],this.bille_visee=1,this.ecl=[],this.dq0=1.5*this.R*this.Ech,this.alphamin=!0,this.Vqmax=3.5,this.Simulateur=new q(this.xmax,this.ymax),this.ind_last_clef=[],o=0;o<3;)this.ind_last_clef[o]=this.Simulateur.nb_max_clefs*o,o++;for(this.calculs_faits=!1,this.ampl_recul_max=.1,this.RAp0=[],this.RAq0=[],this.RAr0=[],o=0;o<3;)this.RAp0[o]=0,this.RAq0[o]=0,this.RAr0[o]=0,o++;this.alphamin=!1,console.log(this)},T=function(){function e(t,a,i,s,n){var o=this;Object(r.a)(this,e),this.drawBallPath=function(e){if(void 0!=o.pathCueWhite&&o.pathCueWhite.dispose(),void 0!=o.pathCueYellow&&o.pathCueYellow.dispose(),void 0!=o.pathTargetBall&&o.pathTargetBall.dispose(),1==e){var t=o.pathData;if(0==t.length)return;for(var a=[],i=0;i<1e4;i++)t[i]&&a.push(new m.Vector3(V*t[i].X/o.size,o.ballRadius/2,V*t[i].Y/o.size));o.pathCueWhite=new m.MeshBuilder.CreateLines("lines",{points:a},o.scene);var s=[],n=[];for(i=1e4;i<2e4;i++)t[i]&&(s.push(new m.Vector3(V*t[i].X/o.size,o.ballRadius/2,V*t[i].Y/o.size)),n.push(new m.Color4(.8,.8,0,1)));o.pathCueYellow=new m.MeshBuilder.CreateLines("lines",{points:s,colors:n},o.scene);var r=[],l=[];for(i=2e4;i<3e4;i++)t[i]&&(r.push(new m.Vector3(V*t[i].X/o.size,o.ballRadius/2,V*t[i].Y/o.size)),l.push(new m.Color4(.8,0,0,1)));o.pathTargetBall=new m.MeshBuilder.CreateLines("lines",{points:r,colors:l},o.scene)}},this.configCameras=function(){var e=o;e.cameras.arcCam=new m.ArcRotateCamera("Camera-Arc",4.44,1.05,300,m.Vector3.Zero(),e.scene),e.cameras.arcCam.attachControl(e.canvas),e.cameras.arcCam.upperBetaLimit=1.5,e.cameras.arcCam.wheelPrecision=.2,e.cameras.arcCam.upperRadiusLimit=500,e.cameras.arcCam.lowerRadiusLimit=200,e.cameras.topCam=new m.ArcRotateCamera("Camera-Top",-Math.PI/2,0,330,m.Vector3.Zero(),e.scene),e.cameras.topCam.upperBetaLimit=0,e.cameras.topCam.lowerBetaLimit=0,e.cameras.topCam.upperAlphaLimit=-Math.PI/2,e.cameras.topCam.lowerAlphaLimit=-Math.PI/2,e.cameras.topCam.upperRadiusLimit=330,e.cameras.topCam.lowerRadiusLimit=330,e.cameras.topCam.mode=m.Camera.ORTHOGRAPHIC_CAMERA,e.cameras.topCam.orthoTop=130,e.cameras.topCam.orthoBottom=-130,e.cameras.topCam.orthoLeft=-240,e.cameras.topCam.orthoRight=240,e.changeView(e.currentView)},this.loadModels=function(){var e=o,t=o.modelStorePath;m.SceneLoader.ImportMesh("",t,R,e.scene,function(a){e.objects.bat=a[0],e.objects.bat.position.y=50,e.objects.bat.position.z=90,e.objects.batLookatPoint=new m.MeshBuilder.CreateSphere("look-at",{diameter:4},e.scene),e.objects.batLookatPoint.position.y=30,e.objects.batLookatPoint.visibility=!1,m.SceneLoader.ImportMesh("",t,b,e.scene,function(a){e.objects.table=a;var i=!0,s=!1,n=void 0;try{for(var o,r=a[Symbol.iterator]();!(i=(o=r.next()).done);i=!0){var l=o.value;"carpet"===l.name&&(l.material.bumpTexture=new m.Texture(t+"carpet-bump.png",e.scene))}}catch(c){s=!0,n=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw n}}e.configCueBalls(),e.updateBat(e.controlOptions)})})},this.updateControlOptions=function(e){o.controlOptions=e,o.updateBat(e)},this.updateBat=function(e){var t=e.cueLine,a=e.cueAngle,i=e.sideEnglish,s=e.topSpin,n=o.size,r=o.ballRadius,l=o.objects,c=l.bat,h=l.batLookatPoint,p=l.directionLine,u=l.cueBallWhite,f=V*i/n,d=V*s/n;c.position.x=u.position.x-f*Math.sin(t)-d*Math.sin(a)*Math.cos(t),c.position.z=u.position.z+f*Math.cos(t)-d*Math.sin(a)*Math.sin(t),c.position.y=r/2+d*Math.cos(a),c.rotation=new m.Vector3(0,-t,Math.PI/2+a);var b=Object.assign({},c.position);b.y+=40*Math.sin(a),b.x+=40*Math.cos(a)*Math.cos(t),b.z+=40*Math.cos(a)*Math.sin(t),h.position=b,h.lookAt(c.position),p.position.x=u.position.x,p.position.z=u.position.z,p.position.y=r/2,p.rotation.y=Math.PI-t},this.generateReflectionMaterial=function(e,t){for(var a=o.scene,i=new m.ReflectionProbe("satelliteProbe"+e.name,512,a),s=0;s<t.length;s++)i.renderList.push(t[s]);e.material.reflectionTexture=i.cubeTexture,e.material.reflectivityColor=new m.Color3(.2,.2,.2),e.material.reflectionFresnelParameters=new m.FresnelParameters,e.material.reflectionFresnelParameters.bias=0,i.attachToMesh(e)},this.configCueBalls=function(){var e,t,a=o,i=o.modelStorePath,s=o.ballRadius,n=o.objects.table,r=(o.cameras.arcCam,!0),l=!1,c=void 0;try{for(var h,p=n[Symbol.iterator]();!(r=(h=p.next()).done);r=!0){var u=h.value;"carpet"===u.name?e=u:"carpet-side"===u.name&&(t=u)}}catch(g){l=!0,c=g}finally{try{r||null==p.return||p.return()}finally{if(l)throw c}}var f=o.ballPositions,d=f.posCueBallWhite,b=f.posCueBallYellow,R=f.posTargetBall;a.objects.cueBallWhite=m.Mesh.CreateSphere("cue-ball-white",16,s,a.scene),a.objects.cueBallWhite.position.y=s/2,a.objects.cueBallWhite.position.x=d.x,a.objects.cueBallWhite.position.z=d.z;var V=new m.StandardMaterial("redMat",a.scene);V.diffuseTexture=new m.Texture(i+"cueball-white.jpg",a.scene),a.objects.cueBallWhite.material=V,a.objects.cueBallYellow=m.Mesh.CreateSphere("cue-ball-yellow",16,s,a.scene),a.objects.cueBallYellow.position.y=s/2,a.objects.cueBallYellow.position.x=b.x,a.objects.cueBallYellow.position.z=b.z;var _=new m.StandardMaterial("redMat",a.scene);_.diffuseTexture=new m.Texture(i+"cueball-yellow.jpg",a.scene),a.objects.cueBallYellow.material=_,a.objects.targetBall=m.Mesh.CreateSphere("cue-ball-red",16,s,a.scene),a.objects.targetBall.position.y=s/2,a.objects.targetBall.position.x=R.x,a.objects.targetBall.position.z=R.z;var v=new m.StandardMaterial("redMat",a.scene);v.diffuseTexture=new m.Texture(i+"targetball.jpg",a.scene),a.objects.targetBall.material=v,a.generateReflectionMaterial(a.objects.cueBallWhite,[a.objects.cueBallYellow,a.objects.targetBall,a.objects.bat,e,t]),a.generateReflectionMaterial(a.objects.cueBallYellow,[a.objects.cueBallWhite,a.objects.targetBall,a.objects.bat,e,t]),a.generateReflectionMaterial(a.objects.targetBall,[a.objects.cueBallWhite,a.objects.cueBallYellow,a.objects.bat,e,t]),a.objects.ray=new m.Ray,a.objects.rayHelper=new m.RayHelper(a.objects.ray);var M=new m.Vector3(0,0,1);a.objects.rayHelper.attachToMesh(a.objects.batLookatPoint,M)},this.configGrids=function(){for(var e=o,t=[new m.Color4(.7,.7,.7,1),new m.Color4(.7,.7,.7,1)],a=0;a<15;a++){var i=[new m.Vector3(7*-V/16+a*V/16,2,-V/4),new m.Vector3(7*-V/16+a*V/16,2,V/4)];e.grids.push(m.MeshBuilder.CreateLines("lines",{points:i,colors:t},e.scene))}for(a=0;a<7;a++){var s=[new m.Vector3(-V/2,2,3*-V/16+a*V/16),new m.Vector3(V/2,2,3*-V/16+a*V/16)];e.grids.push(m.MeshBuilder.CreateLines("lines",{points:s,colors:t},e.scene))}},this.toggleGrids=function(e){for(var t=o.grids,a=0;a<t.length;a++)t[a].visibility=e},this.initializeScene=function(e,t){var a=o;a.scene=e,a.canvas=t,a.scene.clearColor=new m.Color3(.05,.05,.05),a.objects.directionLine=new m.MeshBuilder.CreateLines("direction-line",{points:[new m.Vector3(0,0,0),new m.Vector3(600,0,0)],colors:[new m.Color4(0,0,.8,1),new m.Color4(0,0,.8,1)]}),new m.HemisphericLight("light",m.Vector3.Up(),e),a.configCameras(),a.loadModels(),a.configGrids(),a.scene.getEngine().runRenderLoop(function(){e&&e.render()}),t.addEventListener("pointerdown",a.onPointerDown,!1),t.addEventListener("pointerup",a.onPointerUp,!1),t.addEventListener("pointermove",a.onPointerMove,!1)},this.getGroundPosition=function(){var e=o.scene,t=e.pick(e.pointerX,e.pointerY,function(e){return"carpet"==e.name});return t.hit?t.pickedPoint:null},this.onPointerDown=function(e){var t=o,a=o.scene,i=o.canvas;if(0===e.button){var s=a.pick(a.pointerX,a.pointerY,function(e){return"cue-ball-white"===e.name||"cue-ball-yellow"===e.name||"cue-ball-red"===e.name});s.hit&&(t.currentMesh=s.pickedMesh,t.startingPoint=t.getGroundPosition(e),t.startingPoint&&setTimeout(function(){t.cameras.arcCam.detachControl(i)},0))}},this.onPointerUp=function(){var e=o,t=o.startingPoint,a=o.canvas;if(t)return e.cameras.arcCam.attachControl(a,!0),e.startingPoint=null,void(e.currentMesh=null)},this.onPointerMove=function(e){var t=o,a=o.startingPoint,i=o.currentMesh;if(a){var s=t.getGroundPosition(e);s&&(i.position=s,i.position.y=t.ballRadius/2,a=s,t.updateBat(t.controlOptions))}},this.animateBall=function(e,t,a){for(var i=o,s=[],n=[],r=new m.Animation("anim-movement","position",1e3,m.Animation.ANIMATIONTYPE_VECTOR3),l=new m.Animation("anim-rotation","rotation",1e3,m.Animation.ANIMATIONTYPE_VECTOR3),c=0,h=e;h<t;h++)if(i.pathData[h]){s.push({frame:isNaN(i.pathData[h].time)?0:parseInt(1e3*i.pathData[h].time),value:new m.Vector3(V*i.pathData[h].X/i.size,i.ballRadius/2,V*i.pathData[h].Y/i.size)});var p=i.pathData[h].RAp,u=i.pathData[h].RAq,f=i.pathData[h].RAr;if(i.pathData[h+1]){p+=.3*(i.pathData[h+1].RAp-p),u+=.3*(i.pathData[h+1].RAq-u),f+=.3*(i.pathData[h+1].RAp-f)}u/=.2,u/=.2,f/=.2,n.push({frame:isNaN(i.pathData[h].time)?0:parseInt(1e3*i.pathData[h].time),value:new m.Vector3(-f,p,-u)}),c=parseInt(1e3*i.pathData[h].time)}r.setKeys(s),l.setKeys(n),a.animations=[],a.animations.push(r),a.animations.push(l),i.scene.beginAnimation(a,0,c,!1)},this.startAnimation=function(){o.animateBall(0,1e4,o.objects.cueBallWhite),o.animateBall(1e4,2e4,o.objects.cueBallYellow),o.animateBall(2e4,3e4,o.objects.targetBall)},this.playSimulation=function(){var e=o,t=o.controlOptions,a=o.objects,i=a.cueBallWhite,s=a.cueBallYellow,n=a.targetBall,r=new I(310,void 0,300).Simuler(1,{Xinit:[e.size*i.position.x/400,e.size*s.position.x/400,e.size*n.position.x/400],Yinit:[e.size*i.position.z/400,e.size*s.position.z/400,e.size*n.position.z/400],RApInit:[0,0,0],RAqInit:[0,0,0],RArInit:[0,0,0],el:t.sideEnglish,er:t.topSpin,alphaQ:t.cueAngle,betaQ:t.cueLine,Vqueue:t.speed});o.pathData=r,o.startAnimation(),o.drawBallPath(!0)},this.scene=void 0,this.canvas=void 0,this.size=t,this.ballRadius=400*_/(100*this.size),this.modelStorePath=a,this.initBallPosition=s,this.ballPositions={posCueBallWhite:{x:V*s.posCueBallWhite.x/t,z:V*s.posCueBallWhite.z/t},posCueBallYellow:{x:V*s.posCueBallYellow.x/t,z:V*s.posCueBallYellow.z/t},posTargetBall:{x:V*s.posTargetBall.x/t,z:V*s.posTargetBall.z/t}},this.currentView=i,this.cameras={arcCam:void 0,topCam:void 0},this.objects={table:void 0,bat:void 0,cueBallWhite:void 0,cueBallYellow:void 0,targetBall:void 0,batContactLine:void 0,batLookatPoint:void 0,directionLine:void 0},this.controlOptions=n,this.grids=[],this.pathCueWhite=void 0,this.pathCueYellow=void 0,this.pathTargetBall=void 0,this.pathData=[]}return Object(l.a)(e,[{key:"changeView",value:function(e){"2d"===e?(this.scene.activeCamera=this.cameras.topCam,this.cameras.arcCam.detachControl(this.canvas),this.cameras.topCam.attachControl(this.canvas)):(this.scene.activeCamera=this.cameras.arcCam,this.cameras.arcCam.attachControl(this.canvas),this.cameras.topCam.detachControl(this.canvas))}}]),e}(),j=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).meshPicked=function(e){console.log("mesh picked",e)},a.drawBallPath=function(e){a.board.drawBallPath(e)},a.onSceneMount=function(e){var t=e.canvas,i=e.scene;a.board.initializeScene(i,t)},a.toggleGrids=function(e){a.board.toggleGrids(e)},a.playSimulation=function(){a.board.playSimulation()},a.updateControlOptions=function(e){a.board.updateControlOptions(e)},a.state={showPath:!1},a.board=new T(a.props.size,a.props.modelStorePath,a.props.currentView,{posCueBallWhite:{x:a.props.posCueBallWhite.x,z:a.props.posCueBallWhite.z},posCueBallYellow:{x:a.props.posCueBallYellow.x,z:a.props.posCueBallYellow.z},posTargetBall:{x:a.props.posTargetBall.x,z:a.props.posTargetBall.z}},{cueLine:a.props.cueLine,cueAngle:a.props.cueAngle,sideEnglish:a.props.sideEnglish,topSpin:a.props.topSpin,speed:a.props.speed}),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"changeView",value:function(e){this.board.changeView(e)}},{key:"render",value:function(){return s.a.createElement(d.a,{canvasId:"carom-simulator-canvas"},s.a.createElement(d.b,{onMeshPicked:this.meshPicked,onSceneMount:this.onSceneMount}))}}]),t}(s.a.Component),E=a(5),Q=a(6),z=(a(31),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).componentWillReceiveProps=function(e){var t=e.value;a.setState({value:t})},a.updateValue=function(e){a.setState({value:e}),a.props.onUpdate(a.props.itemKey,e)},a.onChangeValue=function(e){var t=e.target.value;a.updateValue(t)},a.onMinusPressed=function(){var e=a.state.value,t=a.props,i=t.min,s=t.step;void 0===s&&(s=.1),(e=(10*e-(s*=10))/10)<i&&(e=i),a.updateValue(e)},a.onPlusPressed=function(){var e=a.state.value,t=a.props,i=t.max,s=t.step;void 0===s&&(s=.1),(e=(10*e+(s*=10))/10)>i&&(e=i),a.updateValue(e)},a.state={value:a.props.value?a.props.value:0},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.value,t=this.props,a=t.containerClass,i=t.label,n=t.min,o=t.max,r=t.unitDom,l=t.step;return void 0===l&&(l=.1),s.a.createElement("div",{className:a},s.a.createElement("div",{style:{display:"flex"}},s.a.createElement(E.a,{icon:Q.d,className:"btn-change-value",onClick:this.onMinusPressed}),s.a.createElement("span",{style:{flex:1,textAlign:"center"}},i,s.a.createElement("span",null," : ",e,r)),s.a.createElement(E.a,{icon:Q.f,className:"btn-change-value",onClick:this.onPlusPressed})),s.a.createElement("input",{type:"range",min:n,max:o,value:e,className:"slider",step:l,onChange:this.onChangeValue}))}}]),t}(s.a.Component)),L=(a(32),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).onInputSliderUpdated=function(e,t){var i=Object.assign({},a.state);i[e]=parseFloat(t),a.setState(i);var s=Object.assign({},i);s.cueLine=Math.PI*i.cueLine/180,s.cueAngle=Math.PI*i.cueAngle/180,s.sideEnglish/=1e3,s.topSpin/=1e3,s.speed/=100,a.props.onControlOptionsUpdated(s)},a.state={cueLine:Math.round(1800*a.props.cueLine/Math.PI)/10,cueAngle:Math.round(1800*a.props.cueAngle/Math.PI)/10,sideEnglish:Math.round(1e4*a.props.sideEnglish)/10,topSpin:Math.round(1e4*a.props.topSpin)/10,speed:Math.round(100*a.props.speed)},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.cueLine,i=t.cueAngle,n=t.sideEnglish,o=t.topSpin,r=t.speed,l=this.props,c=l.showGrid,h=l.showPath,p="toggle-btn",u="toggle-btn";return!0===c&&(p+=" active"),!0===h&&(u+=" active"),s.a.createElement("div",null,s.a.createElement("div",{className:"common-controller-container"},s.a.createElement(E.a,{className:p,icon:Q.h,onClick:function(){e.props.onToggleShowGrid(!c)}}),s.a.createElement(E.a,{className:u,icon:Q.b,onClick:function(){e.props.onToggleShowPath(!h)}}),s.a.createElement(E.a,{className:"toggle-btn",icon:Q.i})),s.a.createElement("div",null,s.a.createElement(z,{label:"Cue Line",containerClass:"slider-container",min:0,max:360,value:a,unitDom:s.a.createElement("sup",null,"o"),itemKey:"cueLine",onUpdate:this.onInputSliderUpdated}),s.a.createElement(z,{label:"Cue Angle",containerClass:"slider-container",min:2,max:89,value:i,unitDom:s.a.createElement("sup",null,"o"),itemKey:"cueAngle",onUpdate:this.onInputSliderUpdated}),s.a.createElement("br",null),s.a.createElement(z,{label:"Side English",containerClass:"slider-container",min:-15.1,max:15.1,value:n,unitDom:s.a.createElement("span",null,"mm"),itemKey:"sideEnglish",onUpdate:this.onInputSliderUpdated}),s.a.createElement(z,{label:"Top Spin",containerClass:"slider-container",min:-15.1,max:15.1,value:o,unitDom:s.a.createElement("span",null,"mm"),itemKey:"topSpin",onUpdate:this.onInputSliderUpdated}),s.a.createElement(z,{label:"Speed",containerClass:"slider-container",min:0,max:450,value:r,step:1,unitDom:s.a.createElement("span",null,"cm/s"),itemKey:"speed",onUpdate:this.onInputSliderUpdated})),s.a.createElement("div",{className:"play-controller-container"},s.a.createElement(E.a,{className:"play-controller",icon:Q.a}),s.a.createElement(E.a,{className:"play-controller",icon:Q.g}),s.a.createElement(E.a,{className:"play-controller",icon:Q.e,onClick:this.props.onPlayPressed}),s.a.createElement(E.a,{className:"play-controller",icon:Q.c})))}}]),t}(s.a.Component)),O=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(c.a)(this,Object(h.a)(t).call(this))).componentWillMount=function(){e.updateSimulateInfo()},e.updateSimulateInfo=function(){var t=["Santiago  Soto Sanchez","...","0","310","2","1","1.1661666666666661","0.6288333333333332","0.8181666666666672","0.5041666666666665","-0.6036666666666667","-0.003833333333333161","4.015999999999998","0.520497057626843","0.21066799020683835","-0.0013500000000002585","-0.0146999999999997"],a={size:2.8,cueLine:parseFloat(t[A]),cueAngle:parseFloat(t[w]),sideEnglish:parseFloat(t[B]),topSpin:parseFloat(t[Y]),speed:parseFloat(t[C]),posCueBallWhite:{x:parseFloat(t[v]),z:parseFloat(t[M])},posCueBallYellow:{x:parseFloat(t[g]),z:parseFloat(t[y])},posTargetBall:{x:parseFloat(t[x]),z:parseFloat(t[N])}};e.setState(a)},e.viewSelectorItemClicked=function(t){e.setState({currentView:t}),e.simulator.current.changeView(t)},e.onToggleShowGrid=function(t){e.setState({showGrid:t}),e.simulator.current.toggleGrids(t)},e.onToggleShowPath=function(t){e.setState({showPath:t}),e.simulator.current.drawBallPath(t)},e.onPlayPressed=function(){e.simulator.current.playSimulation()},e.onControlOptionsUpdated=function(t){e.simulator.current.updateControlOptions(t)},e.state={currentView:"2d",showGrid:!0,showPath:!1,size:310,cueLine:30,cueAngle:5,sideEnglish:-8.7,topSpin:7.5,speed:380,posCueBallWhite:{},posCueBallYellow:{},posTargetBall:{}},e.simulator=s.a.createRef(),e}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.currentView,a=e.showGrid,i=e.showPath,n=e.size,o=e.cueLine,r=e.cueAngle,l=e.sideEnglish,c=e.topSpin,h=e.speed,p=e.posCueBallWhite,u=e.posCueBallYellow,d=e.posTargetBall;return s.a.createElement("div",{className:"simulator-container"},s.a.createElement(f,{currentView:t,viewSelectorItemClicked:this.viewSelectorItemClicked}),s.a.createElement(j,{modelStorePath:this.props.modelStorePath,ref:this.simulator,size:n,currentView:t,cueLine:o,cueAngle:r,sideEnglish:l,topSpin:c,speed:h,posCueBallWhite:p,posCueBallYellow:u,posTargetBall:d}),s.a.createElement(L,{showGrid:a,showPath:i,cueLine:o,cueAngle:r,sideEnglish:l,topSpin:c,speed:h,onControlOptionsUpdated:this.onControlOptionsUpdated,onToggleShowGrid:this.onToggleShowGrid,onToggleShowPath:this.onToggleShowPath,onPlayPressed:this.onPlayPressed}))}}]),t}(s.a.Component);var k=function(){return s.a.createElement("div",{className:"simulator-container"},s.a.createElement(O,{modelStorePath:"./models/"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[18,1,2]]]);
//# sourceMappingURL=main.a8d40230.chunk.js.map