(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,a){},18:function(e,t,a){e.exports=a(33)},23:function(e,t,a){},24:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),s=a(16),i=a.n(s),l=(a(23),a(24),a(6)),r=a(7),c=a(10),p=a(8),u=a(9),h=a(3),m=(a(12),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).viewSelectorItemClicked=a.viewSelectorItemClicked.bind(Object(h.a)(a)),a}return Object(u.a)(t,e),Object(r.a)(t,[{key:"viewSelectorItemClicked",value:function(e){"function"===typeof this.props.viewSelectorItemClicked&&this.props.viewSelectorItemClicked(e)}},{key:"render",value:function(){var e=this,t="view-selector-item",a="view-selector-item";return"2d"===this.props.currentView?t+=" active":a+=" active",n.a.createElement("div",{className:"view-selector"},n.a.createElement("span",{className:t,onClick:function(){e.viewSelectorItemClicked("2d")}},"2D"),n.a.createElement("span",{className:a,onClick:function(){e.viewSelectorItemClicked("3d")}},"3D"))}}]),t}(o.Component)),d=a(13),v=a(1),g="table.babylon",w="bat.babylon",C=400,f=10,y=2,b=30,B=.6,S=30,P=.2,M=.9,I=.4,E=3,x=6,O=7,j=8,z=9,T=10,k=11,L=12,V=13,W=14,Y=15,A=16,N=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).meshPicked=function(e){console.log("mesh picked",e)},a.configCameras=function(){var e=Object(h.a)(a);e.arcCam=new v.ArcRotateCamera("Camera-Arc",4.44,1.05,300,v.Vector3.Zero(),e.scene),e.arcCam.attachControl(e.canvas),e.arcCam.upperBetaLimit=1.5,e.arcCam.wheelPrecision=.2,e.arcCam.upperRadiusLimit=500,e.arcCam.lowerRadiusLimit=200,e.topCam=new v.ArcRotateCamera("Camera-Top",-Math.PI/2,0,330,v.Vector3.Zero(),e.scene),e.topCam.upperBetaLimit=0,e.topCam.lowerBetaLimit=0,e.topCam.upperAlphaLimit=-Math.PI/2,e.topCam.lowerAlphaLimit=-Math.PI/2,e.topCam.upperRadiusLimit=330,e.topCam.lowerRadiusLimit=330},a.configCueBalls=function(){var e=Object(h.a)(a),t=a.props.modelStorePath;e.cueBallWhite=v.Mesh.CreateSphere("sphere1",16,f,e.scene),e.cueBallWhite.position.y=f,e.cueBallWhite.position.x=a.state.posCueBallWhite.x,e.cueBallWhite.position.z=a.state.posCueBallWhite.z;var o=new v.StandardMaterial("redMat",e.scene);o.diffuseTexture=new v.Texture(t+"cueball-white.jpg",e.scene),e.cueBallWhite.material=o,e.cueBallYellow=v.Mesh.CreateSphere("sphere2",16,f,e.scene),e.cueBallYellow.position.y=f,e.cueBallYellow.position.x=a.state.posCueBallYellow.x,e.cueBallYellow.position.z=a.state.posCueBallYellow.z;var n=new v.StandardMaterial("redMat",e.scene);n.diffuseTexture=new v.Texture(t+"cueball-yellow.jpg",e.scene),e.cueBallYellow.material=n,e.targetBall=v.Mesh.CreateSphere("sphere3",16,f,e.scene),e.targetBall.position.y=f,e.targetBall.position.x=a.state.posTargetBall.x,e.targetBall.position.z=a.state.posTargetBall.z;var s=new v.StandardMaterial("redMat",e.scene);s.diffuseTexture=new v.Texture(t+"targetBall.jpg",e.scene),e.targetBall.material=s},a.configGrids=function(){for(var e=Object(h.a)(a),t=[new v.Color4(.7,.7,.7,1),new v.Color4(.7,.7,.7,1)],o=0;o<15;o++){var n=[new v.Vector3(7*-C/16+o*C/16,5.5,-C/4),new v.Vector3(7*-C/16+o*C/16,5.5,C/4)];e.grids.push(v.MeshBuilder.CreateLines("lines",{points:n,colors:t},e.scene))}for(o=0;o<7;o++){var s=[new v.Vector3(-C/2,5.5,3*-C/16+o*C/16),new v.Vector3(C/2,5.5,3*-C/16+o*C/16)];e.grids.push(v.MeshBuilder.CreateLines("lines",{points:s,colors:t},e.scene))}},a.toggleGrids=function(e){for(var t=Object(h.a)(a).grids,o=0;o<t.length;o++)t[o].visibility=e},a.loadModels=function(){var e=Object(h.a)(a),t=a.props.modelStorePath;v.SceneLoader.ImportMesh("",t,g,e.scene,function(a){e.table=a;var o=!0,n=!1,s=void 0;try{for(var i,l=a[Symbol.iterator]();!(o=(i=l.next()).done);o=!0){var r=i.value;"carpet"===r.name&&(r.material.bumpTexture=new v.Texture(t+"carpet-bump.png",e.scene))}}catch(c){n=!0,s=c}finally{try{o||null==l.return||l.return()}finally{if(n)throw s}}}),v.SceneLoader.ImportMesh("",t,w,e.scene,function(t){e.bat=t[0],e.bat.position.y=50,e.bat.position.z=90,e.updateBat()})},a.configPhysicsEngine=function(){var e=Object(h.a)(a),t=e.scene,o=e.cueBallWhite,n=e.cueBallYellow,s=e.targetBall,i=e.table,l=a.props.size,r=9.8*C/l;t.enablePhysics(new v.Vector3(0,-r,0)),o.physicsImpostor=new v.PhysicsImpostor(o,v.PhysicsImpostor.SphereImpostor,{mass:y,friction:b,restitution:B},t),n.physicsImpostor=new v.PhysicsImpostor(n,v.PhysicsImpostor.SphereImpostor,{mass:y,friction:b,restitution:B},t),s.physicsImpostor=new v.PhysicsImpostor(s,v.PhysicsImpostor.SphereImpostor,{mass:y,friction:b,restitution:B},t);var c=!0,p=!1,u=void 0;try{for(var m,d=i[Symbol.iterator]();!(c=(m=d.next()).done);c=!0){var g=m.value;"carpet"===g.name?g.physicsImpostor=new v.PhysicsImpostor(g,v.PhysicsImpostor.BoxImpostor,{mass:0,friction:S,restitution:P},t):"carpet-side"===g.name&&(g.physicsImpostor=new v.PhysicsImpostor(g,v.PhysicsImpostor.MeshImpostor,{mass:0,friction:S,restitution:M},t))}}catch(w){p=!0,u=w}finally{try{c||null==d.return||d.return()}finally{if(p)throw u}}},a.registerBallPath=function(){var e=Object(h.a)(a),t=e.posPathCueWhite,o=e.cueBallWhite,n=e.posPathCueYellow,s=e.cueBallYellow,i=e.posPathTargetBall,l=e.targetBall,r=o.position;if(0===t.length)t.push(r);else{var c=t[t.length-1];Math.sqrt(Math.pow(c.x-r.x,2)+Math.pow(c.y-r.y,2)+Math.pow(c.z-r.z,2))>I&&t.push(r)}var p=s.position;if(0===n.length)n.push(p);else{var u=n[n.length-1];Math.sqrt(Math.pow(u.x-r.x,2)+Math.pow(u.y-r.y,2)+Math.pow(u.z-r.z,2))>I&&n.push(p)}var m=l.position;if(0===i.length)i.push(m);else{var d=i[i.length-1];Math.sqrt(Math.pow(d.x-m.x,2)+Math.pow(d.y-m.y,2)+Math.pow(d.z-m.z,2))>I&&i.push(m)}},a.drawBallPath=function(e){var t=Object(h.a)(a);t.setState({showPath:e});var o=Object(h.a)(a),n=o.posPathCueWhite,s=o.pathCueWhite,i=o.posPathCueYellow,l=o.pathCueYellow,r=o.posPathTargetBall,c=o.pathTargetBall,p=[],u=[];for(var m in i)p.push(new v.Color4(1,1,0,1));for(var m in r)u.push(new v.Color4(1,0,0,1));if(!0===e)s.push(v.MeshBuilder.CreateLines("lines",{points:n},t.scene)),l.push(v.MeshBuilder.CreateLines("lines",{points:i,colors:p},t.scene)),c.push(v.MeshBuilder.CreateLines("lines",{points:r,colors:u},t.scene));else{var d=!0,g=!1,w=void 0;try{for(var C,f=s[Symbol.iterator]();!(d=(C=f.next()).done);d=!0){var y=C.value;y.dispose()}}catch(z){g=!0,w=z}finally{try{d||null==f.return||f.return()}finally{if(g)throw w}}var b=!0,B=!1,S=void 0;try{for(var P,M=l[Symbol.iterator]();!(b=(P=M.next()).done);b=!0)(y=P.value).dispose()}catch(z){B=!0,S=z}finally{try{b||null==M.return||M.return()}finally{if(B)throw S}}var I=!0,E=!1,x=void 0;try{for(var O,j=c[Symbol.iterator]();!(I=(O=j.next()).done);I=!0)(y=O.value).dispose()}catch(z){E=!0,x=z}finally{try{I||null==j.return||j.return()}finally{if(E)throw x}}s=[],l=[],c=[]}},a.onSceneMount=function(e){var t=e.canvas,o=e.scene,n=Object(h.a)(a);n.scene=o,n.canvas=t,o.clearColor=new v.Color3(.05,.05,.05),a.configCameras(),a.configCueBalls(),a.loadModels(),a.configGrids(),setTimeout(function(){n.configPhysicsEngine()},1e3),new v.HemisphericLight("light",v.Vector3.Up(),o),a.changeView(a.props.currentView),o.getEngine().runRenderLoop(function(){o&&(o.render(),n.registerBallPath())}),setTimeout(function(){n.drawBallPath()},1e4)},a.playSimulation=function(){console.log(a.state);var e=Object(h.a)(a).cueBallWhite,t=a.state,o=t.speed,n=t.cueLine,s=t.cueAngle,i=a.props.size;console.log(n,o,i);var l=400/(100*i)*o;e.physicsImpostor.setAngularVelocity(new v.Quaternion(10,0,20,0)),e.physicsImpostor.setLinearVelocity(new v.Vector3(-l*Math.cos(n*Math.PI/180)*Math.cos(s*Math.PI/180),-l*Math.sin(s*Math.PI/180),-l*Math.sin(n*Math.PI/180)*Math.cos(s*Math.PI/180)))},a.updateBat=function(){var e=a.state,t=e.cueLine,o=e.cueAngle,n=(e.sideEnglish,e.topSpin,e.posCueBallWhite),s=Object(h.a)(a).bat;s.position.x=n.x,s.position.z=n.z,s.position.y=f/2+5,s.rotation=new v.Vector3(0,-Math.PI*t/180,Math.PI/2+Math.PI*o/180)},a.updateControlOptions=function(e){a.setState(e),a.updateBat()},a.state={showPath:!1,cueLine:a.props.cueLine,cueAngle:a.props.cueAngle,sideEnglish:a.props.sideEnglish,topSpin:a.props.topSpin,speed:a.props.speed,posCueBallWhite:{x:C*a.props.posCueBallWhite.x/a.props.size,z:C*a.props.posCueBallWhite.z/a.props.size},posCueBallYellow:{x:C*a.props.posCueBallYellow.x/a.props.size,z:C*a.props.posCueBallYellow.z/a.props.size},posTargetBall:{x:C*a.props.posTargetBall.x/a.props.size,z:C*a.props.posTargetBall.z/a.props.size}},a.scene=void 0,a.canvas=void 0,a.arcCam=void 0,a.topCam=void 0,a.table=void 0,a.bat=void 0,a.cueBallWhite=void 0,a.cueBallYellow=void 0,a.targetBall=void 0,a.grids=[],a.posPathCueWhite=[],a.pathCueWhite=[],a.posPathCueYellow=[],a.pathCueYellow=[],a.posPathTargetBall=[],a.pathTargetBall=[],console.log("check position",a.props.size,a.state),a}return Object(u.a)(t,e),Object(r.a)(t,[{key:"changeView",value:function(e){"2d"===e?(this.scene.activeCamera=this.topCam,this.arcCam.detachControl(this.canvas),this.topCam.attachControl(this.canvas)):(this.scene.activeCamera=this.arcCam,this.arcCam.attachControl(this.canvas),this.topCam.detachControl(this.canvas))}},{key:"render",value:function(){return n.a.createElement(d.a,{canvasId:"carom-simulator-canvas"},n.a.createElement(d.b,{onMeshPicked:this.meshPicked,onSceneMount:this.onSceneMount}))}}]),t}(n.a.Component),U=a(4),G=a(5),F=(a(31),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).componentWillReceiveProps=function(e){var t=e.value;a.setState({value:t})},a.updateValue=function(e){a.setState({value:e}),a.props.onUpdate(a.props.itemKey,e)},a.onChangeValue=function(e){var t=e.target.value;a.updateValue(t)},a.onMinusPressed=function(){var e=a.state.value,t=a.props,o=t.min,n=t.step;void 0===n&&(n=.1),(e=(10*e-(n*=10))/10)<o&&(e=o),a.updateValue(e)},a.onPlusPressed=function(){var e=a.state.value,t=a.props,o=t.max,n=t.step;void 0===n&&(n=.1),(e=(10*e+(n*=10))/10)>o&&(e=o),a.updateValue(e)},a.state={value:a.props.value?a.props.value:0},a}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state.value,t=this.props,a=t.containerClass,o=t.label,s=t.min,i=t.max,l=t.unitDom,r=t.step;return void 0===r&&(r=.1),n.a.createElement("div",{className:a},n.a.createElement("div",{style:{display:"flex"}},n.a.createElement(U.a,{icon:G.d,className:"btn-change-value",onClick:this.onMinusPressed}),n.a.createElement("span",{style:{flex:1,textAlign:"center"}},o,n.a.createElement("span",null," : ",e,l)),n.a.createElement(U.a,{icon:G.f,className:"btn-change-value",onClick:this.onPlusPressed})),n.a.createElement("input",{type:"range",min:s,max:i,value:e,className:"slider",step:r,onChange:this.onChangeValue}))}}]),t}(n.a.Component)),R=(a(32),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).onInputSliderUpdated=function(e,t){var o=Object.assign({},a.state);o[e]=parseFloat(t),a.setState(o),a.props.onControlOptionsUpdated(o)},a.state={cueLine:a.props.cueLine,cueAngle:a.props.cueAngle,sideEnglish:a.props.sideEnglish,topSpin:a.props.topSpin,speed:a.props.speed},a}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.cueLine,o=t.cueAngle,s=t.sideEnglish,i=t.topSpin,l=t.speed,r=this.props,c=r.showGrid,p=r.showPath,u="toggle-btn",h="toggle-btn";return!0===c&&(u+=" active"),!0===p&&(h+=" active"),n.a.createElement("div",null,n.a.createElement("div",{className:"common-controller-container"},n.a.createElement(U.a,{className:u,icon:G.h,onClick:function(){e.props.onToggleShowGrid(!c)}}),n.a.createElement(U.a,{className:h,icon:G.b,onClick:function(){e.props.onToggleShowPath(!p)}}),n.a.createElement(U.a,{className:"toggle-btn",icon:G.i})),n.a.createElement("div",null,n.a.createElement(F,{label:"Cue Line",containerClass:"slider-container",min:-180,max:180,value:a,unitDom:n.a.createElement("sup",null,"o"),itemKey:"cueLine",onUpdate:this.onInputSliderUpdated}),n.a.createElement(F,{label:"Cue Angle",containerClass:"slider-container",min:2,max:89,value:o,unitDom:n.a.createElement("sup",null,"o"),itemKey:"cueAngle",onUpdate:this.onInputSliderUpdated}),n.a.createElement(F,{label:"Side English",containerClass:"slider-container",min:-10.1,max:10.1,value:s,unitDom:n.a.createElement("span",null,"mm"),itemKey:"sideEnglish",onUpdate:this.onInputSliderUpdated}),n.a.createElement(F,{label:"Top Spin",containerClass:"slider-container",min:-11.1,max:11.1,value:i,unitDom:n.a.createElement("span",null,"mm"),itemKey:"topSpin",onUpdate:this.onInputSliderUpdated}),n.a.createElement(F,{label:"Speed",containerClass:"slider-container",min:0,max:450,value:l,step:1,unitDom:n.a.createElement("span",null,"cm/s"),itemKey:"speed",onUpdate:this.onInputSliderUpdated})),n.a.createElement("div",{className:"play-controller-container"},n.a.createElement(U.a,{className:"play-controller",icon:G.a}),n.a.createElement(U.a,{className:"play-controller",icon:G.g}),n.a.createElement(U.a,{className:"play-controller",icon:G.e,onClick:this.props.onPlayPressed}),n.a.createElement(U.a,{className:"play-controller",icon:G.c})))}}]),t}(n.a.Component)),D=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(p.a)(t).call(this))).componentWillMount=function(){e.updateSimulateInfo()},e.updateSimulateInfo=function(){var t=["Michael Cacoulidis","...","0","310","2","1","0.7426666666666665","0.11","0.5791666666666665","0.6425","0.6038333333333333","0.22600000000000003","2.846666666666669","0.03490658503988659","5.468558116924995","-0.011250000000000001","-0.009549999999999954"],a=Math.sqrt(Math.pow(parseInt(t[E]),2)/5)/50,o=t[W]/Math.PI*180;o>180&&(o-=360),o=Math.round(10*o)/10;var n=t[V]/Math.PI*180;n=Math.round(10*n)/10;var s=1e3*parseFloat(t[Y]);s=Math.round(10*s)/10;var i=1e3*parseFloat(t[A]);i=Math.round(10*i)/10;var l=100*parseFloat(t[L]),r={size:a,cueLine:o,cueAngle:n,sideEnglish:s,topSpin:i,speed:l=Math.round(l),posCueBallWhite:{x:parseFloat(t[x]),z:parseFloat(t[O])},posCueBallYellow:{x:parseFloat(t[j]),z:parseFloat(t[z])},posTargetBall:{x:parseFloat(t[T]),z:parseFloat(t[k])}};e.setState(r),console.log(e.state)},e.viewSelectorItemClicked=function(t){e.setState({currentView:t}),e.simulator.current.changeView(t)},e.onToggleShowGrid=function(t){e.setState({showGrid:t}),e.simulator.current.toggleGrids(t)},e.onToggleShowPath=function(t){e.setState({showPath:t}),e.simulator.current.drawBallPath(t)},e.onPlayPressed=function(){e.simulator.current.playSimulation()},e.onControlOptionsUpdated=function(t){e.simulator.current.updateControlOptions(t)},e.state={currentView:"2d",showGrid:!0,showPath:!1,size:310,cueLine:30,cueAngle:5,sideEnglish:-8.7,topSpin:7.5,speed:380,posCueBallWhite:{},posCueBallYellow:{},posTargetBall:{}},e.simulator=n.a.createRef(),e}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.currentView,a=e.showGrid,o=e.showPath,s=e.size,i=e.cueLine,l=e.cueAngle,r=e.sideEnglish,c=e.topSpin,p=e.speed,u=e.posCueBallWhite,h=e.posCueBallYellow,d=e.posTargetBall;return n.a.createElement("div",{className:"simulator-container"},n.a.createElement(m,{currentView:t,viewSelectorItemClicked:this.viewSelectorItemClicked}),n.a.createElement(N,{modelStorePath:this.props.modelStorePath,ref:this.simulator,size:s,currentView:t,cueLine:i,cueAngle:l,sideEnglish:r,topSpin:c,speed:p,posCueBallWhite:u,posCueBallYellow:h,posTargetBall:d}),n.a.createElement(R,{showGrid:a,showPath:o,cueLine:i,cueAngle:l,sideEnglish:r,topSpin:c,speed:p,onControlOptionsUpdated:this.onControlOptionsUpdated,onToggleShowGrid:this.onToggleShowGrid,onToggleShowPath:this.onToggleShowPath,onPlayPressed:this.onPlayPressed}))}}]),t}(n.a.Component);var K=function(){return n.a.createElement("div",{className:"simulator-container"},n.a.createElement(D,{modelStorePath:"./models/"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(K,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[18,1,2]]]);
//# sourceMappingURL=main.0475dbc8.chunk.js.map