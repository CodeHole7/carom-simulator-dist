(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,,,,function(t,i,s){},function(t,i,s){},,function(t,i,s){t.exports=s.p+"static/media/top-view.83965708.png"},function(t,i){t.exports="data:image/png;base64,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"},function(t,i,s){t.exports=s.p+"static/media/target-view.8dfa6cf4.png"},,function(t,i,s){t.exports=s.p+"static/media/cueball.62cee232.png"},function(t,i,s){t.exports=s(38)},,,,,function(t,i,s){},function(t,i,s){},,,,,,function(t,i,s){},,function(t,i,s){},function(t,i,s){},function(t,i,s){"use strict";s.r(i);var e=s(1),a=s.n(e),h=s(16),n=s.n(h),r=(s(27),s(28),s(2)),o=s(4),l=s(6),c=s(5),u=s(7),p=s(8),f=s(9),m=(s(34),s(17)),R=s.n(m),d=s(18),b=s.n(d),V=s(19),_=s.n(V),v=function(t){function i(t){var s;return Object(r.a)(this,i),(s=Object(l.a)(this,Object(c.a)(i).call(this,t))).viewSelectorItemClicked=function(t){"function"===typeof s.props.viewSelectorItemClicked&&s.props.viewSelectorItemClicked(t)},s.state={showCameraTypes:!1},s}return Object(u.a)(i,t),Object(o.a)(i,[{key:"render",value:function(){var t=this,i=this,s="view-selector-item",e="view-selector-item",h="view-selector-item";return"top"===this.props.currentView?s+=" active":"stand"===this.props.currentView?e+=" active":"targetting"===this.props.currentView&&(h+=" active"),a.a.createElement("div",{className:"view-selector"},a.a.createElement(p.a,{className:"video-icon",icon:f.i,onClick:function(){t.setState({showCameraTypes:!t.state.showCameraTypes})}}),this.state.showCameraTypes?a.a.createElement("div",{className:"select-camera-type"},a.a.createElement("img",{className:s,src:R.a,onClick:function(){i.viewSelectorItemClicked("top")}}),a.a.createElement("img",{className:e,src:b.a,onClick:function(){i.viewSelectorItemClicked("stand")}}),a.a.createElement("img",{className:h,src:_.a,onClick:function(){i.viewSelectorItemClicked("targetting")}})):null)}}]),i}(e.Component),g=s(11),M=(s(14),s(0)),A="pooltable.babylon",y="caromtable.babylon",N="bat.babylon",Y=406,q=400,x=5.715,P=6,w=7,X=8,C=9,E=10,S=11,T=12,I=13,B=14,Q=15,L=16,j=function t(){Object(r.a)(this,t),this.played=!1},O=function t(){Object(r.a)(this,t)},F=function t(i,s){var e=this;Object(r.a)(this,t),this.delta_fgpas=.004375,this.RSG=1,this.fgpas=.00125,this.EPSILON=.86,this.frpas=3e-5,this.QCQ=2,this.Rfppas=75e-6,this.f1=.25,this.f2=.42,this.Rfp=.15,this.fbille=.05,this.pas=5e-4,this.fp1=.2,this.ARRET=0,this.TSP=3,this.fg=2.5,this.fr=.06,this.choc_bande=function(t){var i=NaN;if(e.X[t]>e.XMIN&&e.X[t]<e.XMAX&&e.Y[t]>e.YMIN&&e.Y[t]<e.YMAX)return!1;if(e.X[t]<e.XMIN&&e.Vx[t]>0)return!1;if(e.X[t]>e.XMAX&&e.Vx[t]<0)return!1;if(e.Y[t]>e.YMAX&&e.Vy[t]<0)return!1;if(e.Y[t]<e.YMIN&&e.Vy[t]>0)return!1;if(0==t&&(!e.choc12||!e.choc13)){var s=e,a=e.nbandes+1;if(s.nbandes=a,!e.choc12&&!e.choc13){s=e,a=e.nb_b_avant+1;s.nb_b_avant=a}}return e.etat[t]==e.RSG?(e.Rp[t]=-e.Vy[t],e.Rq[t]=e.Vx[t]):e.etat[t]==e.QCQ&&(e.Rp[t]=-e.Vy[t]+e.VQy[t],e.Rq[t]=e.Vx[t]-e.VQx[t]),e.init_pars(t),e.VMz=e.VT-e.VRr,e.VN0=-e.VN,e.VN=e.VN*-e.EPSILON,e.deltaVN=e.VN0+e.VN,e.intens=e.VN0/20,e.intens>1&&(e.intens=1),e.beta_adh=2/7*Math.sqrt(e.VMz*e.VMz+e.VRq*e.VRq),e.beta_gliss=e.f1*e.deltaVN,Math.abs(e.VMz)<1e-5?e.alpha_bande=Math.PI/2:e.alpha_bande=Math.abs(Math.atan(e.VRq/e.VMz)),i=Math.abs(e.fp1*e.deltaVN),Math.abs(e.VRp)<i?e.VRp=0:e.VRp>0?e.VRp=e.VRp-i:e.VRp=e.VRp+i,i=Math.abs(e.f2*e.deltaVN),e.VRq=e.VRq+i,e.beta_gliss>e.beta_adh?e.choc_adh(t):e.choc_gliss(t),e.recup_pars(t),e.VQx[t]=e.Vx[t]-e.Rq[t],e.VQy[t]=e.Vy[t]+e.Rp[t],e.etat[t]=e.QCQ,!0},this.fin_parcours=function(){var t=0;for(t=0;t<3;){if(e.etat[t]!=e.ARRET){if(!(e.Vx[t]*e.Vx[t]+e.Vy[t]*e.Vy[t]<e.frpas*e.frpas))return!1;if(!(Math.abs(e.Rr[t])<e.Rfppas))return e.etat[t]=e.TSP,!1;e.etat[t]=e.ARRET;var i=0;e.Vy[t]=0,e.Vx[t]=i;i=0;e.Rr[t]=0,e.Rq[t]=i,e.Rp[t]=i}t++}return!0},this.Calcul=function(t){console.log("parameter",t);var i,s,a=0,h=0,n=NaN,r=[];for(a=0;a<3;){for(e.nb_clefs[a]=0,h=0;h<e.nb_max_clefs;)e.evts[e.nb_max_clefs*a+h]=null,h++;a++}for(e.nb_sons=0,a=0;a<e.nb_max_sons;)e.evts_son[a]=null,a++;for(a=0;a<3;)e.X[a]=t.Xinit[a],e.Y[a]=t.Yinit[a],e.RAp[a]=t.RApInit[a],e.RAq[a]=t.RAqInit[a],e.RAr[a]=t.RArInit[a],e.add_clef(a),a++;e.el=t.el,e.er=t.er,e.alph=t.alphaQ,e.beta=t.betaQ,e.vqueue=t.Vqueue,e.calculs_finis=!1,e.nbandes=0,e.done=!1,e.distance13=2,e.first_bille_choquee=0,e.choc12=!1,e.choc13=!1,e.done=!1,e.deltaclef=e.resolution,e.date=0,e.beta=e.beta+Math.PI,e.Vinit=1.4*e.vqueue*Math.cos(e.alph/1.2),i=-2*e.Vinit/Math.cos(e.alph/1.1)*e.er/e.R;var o=Math.PI/20;n=e.alph>o?Math.PI/2/(Math.PI/2-o)*(e.alph-o):0,s=4*e.vqueue*Math.sin(n)*e.el/e.R,e.Vx[0]=e.Vinit*Math.cos(e.beta),e.Vx0=e.Vx[0],e.Vy[0]=e.Vinit*Math.sin(e.beta),e.Vy0=e.Vy[0];var l=i*Math.sin(e.beta)+s*Math.cos(e.beta);e.Rp[0]=i*Math.sin(e.beta)+s*Math.cos(e.beta),e.p0=l;l=-i*Math.cos(e.beta)+s*Math.sin(e.beta);e.Rq[0]=-i*Math.cos(e.beta)+s*Math.sin(e.beta),e.q0=l;l=2*e.el/e.R*e.Vinit;for(e.Rr[0]=2*e.el/e.R*e.Vinit,e.r0=l,e.VQx[0]=e.Vx[0]-e.Rq[0],e.VQy[0]=e.Vy[0]+e.Rp[0],e.etat[0]=e.QCQ,a=1;a<3;)e.Vx[a]=0,e.Vy[a]=0,e.VQx[a]=0,e.VQy[a]=0,e.Rp[a]=0,e.Rq[a]=0,e.Rr[a]=0,e.etat[a]=e.ARRET,e.add_clef(a),a++;for(e.evts_son[e.nb_sons]=new j,e.evts_son[e.nb_sons].played=!1,e.evts_son[e.nb_sons].temps=0,e.evts_son[e.nb_sons].intensite=e.Vinit/5.4,e.alph>Math.PI/4?e.evts_son[e.nb_sons].type_choc=0:e.evts_son[e.nb_sons].type_choc=1;!e.fin_parcours();)for(e.date+=1,e.choc_billes(r),a=0;a<3;){if(e.etat[a]!=e.ARRET){if(e.choc_bande(a)){e.add_clef(a),e.evts_son[e.nb_sons]=new j,e.evts_son[e.nb_sons].played=!1,e.evts_son[e.nb_sons].temps=e.date*e.pas,e.evts_son[e.nb_sons].intensite=e.intens,e.evts_son[e.nb_sons].type_choc=3;l=e;var c=e.nb_sons+1;l.nb_sons=c}e.mise_a_jour(a)&&e.add_clef(a)}(Math.abs(e.X[a]-e.X0[a])>e.deltaclef||Math.abs(e.Y[a]-e.Y0[a])>e.deltaclef||Math.abs(e.RAp[a]-e.RAp0[a])>e.deltaclefRot||Math.abs(e.RAq[a]-e.RAq0[a])>e.deltaclefRot||Math.abs(e.RAr[a]-e.RAr0[a])>e.deltaclefRot)&&e.add_clef(a),a++}if(e.fin_parcours()){e.calculs_finis=!0;for(a=0;a<3;a++)e.Xfin[a]=e.X[a],e.Yfin[a]=e.Y[a],e.RApfin[a]=e.RAp[a],e.RAqfin[a]=e.RAq[a],e.RArfin[a]=e.RAr[a],e.add_clef(a);e.duree=e.date*e.pas}else for(a=0;a<3;a++)e.add_clef(a);return e.evts},this.mise_a_jour=function(t){var i=NaN,s=NaN,a=NaN,h=NaN,n=NaN;if(0!=e.first_bille_choquee&&(e.nb3=3-e.first_bille_choquee,e.d13=Math.sqrt((e.X[0]-e.X[e.nb3])*(e.X[0]-e.X[e.nb3])+(e.Y[0]-e.Y[e.nb3])*(e.Y[0]-e.Y[e.nb3])),e.d13<e.distance13&&(e.distance13=e.d13)),e.etat[t]==e.RSG){if((i=Math.sqrt(e.Vx[t]*e.Vx[t]+e.Vy[t]*e.Vy[t]))<e.frpas){var r=0;e.Vy[t]=0,e.Vx[t]=r;r=0;if(e.Rq[t]=0,e.Rp[t]=r,Math.abs(e.Rr[t])<e.Rfppas)return e.etat[t]=e.ARRET,e.Rr[t]=0,e.add_clef(t),!0;e.etat[t]=e.TSP}e.etat[t]!=e.TSP&&(s=1-e.frpas/i,e.Vx[t]=e.Vx[t]*s,e.Vy[t]=e.Vy[t]*s,e.Rp[t]=-e.Vy[t],e.Rq[t]=e.Vx[t]),Math.abs(e.Rr[t])<e.Rfppas?e.Rr[t]=0:e.Rr[t]>0?e.Rr[t]=e.Rr[t]-e.Rfppas:e.Rr[t]=e.Rr[t]+e.Rfppas}if(e.etat[t]==e.QCQ&&((a=Math.sqrt(e.VQx[t]*e.VQx[t]+e.VQy[t]*e.VQy[t]))<e.delta_fgpas?e.etat[t]=e.RSG:(h=-e.fgpas*e.VQx[t]/a,n=-e.fgpas*e.VQy[t]/a,e.Vx[t]=e.Vx[t]+h,e.Vy[t]=e.Vy[t]+n,s=1-e.delta_fgpas/a,e.VQx[t]=e.VQx[t]*s,e.VQy[t]=e.VQy[t]*s),e.Rp[t]=-e.Vy[t]+e.VQy[t],e.Rq[t]=e.Vx[t]-e.VQx[t],Math.abs(e.Rr[t])<e.Rfppas?e.Rr[t]=0:e.Rr[t]>0?e.Rr[t]=e.Rr[t]-e.Rfppas:e.Rr[t]=e.Rr[t]+e.Rfppas),e.etat[t]==e.TSP){r=0;e.Vy[t]=0,e.Vx[t]=r;r=0;if(e.Rq[t]=0,e.Rp[t]=r,Math.abs(e.Rr[t])<e.Rfppas)return e.Rr[t]=0,e.etat[t]=e.ARRET,!0;e.Rr[t]>0?e.Rr[t]=e.Rr[t]-2*e.Rfppas:e.Rr[t]=e.Rr[t]+2*e.Rfppas}return e.X[t]=e.X[t]+e.Vx[t]*e.pas,e.Y[t]=e.Y[t]+e.Vy[t]*e.pas,e.RAp[t]=e.RAp[t]+e.Rp[t]*e.pas,e.RAq[t]=e.RAq[t]+e.Rq[t]*e.pas,e.RAr[t]=e.RAr[t]+e.Rr[t]*e.pas,!1},this.choc_gliss=function(t){e.VMz>0?(e.VT=e.VT-e.beta_gliss*Math.cos(e.alpha_bande),e.VRr=e.VRr+2.5*e.beta_gliss*Math.cos(e.alpha_bande)):(e.VT=e.VT+e.beta_gliss*Math.cos(e.alpha_bande),e.VRr=e.VRr-2.5*e.beta_gliss*Math.cos(e.alpha_bande))},this.choc_adh=function(t){var i,s,a=NaN,h=NaN,n=NaN,r=NaN,o=NaN,l=0;a=Math.abs(e.VT)<1e-5?90:180/Math.PI*Math.atan(e.VN0/e.VT),e.effet=100*e.R/2*e.VRr/Math.sqrt(e.VN0*e.VN0+e.VT*e.VT),e.effet<=-1.5?e.effet=-1.499:e.effet>1.5&&(e.effet=1.499),Math.abs(e.VT)<1e-5?h=e.effet>0?e.sorties[28]+(e.sorties[29]-e.sorties[28])*(e.effet/1.5):e.sorties[27]+(e.sorties[28]-e.sorties[27])*(e.effet+1.5)/1.5:(a=180/Math.PI*Math.atan(e.VN0/e.VT),l=parseInt(a/10),h=(n=e.effet>0?e.sorties[3*l+1]+(e.sorties[3*l+2]-e.sorties[3*l+1])*(e.effet/1.5):e.sorties[3*l+0]+(e.sorties[3*l+1]-e.sorties[3*l+0])*(e.effet+1.5)/1.5)+((e.effet>0?e.sorties[3*(l+1)+1]+(e.sorties[3*(l+1)+2]-e.sorties[3*(l+1)+1])*(e.effet/1.5):e.sorties[3*(l+1)+0]+(e.sorties[3*(l+1)+1]-e.sorties[3*(l+1)+0])*(e.effet+1.5)/1.5)-n)/10*(a-10*l)),Math.abs(h-90)<1e-5?e.VT=0:e.VT=h<90?e.VN/Math.tan(h/180*Math.PI):-e.VN*Math.tan((h-90)/180*Math.PI),Math.abs(e.VT)<1e-5?e.effet>0?e.e_s=e.eff_s[28]+(e.eff_s[29]-e.eff_s[28])*(e.effet/1.5):e.e_s=e.eff_s[27]+(e.eff_s[28]-e.eff_s[27])*(e.effet+1.5)/1.5:(e.effet>0?(r=e.eff_s[3*l+1]+(e.eff_s[3*l+2]-e.eff_s[3*l+1])*(e.effet/1.5),o=e.eff_s[3*(l+1)+1]+(e.eff_s[3*(l+1)+2]-e.eff_s[3*(l+1)+1])*(e.effet/1.5)):(r=e.eff_s[3*l+0]+(e.eff_s[3*l+1]-e.eff_s[3*l+0])*(e.effet+1.5)/1.5,o=e.eff_s[3*(l+1)+0]+(e.eff_s[3*(l+1)+1]-e.eff_s[3*(l+1)+0])*(e.effet+1.5)/1.5),e.e_s=r+(o-r)/10*(a-10*l)),s=(5*e.VN+2*e.VRq)/7,i=(5*e.VT-2*e.VRp)/7,e.VRr=.02*e.e_s/e.R*Math.sqrt(s*s+i*i)},this.recup_pars=function(t){e.X[t]>e.XMAX&&e.Vx[t]>0&&(e.Vx[t]=-e.VN,e.Rq[t]=-e.VRq,e.Vy[t]>0?(e.Vy[t]=e.VT,e.Rp[t]=e.VRp,e.Rr[t]=-e.VRr):(e.Vy[t]=-e.VT,e.Rp[t]=-e.VRp,e.Rr[t]=e.VRr)),e.X[t]<e.XMIN&&e.Vx[t]<0&&(e.Vx[t]=e.VN,e.Rq[t]=e.VRq,e.Vy[t]>0?(e.Vy[t]=e.VT,e.Rp[t]=e.VRp,e.Rr[t]=e.VRr):(e.Vy[t]=-e.VT,e.Rp[t]=-e.VRp,e.Rr[t]=-e.VRr)),e.Y[t]<e.YMIN&&e.Vy[t]<0&&(e.Vy[t]=e.VN,e.Rp[t]=-e.VRq,e.Vx[t]>0?(e.Vx[t]=e.VT,e.Rq[t]=-e.VRp,e.Rr[t]=-e.VRr):(e.Vx[t]=-e.VT,e.Rq[t]=e.VRp,e.Rr[t]=e.VRr)),e.Y[t]>e.YMAX&&e.Vy[t]>0&&(e.Vy[t]=-e.VN,e.Rp[t]=e.VRq,e.Vx[t]>0?(e.Vx[t]=e.VT,e.Rq[t]=-e.VRp,e.Rr[t]=e.VRr):(e.Vx[t]=-e.VT,e.Rq[t]=e.VRp,e.Rr[t]=-e.VRr))},this.init_pars=function(t){e.X[t]>e.XMAX&&e.Vx[t]>0&&(e.VN=-e.Vx[t],e.VRq=-e.Rq[t],e.Vy[t]>0?(e.VT=e.Vy[t],e.VRp=e.Rp[t],e.VRr=-e.Rr[t]):(e.VT=-e.Vy[t],e.VRp=-e.Rp[t],e.VRr=e.Rr[t])),e.X[t]<e.XMIN&&e.Vx[t]<0&&(e.VN=e.Vx[t],e.VRq=e.Rq[t],e.Vy[t]>0?(e.VT=e.Vy[t],e.VRp=e.Rp[t],e.VRr=e.Rr[t]):(e.VT=-e.Vy[t],e.VRp=-e.Rp[t],e.VRr=-e.Rr[t])),e.Y[t]<e.YMIN&&e.Vy[t]<0&&(e.VN=e.Vy[t],e.VRq=-e.Rp[t],e.Vx[t]>0?(e.VT=e.Vx[t],e.VRp=-e.Rq[t],e.VRr=-e.Rr[t]):(e.VT=-e.Vx[t],e.VRp=e.Rq[t],e.VRr=e.Rr[t])),e.Y[t]>e.YMAX&&e.Vy[t]>0&&(e.VN=-e.Vy[t],e.VRq=e.Rp[t],e.Vx[t]>0?(e.VT=e.Vx[t],e.VRp=-e.Rq[t],e.VRr=e.Rr[t]):(e.VT=-e.Vx[t],e.VRp=e.Rq[t],e.VRr=-e.Rr[t]))},this.add_clef=function(t){var i=e.nb_max_clefs*t+e.nb_clefs[t];e.evts[i]=new O,e.evts[i].X=e.X[t],e.evts[i].Y=e.Y[t],e.evts[i].RAp=e.RAp[t],e.evts[i].RAq=e.RAq[t],e.evts[i].RAr=e.RAr[t],e.evts[i].time=e.date*e.pas;var s=e.nb_clefs,a=t,h=s[t]+1;s[a]=h,e.X0[t]=e.X[t],e.Y0[t]=e.Y[t],e.RAp0[t]=e.RAp[t],e.RAq0[t]=e.RAq[t],e.RAr0[t]=e.RAr[t]},this.choc_billes=function(t){var i=0,s=0,a=!1,h=NaN,n=NaN,r=NaN,o=NaN,l=NaN,c=NaN,u=NaN,p=NaN,f=NaN,m=NaN,R=NaN,d=NaN,b=NaN,V=NaN,_=NaN,v=NaN,g=NaN,M=NaN,A=NaN,y=NaN,N=!1,Y=[];for(i=0;i<3;)Y[i]=!1,i++;for(i=0;i<3;){if(!Y[i]&&(a=!1,s=(i+1)%3,(h=(e.X[i]-e.X[s])*(e.X[i]-e.X[s])+(e.Y[i]-e.Y[s])*(e.Y[i]-e.Y[s]))<e.D*e.D&&(e.etat[i]!=e.ARRET||e.etat[s]!=e.ARRET)&&(e.Vx[i]-e.Vx[s])*(e.X[s]-e.X[i])+(e.Vy[i]-e.Vy[s])*(e.Y[s]-e.Y[i])>0&&(a=!0,N=!0,e.choc12||e.choc13||0!=i||(e.first_bille_choquee=s),0==i&&1==s&&(e.choc12=!0),2==i&&0==s&&(e.choc13=!0),t[0]=i,t[1]=s),a||(s=(i+2)%3,(h=(e.X[i]-e.X[s])*(e.X[i]-e.X[s])+(e.Y[i]-e.Y[s])*(e.Y[i]-e.Y[s]))<e.D*e.D&&(e.etat[i]!=e.ARRET||e.etat[s]!=e.ARRET)&&(e.Vx[i]-e.Vx[s])*(e.X[s]-e.X[i])+(e.Vy[i]-e.Vy[s])*(e.Y[s]-e.Y[i])>0&&(a=!0,N=!0,e.choc12||e.choc13||0!=i||(e.first_bille_choquee=s),1==i&&0==s&&(e.choc12=!0),0==i&&2==s&&(e.choc13=!0),t[0]=i,t[1]=s)),a)){e.add_clef(i),e.add_clef(s),Y[i]=!0,e.etat[i]==e.RSG&&(e.Rp[i]=-e.Vy[i],e.Rq[i]=e.Vx[i]),e.etat[i]==e.QCQ&&(e.Rp[i]=-e.Vy[i]+e.VQy[i],e.Rq[i]=e.Vx[i]-e.VQx[i]),e.etat[i]==e.ARRET&&(e.Rp[i]=0,e.Rq[i]=0),Y[s]=!0,e.etat[s]==e.RSG&&(e.Rp[s]=-e.Vy[s],e.Rq[s]=e.Vx[s]),e.etat[s]==e.QCQ&&(e.Rp[s]=-e.Vy[s]+e.VQy[s],e.Rq[s]=e.Vx[s]-e.VQx[s]),e.etat[s]==e.ARRET&&(e.Rp[s]=0,e.Rq[s]=0),r=(R=e.Vx[i]*(e.X[s]-e.X[i])+e.Vy[i]*(e.Y[s]-e.Y[i]))*(e.X[s]-e.X[i])/h,o=R*(e.Y[s]-e.Y[i])/h,l=e.Vx[i]-r,c=e.Vy[i]-o,u=(d=e.Vx[s]*(e.X[i]-e.X[s])+e.Vy[s]*(e.Y[i]-e.Y[s]))*(e.X[i]-e.X[s])/h,p=d*(e.Y[i]-e.Y[s])/h,f=e.Vx[s]-u,m=e.Vy[s]-p,V=r-u,_=o-p,e.intens=(V*V+_*_)/5,e.intens>1&&(e.intens=1),e.evts_son[e.nb_sons]=new j,e.evts_son[e.nb_sons].played=!1,e.evts_son[e.nb_sons].temps=e.date*e.pas,e.evts_son[e.nb_sons].intensite=e.intens,e.evts_son[e.nb_sons].type_choc=2;var q=e,x=e.nb_sons+1;q.nb_sons=x,b=r,r=u,u=b,u*=e.RendementChoc,r*=e.RendementChoc,b=o,o=p,p=b,p*=e.RendementChoc,o*=e.RendementChoc,e.Vx[i]=r+l,e.Vy[i]=o+c,e.VQx[i]=e.Vx[i]-e.Rq[i],e.VQy[i]=e.Vy[i]+e.Rp[i],e.etat[s]==e.ARRET&&(e.Vx[s]=.94*e.Vx[s],e.Vy[s]=.94*e.Vy[s],R/=n=Math.sqrt(h),R=Math.abs(R),A=e.fbille*R,v=Math.abs(e.Rp[i]*(e.Y[s]-e.Y[i])-e.Rq[i]*(e.X[s]-e.X[i]))/n,M=(e.Vx[i]*(e.Y[s]-e.Y[i])-e.Vy[i]*(e.X[s]-e.X[i]))/n-e.Rr[i],g=Math.abs(M)<1e-5?Math.PI/2:Math.abs(Math.atan(v/M)),y=(M>0?1:-1)*A*Math.cos(g),e.Rr[s]=2.5*y,e.Rr[i]=e.Rr[i]-2.5*y,f=y*(e.Y[s]-e.Y[i])/n,m=-y*(e.X[s]-e.X[i])/n),e.Vx[s]=u+f,e.Vy[s]=p+m,e.VQx[s]=e.Vx[s]-e.Rq[s],e.VQy[s]=e.Vy[s]+e.Rp[s],e.etat[s]=e.QCQ,e.etat[i]=e.QCQ}i++}return N};this.XMAX=i,this.YMAX=s,this.XMIN=-i,this.YMIN=-s,this.nb_max_clefs=1e4,this.nb_clefs=[];this.nb_clefs[2]=0,this.nb_clefs[1]=0,this.nb_clefs[0]=0,this.evts=[],this.nb_max_sons=50,this.nb_sons=0,this.evts_son=[],this.sorties=[],this.eff_s=[],this.etat=[],this.X0=[],this.Y0=[],this.X=[],this.Y=[],this.Xfin=[],this.Yfin=[],this.RAp=[],this.RAq=[],this.RAr=[],this.RAp0=[],this.RAq0=[],this.RAr0=[],this.RApfin=[],this.RAqfin=[],this.RArfin=[],this.Vx=[],this.Vy=[],this.Rp=[],this.Rq=[],this.Rr=[],this.VQx=[],this.VQy=[],this.etat=[],this.D=.06,this.R=.03,this.RendementChoc=.8,this.deltaclefRot=this.R*Math.PI/10,this.resolution=.01,this.done=!1,this.sorties[0]=0,this.sorties[1]=0,this.sorties[2]=0,this.sorties[3]=7.5,this.sorties[4]=7.5,this.sorties[5]=7.5,this.sorties[6]=16,this.sorties[7]=16,this.sorties[8]=16,this.sorties[9]=33,this.sorties[10]=32,this.sorties[11]=23.5,this.sorties[12]=52,this.sorties[13]=43,this.sorties[14]=31,this.sorties[15]=72,this.sorties[16]=53,this.sorties[17]=35,this.sorties[18]=86,this.sorties[19]=60,this.sorties[20]=38,this.sorties[21]=100,this.sorties[22]=69,this.sorties[23]=44,this.sorties[24]=108,this.sorties[25]=79,this.sorties[26]=53,this.sorties[27]=120,this.sorties[28]=90,this.sorties[29]=60,this.eff_s[0]=-1.5,this.eff_s[1]=0,this.eff_s[2]=1.5,this.eff_s[3]=-1.5,this.eff_s[4]=.5,this.eff_s[5]=1.2,this.eff_s[6]=-1.3,this.eff_s[7]=.7,this.eff_s[8]=1.3,this.eff_s[9]=-.5,this.eff_s[10]=1.3,this.eff_s[11]=1.2,this.eff_s[12]=-.5,this.eff_s[13]=1.3,this.eff_s[14]=1.1,this.eff_s[15]=-.3,this.eff_s[16]=.8,this.eff_s[17]=1.2,this.eff_s[18]=0,this.eff_s[19]=.7,this.eff_s[20]=1.2,this.eff_s[21]=0,this.eff_s[22]=.5,this.eff_s[23]=1.5,this.eff_s[24]=-.6,this.eff_s[25]=.2,this.eff_s[26]=1.5,this.eff_s[27]=-.65,this.eff_s[28]=0,this.eff_s[29]=1.5},z=function t(i,s){var e=this;Object(r.a)(this,t),this.RApInit=[],this.RArInit=[],this.RAqInit=[],this.Xinit=[],this.Yinit=[],this.HBande=.035,this.direction_beta=function(t,i,s){var a,h,n;return n=Math.sqrt((e.Xinit[0]-i)*(e.Xinit[0]-i)+(e.Yinit[0]-s)*(e.Yinit[0]-s)),t*=.06,a=Math.asin(t/n),(h=e.atanjimi(s-e.Yinit[0],i-e.Xinit[0]))-a>Math.PI?h-a-2*Math.PI:h-a<-Math.PI?h-a+2*Math.PI:h-a},this.ToucheBandeX=function(t){for(var i,s,a,h,n,r,o,l,c,u,p,f,m,R=NaN,d=NaN;e.betaQ<0;)e.betaQ=e.betaQ+2*Math.PI;for(;e.betaQ>=2*Math.PI;)e.betaQ=e.betaQ-2*Math.PI;return u=e.betaQ,c=t,d=Math.cos(u),m=Math.sin(u),p=Math.cos(c),f=Math.sin(c),n=((l=Math.sqrt(9e-4-e.er*e.er-e.el*e.el))*p-e.er*f)*d-e.el*m,r=l*f+e.er*p,o=(l*p-e.er*f)*m+e.el*d,R=e.Xinit[0]+n,i=.03+r,e.Yinit[0]+o,a=e.long_billard/2,!(Math.abs(d)<1e-5)&&(u>Math.PI/2&&u<3*Math.PI/2&&(d=-d,R=-R),!((h=(a-R)/d)>1.4)&&(s=.006+.009/1.4*h/p,!(h*f/p+i>e.HBande+s/p)))},this.atanjimi=function(t,i){var s;return Math.abs(i)<1e-6?t>0?Math.PI/2:-Math.PI/2:(s=Math.atan(t/i),i>0?s:t<0?s-Math.PI:s+Math.PI)},this.Quantite=function(){var t,i=0,s=[],a=[];for(t=e.betaQ+Math.PI,i=1;i<e.NBILLES;)s[i]=!1,(e.Xinit[i]-e.Xinit[0])*Math.cos(t)+(e.Yinit[i]-e.Yinit[0])*Math.sin(t)>0&&(a[i]=(e.Yinit[i]-e.Yinit[0])*Math.cos(t)-(e.Xinit[i]-e.Xinit[0])*Math.sin(t),a[i]<.06&&a[i]>-.06&&(s[i]=!0)),i++;e.bille_visee=-1;var h=100;for(i=1;i<e.NBILLES;)s[i]&&(e.Xinit[i]-e.Xinit[0])*(e.Xinit[i]-e.Xinit[0])+(e.Yinit[i]-e.Yinit[0])*(e.Yinit[i]-e.Yinit[0])<h&&(e.bille_visee=i,h=(e.Xinit[i]-e.Xinit[0])*(e.Xinit[i]-e.Xinit[0])+(e.Yinit[i]-e.Yinit[0])*(e.Yinit[i]-e.Yinit[0])),i++;return-1!=e.bille_visee?(e.noba=!0,e.quant=a[e.bille_visee]/2/.03):(e.noba=!1,e.quant=0),e.quant},this.ToucheBandeZ=function(t){for(var i,s,a,h,n,r,o,l,c,u,p,f,m,R=NaN,d=NaN;e.betaQ<0;)e.betaQ=e.betaQ+2*Math.PI;for(;e.betaQ>=2*Math.PI;)e.betaQ=e.betaQ-2*Math.PI;return u=e.betaQ,c=t,m=Math.cos(u),d=Math.sin(u),p=Math.cos(c),f=Math.sin(c),n=((l=Math.sqrt(9e-4-e.er*e.er-e.el*e.el))*p-e.er*f)*m-e.el*d,r=l*f+e.er*p,o=(l*p-e.er*f)*d+e.el*m,e.Xinit[0]+n,i=.03+r,R=e.Yinit[0]+o,a=e.larg_billard/2,!(Math.abs(d)<1e-5)&&(u>Math.PI&&(d=-d,R=-R),!((h=(a-R)/d)>1.4)&&(s=.006+.009/1.4*h/p,!(h*f/p+i>e.HBande+s/p)))},this.AlphaQmin=function(){for(var t=0;e.ToucheBandeZ(t)||e.ToucheBandeX(t)||e.ToucheBille(t);)t+=Math.PI/90;return t},this.ToucheBille=function(t){var i=NaN,s=NaN,a=NaN,h=NaN,n=NaN,r=NaN,o=NaN,l=NaN,c=NaN,u=NaN,p=NaN,f=0,m=t,R=e.betaQ;for(f=1;f<e.NBILLES;){for(i=e.Xinit[0]+.032*Math.cos(R)*Math.cos(m)-e.el*Math.sin(R)-e.er*Math.sin(m)*Math.cos(R),s=.03+.032*Math.sin(m)+e.er*Math.cos(m),a=e.Yinit[0]+.032*Math.sin(R)*Math.cos(m)+e.el*Math.cos(R)-e.er*Math.sin(m)*Math.sin(R),r=e.Xinit[f],o=.03,l=e.Yinit[f],n=0;n<1.4;){if(h=.006+.009/1.4*n,((c=i+n*Math.cos(m)*Math.cos(R))-r)*(c-r)+((u=s+n*Math.sin(m))-o)*(u-o)+((p=a+n*Math.cos(m)*Math.sin(R))-l)*(p-l)<(.03+h+.002)*(.03+h+.002))return!0;n+=.01}f++}return!1};var a=0;for(this.NBILLES=3,this.long_billard=i,this.larg_billard=s,this.Xinit=[],this.Yinit=[],this.RApInit=[],this.RAqInit=[],this.RArInit=[],a=0;a<3;)this.RApInit[a]=0,this.RAqInit[a]=0,this.RArInit[a]=0,a++;this.Xinit[0]=-.71,this.Yinit[0]=-.1775,this.Xinit[1]=-.71,this.Yinit[1]=0,this.Xinit[2]=.71,this.Yinit[2]=0,this.Vqueue=.08,this.el=0,this.er=.012,this.alphaQ=0,this.betaQ=0*Math.PI/4,this.Vqueue=3.19731,this.el=.0056,this.er=.004,this.alphaQ=.033916,this.betaQ=3.28339,this.Xinit[0]=0,this.Yinit[0]=0,this.Xinit[1]=-.051,this.Yinit[1]=.05,this.Xinit[2]=.05,this.Yinit[2]=.05,this.Vqueue=.4,this.el=0,this.er=0,this.alphaQ=.033916,this.betaQ=-7*Math.PI/8},W=function t(i,s,e,a){var h=this;Object(r.a)(this,t),this.mode_jeu=2,this.ralenti=1,this.largeur_bandes=.28,this.change_billard=function(t){if(h.arret_son(),h.myTimer.stop(),1==t){h.taille(280);var i=!1;h.bitmap_Bandes_310.visible=!1,h.bitmap_Billard_310.visible=i;i=!0;h.bitmap_Bandes_280.visible=!0,h.bitmap_Billard_280.visible=i;i=!1;h.bitmap_Bandes_260.visible=!1,h.bitmap_Billard_260.visible=i}else if(2==t){h.taille(260);i=!1;h.bitmap_Bandes_310.visible=!1,h.bitmap_Billard_310.visible=i;i=!1;h.bitmap_Bandes_280.visible=!1,h.bitmap_Billard_280.visible=i;i=!0;h.bitmap_Bandes_260.visible=!0,h.bitmap_Billard_260.visible=i}else if(0==t){h.taille(310);i=!0;h.bitmap_Bandes_310.visible=!0,h.bitmap_Billard_310.visible=i;i=!1;h.bitmap_Bandes_280.visible=!1,h.bitmap_Billard_280.visible=i;i=!1;h.bitmap_Bandes_260.visible=!1,h.bitmap_Billard_260.visible=i}h.ctrl.XC=h.Ech*h.longueur/2,h.ctrl.YC=h.Ech*h.largeur/2,h.Params.long_billard=2*(h.xmax+h.R),h.Params.larg_billard=2*(h.ymax+h.R),null!=h.Simulateur&&(h.Simulateur.XMAX=h.xmax,h.Simulateur.YMAX=h.ymax,h.Simulateur.XMIN=-h.xmax,h.Simulateur.YMIN=-h.ymax),h.tracer_grille(),h.tracer_lines(),h.Placer_billes_hasard(),h.Params.Vqueue=1,h.init_point()},this.arret_son=function(){},this.init_point=function(){h.arret_son(),h.myTimer.stop(),h.afficher_billes(),h.ctrl.aff_parametres(),h.placer_queue(h.dq0),h.queue.visible=!0,h.calculs_faits=!1,h.aff_trajets=!1,h.trajets.graphics.clear(),h.tracer_ligne_visee(),h.ligne_visee.visible=!0},this.update_modejeu=function(t){h.mode_jeu=t,h.arret_son(),0==t&&(h.Vqmax=3.5),1==t&&(h.Vqmax=3.5),2==t&&(h.Vqmax=4.2),3==t&&(h.Vqmax=3.5),4==t&&(h.Vqmax=3.5),5==t&&(h.Vqmax=5.4)},this.Simuler=function(t,i){return h.ralenti=t,h.arret_son(),h.Simulateur.Calcul(i)},this.taille=function(t){h.taille_billard=t,310==t&&(h.longueur=3.12),280==t&&(h.longueur=2.82),260==t&&(h.longueur=2.62),h.xmax=(h.longueur-h.largeur_bandes)/2-.03,h.ymax=(h.longueur-h.largeur_bandes)/4-.03,h.largeur=2*(h.ymax+.03)+h.largeur_bandes};var n=0;this.Ech=e,this.R=.03,this.Rb=36,this.type=0,this.taille(i),this.Params=new z(2*(this.xmax+this.R),2*(this.ymax+this.R));for(this.ombre=[],this.aff_trajets=!1,this.tous_trajets=!0,this.trajet_bille_joueur=!1,this.trajet_bille_visee=!1,this.billes=[],this.bille_visee=1,this.ecl=[],this.dq0=1.5*this.R*this.Ech,this.alphamin=!0,this.Vqmax=3.5,this.Simulateur=new F(this.xmax,this.ymax),this.ind_last_clef=[],n=0;n<3;)this.ind_last_clef[n]=this.Simulateur.nb_max_clefs*n,n++;for(this.calculs_faits=!1,this.ampl_recul_max=.1,this.RAp0=[],this.RAq0=[],this.RAr0=[],n=0;n<3;)this.RAp0[n]=0,this.RAq0[n]=0,this.RAr0[n]=0,n++;this.alphamin=!1,console.log(this)},k=function t(i,s,e,a,h,n){var o=this;Object(r.a)(this,t),this.getMesh=function(){return o.mesh},this.getPosition=function(){return Object.assign({},o.mesh.position)},this.getVisibility=function(){return o.mesh.visibility},this.updatePosition=function(t,i){o.mesh.position.x=t,o.mesh.position.z=i},this.updateRotation=function(t,i,s){var e=(t-o.RAp0)/.03,a=(i-o.RAq0)/.03,h=(s-o.RAr0)/.03;o.RAp0=t,o.RAq0=i,o.RAr0=s,o.mesh.rotate(M.Axis.X,-e,M.Space.WORLD),o.mesh.rotate(M.Axis.Y,-h,M.Space.WORLD),o.mesh.rotate(M.Axis.Z,-a,M.Space.WORLD)},this.isPotted=function(){return!o.mesh.visibility},this.pot=function(){o.mesh.visibility=!1},this.scene=i,this.mesh=M.Mesh.CreateSphere(s,16,e,this.scene),this.mesh.position.y=a.y,this.mesh.position.x=a.x,this.mesh.position.z=a.z;var l=new M.StandardMaterial("redMat",this.scene);l.diffuseTexture=new M.Texture(h,this.scene),this.mesh.material=l,this.mesh.rotation.y=Math.PI*Math.random(),this.mesh.rotation.x=Math.PI*Math.random(),this.mesh.rotation.z=Math.PI*Math.random(),this.mesh.visibility=n,this.RAp0=0,this.RAq0=0,this.RAr0=0},D=function t(i,s){var e=this;Object(r.a)(this,t),this.getMesh=function(){return e.mesh},this.update=function(t,i){e.mesh.position=t,e.mesh.rotation=i},this.updateDirectionLine=function(t,i){e.directionLine.position=t,e.directionLine.rotation.y=i},this.scene=i,this.mesh=s,this.mesh.position.y=50,this.mesh.position.z=90,this.directionLine=new M.MeshBuilder.CreateLines("direction-line",{points:[new M.Vector3(0,0,0),new M.Vector3(600,0,0)],colors:[new M.Color4(0,0,.8,1),new M.Color4(0,0,.8,1)]})},K=function t(i,s,e){var a=this;Object(r.a)(this,t),this.getMeshes=function(){return a.meshes},this.scene=i,this.meshes=s,console.log("model path",e);var h=!0,n=!1,o=void 0;try{for(var l,c=this.meshes[Symbol.iterator]();!(h=(l=c.next()).done);h=!0){var u=l.value;"carpet"==u.name&&(u.receiveShadows=!0,u.material.bumpTexture=new M.Texture(e+"carpet-specular.png",this.scene),u.material.bumpTexture.level=2,u.material.bumpTexture.uScale=1,u.material.bumpTexture.vScale=1)}}catch(p){n=!0,o=p}finally{try{h||null==c.return||c.return()}finally{if(n)throw o}}},U=150,G=function(){function t(i,s){Object(r.a)(this,t),this.scene=i,this.canvas=s,this.cameras={arcCam:void 0,topCam:void 0,targetCam:void 0},this.cameras.arcCam=new M.ArcRotateCamera("Camera-Arc",4.44,1.05,300,M.Vector3.Zero(),this.scene),this.cameras.arcCam.attachControl(this.canvas),this.cameras.arcCam.upperBetaLimit=1.5,this.cameras.arcCam.lowerBetaLimit=.9,this.cameras.arcCam.wheelPrecision=.2,this.cameras.arcCam.upperRadiusLimit=500,this.cameras.arcCam.lowerRadiusLimit=100,this.cameras.targetCam=new M.ArcRotateCamera("Camera-Target",4.44,1.35,U,M.Vector3.Zero(),this.scene),this.cameras.targetCam.upperRadiusLimit=U,this.cameras.targetCam.lowerRadiusLimit=U,this.cameras.targetCam.upperBetaLimit=1.35,this.cameras.targetCam.lowerBetaLimit=1.35,this.cameras.topCam=new M.ArcRotateCamera("Camera-Top",-Math.PI/2,0,330,M.Vector3.Zero(),this.scene),this.cameras.topCam.upperBetaLimit=0,this.cameras.topCam.lowerBetaLimit=0,this.cameras.topCam.upperAlphaLimit=-Math.PI/2,this.cameras.topCam.lowerAlphaLimit=-Math.PI/2,this.cameras.topCam.upperRadiusLimit=330,this.cameras.topCam.lowerRadiusLimit=330,this.cameras.topCam.mode=M.Camera.ORTHOGRAPHIC_CAMERA,this.cameras.topCam.orthoTop=150,this.cameras.topCam.orthoBottom=-150,this.cameras.topCam.orthoLeft=-300,this.cameras.topCam.orthoRight=300,this.target={position:void 0,rotation:void 0},this.changeView(this.currentView)}return Object(o.a)(t,[{key:"changeView",value:function(t){this.currentView=t,"top"===t?(this.scene.activeCamera=this.cameras.topCam,this.cameras.arcCam.detachControl(this.canvas)):"stand"===t?(this.scene.activeCamera=this.cameras.arcCam,this.cameras.arcCam.attachControl(this.canvas),this.cameras.arcCam.setTarget(M.Vector3.Zero())):"targetting"===t&&(this.scene.activeCamera=this.cameras.targetCam,this.cameras.arcCam.detachControl(this.canvas))}},{key:"updateTarget",value:function(t,i){this.target.position=t,this.target.rotation=i,this.cameras.targetCam.setTarget(new M.Vector3(this.target.position.x,this.target.position.y,this.target.position.z)),this.cameras.targetCam.alpha=-this.target.rotation.y}},{key:"enableControl",value:function(t){0==t?this.cameras.arcCam.detachControl(this.canvas):"stand"==this.currentView&&this.cameras.arcCam.attachControl(this.canvas)}}]),t}(),Z=function(){function t(i,s,e,a,h){var n=this;Object(r.a)(this,t),this.drawBallPath=function(t){var i=n.pathData;if(i&&0!=i.length&&(n.pathCueWhite&&n.pathCueWhite.dispose(),n.pathCueYellow&&n.pathCueYellow.dispose(),n.pathTargetBall&&n.pathTargetBall.dispose(),t)){for(var s=[],e=0;e<1e4;e++)i[e]&&s.push(new M.Vector3(q*i[e].X/n.size,n.ballRadius/2,q*i[e].Y/n.size));n.pathCueWhite=M.MeshBuilder.CreateLines("lines",{points:s},n.scene);var a=[],h=[];for(e=1e4;e<2e4;e++)i[e]&&(a.push(new M.Vector3(q*i[e].X/n.size,n.ballRadius/2,q*i[e].Y/n.size)),h.push(new M.Color4(.8,.8,0,1)));n.pathCueYellow=M.MeshBuilder.CreateLines("lines",{points:a,colors:h},n.scene);var r=[],o=[];for(e=2e4;e<3e4;e++)i[e]&&(r.push(new M.Vector3(q*i[e].X/n.size,n.ballRadius/2,q*i[e].Y/n.size)),o.push(new M.Color4(.8,0,0,1)));n.pathTargetBall=M.MeshBuilder.CreateLines("lines",{points:r,colors:o},n.scene)}},this.configCameras=function(){var t=n;t.cameras=new G(t.scene,t.canvas),t.changeView(t.currentView)},this.loadModels=function(){var t=n,i=n.modelStorePath;M.SceneLoader.ImportMesh("",i,N,t.scene,function(s){t.objects.bat=new D(t.scene,s[0]),M.SceneLoader.ImportMesh("",i,y,t.scene,function(s){t.objects.table=new K(t.scene,s,i),t.configCueBalls(),t.updateBat(t.controlOptions)})})},this.updateControlOptions=function(t){n.controlOptions=t,n.updateBat(t)},this.updateBat=function(t){var i=t.cueLine,s=t.cueAngle,e=t.sideEnglish,a=t.topSpin,h=n.size,r=n.ballRadius,o=n.cameras,l=n.objects,c=l.bat,u=l.cueBallWhite,p=q*e/h,f=q*a/h,m=u.getPosition();c.update({x:m.x-p*Math.sin(i)-f*Math.sin(s)*Math.cos(i),z:m.z+p*Math.cos(i)-f*Math.sin(s)*Math.sin(i),y:r/2+f*Math.cos(s)},{x:0,y:-i,z:Math.PI/2+s}),c.updateDirectionLine(m,Math.PI-i),o.updateTarget({x:m.x-p*Math.sin(i)-f*Math.sin(s)*Math.cos(i),z:m.z+p*Math.cos(i)-f*Math.sin(s)*Math.sin(i),y:r/2+f*Math.cos(s)},{x:0,y:-i,z:Math.PI/2+s}),o.changeView(n.currentView)},this.generateReflectionMaterial=function(t,i){for(var s=n.scene,e=new M.ReflectionProbe("satelliteProbe"+t.name,512,s),a=0;a<i.length;a++)e.renderList.push(i[a]);t.material.reflectionTexture=e.cubeTexture,t.material.reflectivityColor=new M.Color3(.2,.2,.2),t.material.reflectionFresnelParameters=new M.FresnelParameters,t.material.reflectionFresnelParameters.bias=0,e.attachToMesh(t)},this.configCueBalls=function(){var t=n,i=n.modelStorePath,s=n.ballRadius,e=(n.objects.table,n.ballPositions),a=e.posCueBallWhite,h=e.posCueBallYellow,r=e.posTargetBall;t.objects.cueBallWhite=new k(t.scene,"cue-ball-white",s,{x:a.x,y:s/2,z:a.z},i+"cueball-white.jpg",!0),t.objects.cueBallYellow=new k(t.scene,"cue-ball-yellow",s,{x:h.x,y:s/2,z:h.z},i+"cueball-yellow.jpg",!0),t.objects.targetBall=new k(t.scene,"cue-ball-red",s,{x:r.x,y:s/2,z:r.z},i+"targetball.jpg",!0)},this.configGrids=function(){for(var t=n,i=[new M.Color4(.7,.7,.7,1),new M.Color4(.7,.7,.7,1)],s=0;s<15;s++){var e=[new M.Vector3(7*-q/16+s*q/16,2,-q/4),new M.Vector3(7*-q/16+s*q/16,2,q/4)];t.grids.push(M.MeshBuilder.CreateLines("lines",{points:e,colors:i},t.scene))}for(s=0;s<7;s++){var a=[new M.Vector3(-q/2,2,3*-q/16+s*q/16),new M.Vector3(q/2,2,3*-q/16+s*q/16)];t.grids.push(M.MeshBuilder.CreateLines("lines",{points:a,colors:i},t.scene))}},this.toggleGrids=function(t){for(var i=n.grids,s=0;s<i.length;s++)i[s].visibility=t},this.initializeScene=function(t,i){var s=n;s.scene=t,s.canvas=i,s.scene.clearColor=new M.Color3(.05,.05,.05),new M.HemisphericLight("light",M.Vector3.Up(),t),s.configCameras(),s.loadModels(),s.configGrids(),s.scene.getEngine().runRenderLoop(function(){t&&(t.render(),s.animateBalls())}),i.addEventListener("pointerdown",s.onPointerDown,!1),i.addEventListener("pointerup",s.onPointerUp,!1),i.addEventListener("pointermove",s.onPointerMove,!1)},this.getGroundPosition=function(){var t=n.scene,i=t.pick(t.pointerX,t.pointerY,function(t){return"carpet"==t.name});return i.hit?i.pickedPoint:null},this.onPointerDown=function(t){var i=n,s=n.scene;if(0===t.button){var e=s.pick(s.pointerX,s.pointerY,function(t){return"cue-ball-white"===t.name||"cue-ball-yellow"===t.name||"cue-ball-red"===t.name});e.hit&&(i.currentMesh=e.pickedMesh,i.startingPoint=i.getGroundPosition(t),i.startingPoint&&setTimeout(function(){i.cameras.enableControl(!1)},0))}},this.onPointerUp=function(){var t=n;if(n.startingPoint)return t.cameras.enableControl(!0),t.startingPoint=null,void(t.currentMesh=null)},this.onPointerMove=function(t){var i=n,s=n.startingPoint,e=n.currentMesh;if(s){var a=i.getGroundPosition(t);a&&(e.position=a,e.position.y=i.ballRadius/2,s=a,i.updateBat(i.controlOptions))}},this.moveAndRotateBall=function(t,i,s){var e,a=-1,h=n;for(e=1e4*s;e<1e4*(s+1)&&h.pathData[e];e++)h.pathData[e].time<i-h.t0&&(a=e);if(a>=0){var r=h.pathData[a],o=q*r.X/h.size,l=q*r.Y/h.size;return t.updatePosition(o,l),t.updateRotation(h.pathData[a].RAp,h.pathData[a].RAq,h.pathData[a].RAr),a!=e-1}},this.animateBalls=function(){var t=n,i=n.objects,s=i.cueBallWhite,e=i.cueBallYellow,a=i.targetBall;if(t.pathData&&0!=t.pathData.length&&void 0!=t.t0){var h=(new Date).getTime()/1e3,r=n.moveAndRotateBall(s,h,0),o=n.moveAndRotateBall(e,h,1),l=n.moveAndRotateBall(a,h,2);console.log(r,o,l),0==r&&0==o&&0==l&&(t.pathData=[])}},this.playSimulation=function(){var t=n,i=n.controlOptions,s=n.objects,e=s.cueBallWhite,a=s.cueBallYellow,h=s.targetBall,r=n.billard.Simuler(1,{Xinit:[t.size*e.getPosition().x/q,t.size*a.getPosition().x/q,t.size*h.getPosition().x/q],Yinit:[t.size*e.getPosition().z/q,t.size*a.getPosition().z/q,t.size*h.getPosition().z/q],RApInit:[0,0,0],RAqInit:[0,0,0],RArInit:[0,0,0],el:i.sideEnglish,er:i.topSpin,alphaQ:i.cueAngle,betaQ:i.cueLine,Vqueue:i.speed});console.log(r),r&&0!=r.length&&(n.pathData=r,n.t0=(new Date).getTime()/1e3)},this.scene=void 0,this.canvas=void 0,this.size=i,this.ballRadius=400*x/(100*this.size),this.modelStorePath=s,this.initBallPosition=a,this.ballPositions={posCueBallWhite:{x:q*a.posCueBallWhite.x/i,z:q*a.posCueBallWhite.z/i},posCueBallYellow:{x:q*a.posCueBallYellow.x/i,z:q*a.posCueBallYellow.z/i},posTargetBall:{x:q*a.posTargetBall.x/i,z:q*a.posTargetBall.z/i}},this.currentView=e,this.cameras=void 0,this.objects={table:void 0,bat:void 0,cueBallWhite:void 0,cueBallYellow:void 0,targetBall:void 0,batContactLine:void 0,batLookatPoint:void 0,directionLine:void 0},this.controlOptions=h,this.grids=[],this.pathCueWhite=void 0,this.pathCueYellow=void 0,this.pathTargetBall=void 0,this.billard=new W(310,void 0,300),this.timerCount=0,this.RAp0=[0,0,0],this.RAq0=[0,0,0],this.RAr0=[0,0,0]}return Object(o.a)(t,[{key:"changeView",value:function(t){this.currentView=t,this.cameras.changeView(t)}}]),t}(),J=function(t){function i(t){var s;return Object(r.a)(this,i),(s=Object(l.a)(this,Object(c.a)(i).call(this,t))).meshPicked=function(t){},s.drawBallPath=function(t){s.board.drawBallPath(t)},s.onSceneMount=function(t){var i=t.canvas,e=t.scene;s.board.initializeScene(e,i)},s.toggleGrids=function(t){s.board.toggleGrids(t)},s.playSimulation=function(){s.board.playSimulation()},s.updateControlOptions=function(t){s.board.updateControlOptions(t)},s.componentDidMount=function(){},s.state={showPath:!1},s.board=new Z(s.props.size,s.props.modelStorePath,s.props.currentView,{posCueBallWhite:{x:s.props.posCueBallWhite.x,z:s.props.posCueBallWhite.z},posCueBallYellow:{x:s.props.posCueBallYellow.x,z:s.props.posCueBallYellow.z},posTargetBall:{x:s.props.posTargetBall.x,z:s.props.posTargetBall.z}},{cueLine:s.props.cueLine,cueAngle:s.props.cueAngle,sideEnglish:s.props.sideEnglish,topSpin:s.props.topSpin,speed:s.props.speed}),s.simulatorDom=new a.a.createRef,s}return Object(u.a)(i,t),Object(o.a)(i,[{key:"changeView",value:function(t){this.board.changeView(t)}},{key:"render",value:function(){return a.a.createElement(g.a,{canvasId:"carom-simulator-canvas"},a.a.createElement(g.b,{onMeshPicked:this.meshPicked,onSceneMount:this.onSceneMount}))}}]),i}(a.a.Component),H=s(21),$=s.n(H),tt=(s(36),function(t){function i(t){var s;return Object(r.a)(this,i),(s=Object(l.a)(this,Object(c.a)(i).call(this,t))).componentWillReceiveProps=function(t){var i=t.value;s.setState({value:i})},s.updateValue=function(t){s.setState({value:t}),s.props.onUpdate(s.props.itemKey,t)},s.onChangeValue=function(t){var i=t.target.value;s.updateValue(i)},s.onMinusPressed=function(){var t=s.state.value,i=s.props,e=i.min,a=i.step;void 0===a&&(a=.1),(t=(10*t-(a*=10))/10)<e&&(t=e),s.updateValue(t)},s.onPlusPressed=function(){var t=s.state.value,i=s.props,e=i.max,a=i.step;void 0===a&&(a=.1),(t=(10*t+(a*=10))/10)>e&&(t=e),s.updateValue(t)},s}return Object(u.a)(i,t),Object(o.a)(i,[{key:"render",value:function(){var t=this.props.value,i=this.props,s=i.containerClass,e=i.label,h=i.min,n=i.max,r=i.unitDom,o=i.step,l=i.vertical,c=i.width,u=i.sliderStyle;void 0===o&&(o=.1);var m="slider";return l&&(m+=" vertical"),a.a.createElement("div",{className:s,style:{width:c||"inherit"}},a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("span",{style:{flex:1,textAlign:"center"}},e,a.a.createElement("span",null," : ",t,r))),a.a.createElement("div",{style:{display:"flex"}},a.a.createElement(p.a,{icon:f.d,className:"btn-change-value",onClick:this.onMinusPressed}),a.a.createElement("input",{type:"range",min:h,max:n,value:t,className:m,style:u,step:o,onChange:this.onChangeValue}),a.a.createElement(p.a,{icon:f.f,className:"btn-change-value",onClick:this.onPlusPressed})))}}]),i}(a.a.Component)),it=(s(37),52.5),st=15,et=function(t){function i(t){var s;return Object(r.a)(this,i),(s=Object(l.a)(this,Object(c.a)(i).call(this,t))).checkRadialBounding=function(t,i){return Math.sqrt(Math.pow(t,2)+Math.pow(i,2))<st},s.updateTipPosition=function(t){var i=t.pageX,e=t.pageY,a=s.domBallImage.current.getBoundingClientRect();i-=a.x,e-=a.y;var h=(i/s.state.ballImageSize-.5)*it;h=Math.round(10*h)/10;var n=(.5-e/s.state.ballImageSize)*it;if(n=Math.round(10*n)/10,s.checkRadialBounding(h,n))s.setState({tipPositionLeft:i,tipPositionTop:e,sideEnglish:h,topSpin:n}),s.dispatchUpdateEvent();else{i-=s.state.ballImageSize/2,e-=s.state.ballImageSize/2;var r=Math.sqrt(i*i+e*e);h=st*Math.cos(Math.acos(i/r)),h=Math.round(10*h)/10,n=st*Math.sin(-Math.asin(e/r)),n=Math.round(10*n)/10;var o=(h/it+.5)*s.state.ballImageSize-6,l=(.5-n/it)*s.state.ballImageSize-6;s.setState({tipPositionLeft:o,tipPositionTop:l,sideEnglish:h,topSpin:n}),s.dispatchUpdateEvent()}},s.dispatchUpdateEvent=function(){var t=Object.assign({},s.state);t.cueLine=Math.PI*t.cueLine/180,t.cueAngle=Math.PI*t.cueAngle/180,t.sideEnglish/=1e3,t.topSpin/=1e3,t.speed/=100,s.props.onControlOptionsUpdated(t)},s.onInputSliderUpdated=function(t,i){var e=Object.assign({},s.state);e[t]=parseFloat(i),s.checkRadialBounding(e.sideEnglish,e.topSpin)&&(s.setState(e),s.dispatchUpdateEvent())},s.state={ballImageSize:180,cueLine:Math.round(1800*s.props.cueLine/Math.PI)/10,cueAngle:Math.round(1800*s.props.cueAngle/Math.PI)/10,sideEnglish:Math.round(1e4*s.props.sideEnglish)/10,topSpin:Math.round(1e4*s.props.topSpin)/10,speed:Math.round(100*s.props.speed),tipPositionLeft:0,tipPositionTop:0,isPointerDown:!1},s.domBallImage=new a.a.createRef,s}return Object(u.a)(i,t),Object(o.a)(i,[{key:"render",value:function(){var t=this,i=this.state,s=i.ballImageSize,e=i.tipPositionLeft,h=i.tipPositionTop,n=i.isPointerDown,r=this.state,o=r.cueLine,l=r.cueAngle,c=r.sideEnglish,u=r.topSpin,m=r.speed,R=this.props,d=R.showGrid,b=R.showPath,V="toggle-btn",_="toggle-btn";!0===d&&(V+=" active"),!0===b&&(_+=" active");var v=0,g=0;return n?(g=e-6,v=h-6):(g=(c/it+.5)*s-6,v=(.5-u/it)*s-6),a.a.createElement("div",{className:"controller-collection"},a.a.createElement("div",{className:"common-controller-container"},a.a.createElement(p.a,{className:V,icon:f.h,onClick:function(){t.props.onToggleShowGrid(!d)}}),a.a.createElement(p.a,{className:_,icon:f.b,onClick:function(){t.props.onToggleShowPath(!b)}}),a.a.createElement(p.a,{className:"toggle-btn",icon:f.j})),a.a.createElement("div",{className:"angle-selector-container"},a.a.createElement(tt,{label:"Cue Line",containerClass:"slider-container",min:0,max:360,width:400,value:o,unitDom:a.a.createElement("sup",null,"o"),itemKey:"cueLine",onUpdate:this.onInputSliderUpdated}),a.a.createElement(tt,{label:"Cue Angle",containerClass:"slider-container",min:2,max:89,value:l,unitDom:a.a.createElement("sup",null,"o"),itemKey:"cueAngle",onUpdate:this.onInputSliderUpdated})),a.a.createElement("div",{className:"tip-controller-container"},a.a.createElement("div",{className:"tip-position-visualizer",style:{width:s}},a.a.createElement("img",{ref:this.domBallImage,src:$.a,style:{width:s},draggable:!1,onPointerUp:function(i){t.setState({isPointerDown:!1}),t.updateTipPosition(i)},onPointerMove:function(i){t.state.isPointerDown&&t.updateTipPosition(i)},onMouseDown:function(i){t.setState({isPointerDown:!0}),t.updateTipPosition(i)}}),a.a.createElement("div",{className:"tip-position",style:{top:v,left:g}})),a.a.createElement(tt,{label:"Side English",containerClass:"slider-container",min:-15.1,max:15.1,width:s,value:c,unitDom:a.a.createElement("span",null,"mm"),itemKey:"sideEnglish",onUpdate:this.onInputSliderUpdated}),a.a.createElement("br",null),a.a.createElement(tt,{label:"Top Spin",containerClass:"slider-container",min:-15.1,max:15.1,width:s,value:u,unitDom:a.a.createElement("span",null,"mm"),itemKey:"topSpin",onUpdate:this.onInputSliderUpdated})),a.a.createElement("div",{className:"play-controller-container"},a.a.createElement(tt,{label:"Speed",containerClass:"slider-container",width:300,min:0,max:450,value:m,step:1,unitDom:a.a.createElement("span",null,"cm/s"),itemKey:"speed",onUpdate:this.onInputSliderUpdated}),a.a.createElement(p.a,{className:"play-controller",icon:f.a}),a.a.createElement(p.a,{className:"play-controller",icon:f.g}),a.a.createElement(p.a,{className:"play-controller",icon:f.e,onClick:this.props.onPlayPressed}),a.a.createElement(p.a,{className:"play-controller",icon:f.c})))}}]),i}(a.a.Component),at=function(t){function i(){var t;return Object(r.a)(this,i),(t=Object(l.a)(this,Object(c.a)(i).call(this))).componentWillMount=function(){t.updateSimulateInfo()},t.updateSimulateInfo=function(){var i=["Santiago  Soto Sanchez","...","0","310","2","1","1.1661666666666661","0.6288333333333332","0.8181666666666672","0.5041666666666665","-0.6036666666666667","-0.003833333333333161","4.015999999999998","0.520497057626843","0.21066799020683835","-0.0013500000000002585","-0.0146999999999997"],s={size:2.8,cueLine:parseFloat(i[B]),cueAngle:parseFloat(i[I]),sideEnglish:parseFloat(i[Q]),topSpin:parseFloat(i[L]),speed:parseFloat(i[T]),posCueBallWhite:{x:parseFloat(i[P]),z:parseFloat(i[w])},posCueBallYellow:{x:parseFloat(i[X]),z:parseFloat(i[C])},posTargetBall:{x:parseFloat(i[E]),z:parseFloat(i[S])}};t.setState(s)},t.viewSelectorItemClicked=function(i){t.setState({currentView:i}),t.simulator.current.changeView(i)},t.onToggleShowGrid=function(i){t.setState({showGrid:i}),t.simulator.current.toggleGrids(i)},t.onToggleShowPath=function(i){t.setState({showPath:i}),t.simulator.current.drawBallPath(i)},t.onPlayPressed=function(){t.simulator.current.playSimulation()},t.onControlOptionsUpdated=function(i){t.simulator.current.updateControlOptions(i)},t.componentDidMount=function(){},t.state={currentView:"top",showGrid:!0,showPath:!1,size:310,cueLine:30,cueAngle:5,sideEnglish:-8.7,topSpin:7.5,speed:380,posCueBallWhite:{},posCueBallYellow:{},posTargetBall:{}},t.simulator=a.a.createRef(),t}return Object(u.a)(i,t),Object(o.a)(i,[{key:"render",value:function(){var t=this.state,i=t.currentView,s=t.showGrid,e=t.showPath,h=t.size,n=t.cueLine,r=t.cueAngle,o=t.sideEnglish,l=t.topSpin,c=t.speed,u=t.posCueBallWhite,p=t.posCueBallYellow,f=t.posTargetBall;return a.a.createElement("div",{style:{position:"relative"}},a.a.createElement(v,{currentView:i,viewSelectorItemClicked:this.viewSelectorItemClicked}),a.a.createElement(J,{modelStorePath:this.props.modelStorePath,ref:this.simulator,size:h,currentView:i,cueLine:n,cueAngle:r,sideEnglish:o,topSpin:l,speed:c,posCueBallWhite:u,posCueBallYellow:p,posTargetBall:f}),a.a.createElement(et,{showGrid:s,showPath:e,cueLine:n,cueAngle:r,sideEnglish:o,topSpin:l,speed:c,onControlOptionsUpdated:this.onControlOptionsUpdated,onToggleShowGrid:this.onToggleShowGrid,onToggleShowPath:this.onToggleShowPath,onPlayPressed:this.onPlayPressed}))}}]),i}(a.a.Component),ht=(s(15),function(){function t(i,s){Object(r.a)(this,t),this.HBande=.035;var e=0,a=0,h=!1;for(this.NBILLES=16,this.long_billard=i,this.larg_billard=s,this.Xinit=[],this.Yinit=[],this.RApInit=[],this.RAqInit=[],this.RArInit=[],this.empocheeInit=[],e=0;e<this.NBILLES;)this.RApInit[e]=0,this.RAqInit[e]=0,this.RArInit[e]=0,e++;for(this.Xinit[0]=0,this.Yinit[0]=-s/4,this.empocheeInit[0]=!1,e=1;e<16;){do{for(this.Xinit[e]=.1*(e-8),this.Yinit[e]=0,h=!0,a=0;a<e&&h;)(this.Xinit[e]-this.Xinit[a])*(this.Xinit[e]-this.Xinit[a])+(this.Yinit[e]-this.Yinit[a])*(this.Yinit[e]-this.Yinit[a])<.004&&(h=!1),a++;this.empocheeInit[e]=!1}while(!h);e++}this.Vqueue=1.5,this.el=0,this.er=0,this.alphaQ=.033916,this.betaQ=-7*Math.PI/8}return Object(o.a)(t,[{key:"direction_beta",value:function(t,i,s){var e,a,h;return h=Math.sqrt((this.Xinit[0]-i)*(this.Xinit[0]-i)+(this.Yinit[0]-s)*(this.Yinit[0]-s)),t*=.06,e=Math.asin(t/h),(a=this.atanjimi(s-this.Yinit[0],i-this.Xinit[0]))-e>Math.PI?a-e-2*Math.PI:a-e<-Math.PI?a-e+2*Math.PI:a-e}},{key:"ToucheBandeX",value:function(t){for(var i,s,e,a,h,n,r,o,l,c,u,p,f,m=NaN,R=NaN;this.betaQ<0;)this.betaQ=this.betaQ+2*Math.PI;for(;this.betaQ>=2*Math.PI;)this.betaQ=this.betaQ-2*Math.PI;return c=this.betaQ,l=t,R=Math.cos(c),f=Math.sin(c),u=Math.cos(l),p=Math.sin(l),h=((o=Math.sqrt(9e-4-this.er*this.er-this.el*this.el))*u-this.er*p)*R-this.el*f,n=o*p+this.er*u,r=(o*u-this.er*p)*f+this.el*R,m=this.Xinit[0]+h,i=.03+n,this.Yinit[0]+r,e=this.long_billard/2,!(Math.abs(R)<1e-5)&&(c>Math.PI/2&&c<3*Math.PI/2&&(R=-R,m=-m),!((a=(e-m)/R)>1.4)&&(s=.006+.009/1.4*a/u,!(a*p/u+i>this.HBande+s/u)))}},{key:"atanjimi",value:function(t,i){var s;return Math.abs(i)<1e-6?t>0?Math.PI/2:-Math.PI/2:(s=Math.atan(t/i),i>0?s:t<0?s-Math.PI:s+Math.PI)}},{key:"Quantite",value:function(){var t,i=0,s=[],e=[];for(t=this.betaQ+Math.PI,i=1;i<this.NBILLES;)s[i]=!1,this.empocheeInit[i]||(this.Xinit[i]-this.Xinit[0])*Math.cos(t)+(this.Yinit[i]-this.Yinit[0])*Math.sin(t)>0&&(e[i]=(this.Yinit[i]-this.Yinit[0])*Math.cos(t)-(this.Xinit[i]-this.Xinit[0])*Math.sin(t),e[i]<.06&&e[i]>-.06&&(s[i]=!0)),i++;this.bille_visee=-1;var a=100;for(i=1;i<this.NBILLES;)s[i]&&(this.Xinit[i]-this.Xinit[0])*(this.Xinit[i]-this.Xinit[0])+(this.Yinit[i]-this.Yinit[0])*(this.Yinit[i]-this.Yinit[0])<a&&(this.bille_visee=i,a=(this.Xinit[i]-this.Xinit[0])*(this.Xinit[i]-this.Xinit[0])+(this.Yinit[i]-this.Yinit[0])*(this.Yinit[i]-this.Yinit[0])),i++;return-1!=this.bille_visee?(this.noba=!0,this.quant=e[this.bille_visee]/2/.03):(this.noba=!1,this.quant=0),this.quant}},{key:"ToucheBille",value:function(t){var i=NaN,s=NaN,e=NaN,a=NaN,h=NaN,n=NaN,r=NaN,o=NaN,l=NaN,c=NaN,u=NaN,p=0,f=t,m=this.betaQ;for(p=1;p<this.NBILLES;){for(i=this.Xinit[0]+.032*Math.cos(m)*Math.cos(f)-this.el*Math.sin(m)-this.er*Math.sin(f)*Math.cos(m),s=.03+.032*Math.sin(f)+this.er*Math.cos(f),e=this.Yinit[0]+.032*Math.sin(m)*Math.cos(f)+this.el*Math.cos(m)-this.er*Math.sin(f)*Math.sin(m),n=this.Xinit[p],r=.03,o=this.Yinit[p],h=0;h<1.4;){if(a=.006+.009/1.4*h,((l=i+h*Math.cos(f)*Math.cos(m))-n)*(l-n)+((c=s+h*Math.sin(f))-r)*(c-r)+((u=e+h*Math.cos(f)*Math.sin(m))-o)*(u-o)<(.03+a+.002)*(.03+a+.002))return!0;h+=.01}p++}return!1}},{key:"ToucheBandeZ",value:function(t){for(var i,s,e,a,h,n,r,o,l,c,u,p,f,m=NaN,R=NaN;this.betaQ<0;)this.betaQ=this.betaQ+2*Math.PI;for(;this.betaQ>=2*Math.PI;)this.betaQ=this.betaQ-2*Math.PI;return c=this.betaQ,l=t,f=Math.cos(c),R=Math.sin(c),u=Math.cos(l),p=Math.sin(l),h=((o=Math.sqrt(9e-4-this.er*this.er-this.el*this.el))*u-this.er*p)*f-this.el*R,n=o*p+this.er*u,r=(o*u-this.er*p)*R+this.el*f,this.Xinit[0]+h,i=.03+n,m=this.Yinit[0]+r,e=this.larg_billard/2,!(Math.abs(R)<1e-5)&&(c>Math.PI&&(R=-R,m=-m),!((a=(e-m)/R)>1.4)&&(s=.006+.009/1.4*a/u,!(a*p/u+i>this.HBande+s/u)))}},{key:"AlphaQmin",value:function(){for(var t=0;this.ToucheBandeZ(t)||this.ToucheBandeX(t)||this.ToucheBille(t);)t+=Math.PI/90;return t}}]),t}()),nt=function t(){Object(r.a)(this,t),this.played=!1},rt=function t(){Object(r.a)(this,t)},ot=function(){function t(i,s){Object(r.a)(this,t),this.b1=-.96912,this.b3=.76856,this.RSG=1,this.RTROU=.0533,this.fgpas=.00225,this.frpas=63e-6,this.EPSILON_COIN=.8,this.XTROU2=0,this.QCQ=2,this.Rfppas=135e-6,this.f1=.375,this.f2=.61,this.fbille=.075,this.Rfp=.225,this.pas=5e-4,this.fp1=.3,this.ARRET=0,this.angle_poche_coin=.890118,this.fg=3.75,this.YTROU=.652,this.angle_poche_centrale=-.244346,this.fr=.09,this.XC=-1.1867,this.EMPOCHEE=4,this.XE=-.0633,this.XF=-.03333,this.XB=-1.2467,this.XA=-1.27,this.delta_fgpas=.00786,this.YB=.57055,this.YC=.635,this.YF=.635,this.YA=.55167,this.YTROU2=.6883,this.YE=.635,this.XTROU=-1.2867,this.EPSILON=.86,this.TSP=3,this.a3=4.0108,this.a1=-1.235,this.a2=-.80978;var e=0;for(this.XD=this.XC-.03*Math.sin(39*Math.PI/180),this.YD=this.YC-.03*Math.cos(39*Math.PI/180),this.b2=this.YD-this.a2*this.XD,this.XMAX=i,this.YMAX=s,this.XMIN=-i,this.YMIN=-s,this.nb_max_clefs=1e4,this.nb_clefs=[],e=0;e<16;)this.nb_clefs[e]=0,e++;this.evts=[],this.nb_max_sons=100,this.nb_sons=0,this.evts_son=[],this.sorties=[],this.eff_s=[],this.etat=[],this.X0=[],this.Y0=[],this.X=[],this.Y=[],this.Xfin=[],this.Yfin=[],this.RAp=[],this.RAq=[],this.RAr=[],this.RAp0=[],this.RAq0=[],this.RAr0=[],this.RApfin=[],this.RAqfin=[],this.RArfin=[],this.empochee_fin=[],this.Vx=[],this.Vy=[],this.Rp=[],this.Rq=[],this.Rr=[],this.VQx=[],this.VQy=[],this.etat=[],this.time_empochee=[],this.immobile=[],this.date_arret=[],this.D=.06,this.R=.03,this.RendementChoc=.8,this.deltaclefRot=this.R*Math.PI/10,this.resolution=.01,this.done=!1,this.sorties[0]=0,this.sorties[1]=0,this.sorties[2]=0,this.sorties[3]=7.5,this.sorties[4]=7.5,this.sorties[5]=7.5,this.sorties[6]=16,this.sorties[7]=16,this.sorties[8]=16,this.sorties[9]=33,this.sorties[10]=32,this.sorties[11]=23.5,this.sorties[12]=52,this.sorties[13]=43,this.sorties[14]=31,this.sorties[15]=72,this.sorties[16]=53,this.sorties[17]=35,this.sorties[18]=86,this.sorties[19]=60,this.sorties[20]=38,this.sorties[21]=100,this.sorties[22]=69,this.sorties[23]=44,this.sorties[24]=108,this.sorties[25]=79,this.sorties[26]=53,this.sorties[27]=120,this.sorties[28]=90,this.sorties[29]=60,this.eff_s[0]=-1.5,this.eff_s[1]=0,this.eff_s[2]=1.5,this.eff_s[3]=-1.5,this.eff_s[4]=.5,this.eff_s[5]=1.2,this.eff_s[6]=-1.3,this.eff_s[7]=.7,this.eff_s[8]=1.3,this.eff_s[9]=-.5,this.eff_s[10]=1.3,this.eff_s[11]=1.2,this.eff_s[12]=-.5,this.eff_s[13]=1.3,this.eff_s[14]=1.1,this.eff_s[15]=-.3,this.eff_s[16]=.8,this.eff_s[17]=1.2,this.eff_s[18]=0,this.eff_s[19]=.7,this.eff_s[20]=1.2,this.eff_s[21]=0,this.eff_s[22]=.5,this.eff_s[23]=1.5,this.eff_s[24]=-.6,this.eff_s[25]=.2,this.eff_s[26]=1.5,this.eff_s[27]=-.65,this.eff_s[28]=0,this.eff_s[29]=1.5}return Object(o.a)(t,[{key:"choc_bande",value:function(t){var i=NaN;return!(this.X[t]>this.XMIN&&this.X[t]<this.XMAX&&this.Y[t]>this.YMIN&&this.Y[t]<this.YMAX)&&(!(this.X[t]<this.XMIN&&this.Vx[t]>0)&&(!(this.X[t]>this.XMAX&&this.Vx[t]<0)&&(!(this.Y[t]>this.YMAX&&this.Vy[t]<0)&&(!(this.Y[t]<this.YMIN&&this.Vy[t]>0)&&(this.etat[t]==this.RSG?(this.Rp[t]=-this.Vy[t],this.Rq[t]=this.Vx[t]):this.etat[t]==this.QCQ&&(this.Rp[t]=-this.Vy[t]+this.VQy[t],this.Rq[t]=this.Vx[t]-this.VQx[t]),this.init_pars(t),this.VMz=this.VT-this.VRr,this.VN0=-this.VN,this.VN=this.VN*-this.EPSILON,this.deltaVN=this.VN0+this.VN,this.intens=this.VN0/20,this.intens>1&&(this.intens=1),this.beta_adh=2/7*Math.sqrt(this.VMz*this.VMz+this.VRq*this.VRq),this.beta_gliss=this.f1*this.deltaVN,Math.abs(this.VMz)<1e-5?this.alpha_bande=Math.PI/2:this.alpha_bande=Math.abs(Math.atan(this.VRq/this.VMz)),i=Math.abs(this.fp1*this.deltaVN),Math.abs(this.VRp)<i?this.VRp=0:this.VRp>0?this.VRp=this.VRp-i:this.VRp=this.VRp+i,i=Math.abs(this.f2*this.deltaVN),this.VRq=this.VRq+i,this.choc_adh(t),this.recup_pars(t),this.VQx[t]=this.Vx[t]-this.Rq[t],this.VQy[t]=this.Vy[t]+this.Rp[t],this.etat[t]=this.QCQ,!0)))))}},{key:"mise_a_jour",value:function(t){var i=NaN,s=NaN,e=NaN,a=NaN,h=NaN;if(this.etat[t]==this.RSG){if((i=Math.sqrt(this.Vx[t]*this.Vx[t]+this.Vy[t]*this.Vy[t]))<this.frpas){var n=0;this.Vy[t]=0,this.Vx[t]=n;n=0;if(this.Rq[t]=0,this.Rp[t]=n,Math.abs(this.Rr[t])<this.Rfppas)return this.date_arret[t]=this.date*this.pas,this.etat[t]=this.ARRET,this.Rr[t]=0,this.add_clef(t),!0;this.etat[t]=this.TSP}this.etat[t]!=this.TSP&&(s=1-this.frpas/i,this.Vx[t]=this.Vx[t]*s,this.Vy[t]=this.Vy[t]*s,this.Rp[t]=-this.Vy[t],this.Rq[t]=this.Vx[t]),Math.abs(this.Rr[t])<this.Rfppas?this.Rr[t]=0:this.Rr[t]>0?this.Rr[t]=this.Rr[t]-this.Rfppas:this.Rr[t]=this.Rr[t]+this.Rfppas}if(this.etat[t]==this.QCQ&&((e=Math.sqrt(this.VQx[t]*this.VQx[t]+this.VQy[t]*this.VQy[t]))<this.delta_fgpas?this.etat[t]=this.RSG:(a=-this.fgpas*this.VQx[t]/e,h=-this.fgpas*this.VQy[t]/e,this.Vx[t]=this.Vx[t]+a,this.Vy[t]=this.Vy[t]+h,s=1-this.delta_fgpas/e,this.VQx[t]=this.VQx[t]*s,this.VQy[t]=this.VQy[t]*s),this.Rp[t]=-this.Vy[t]+this.VQy[t],this.Rq[t]=this.Vx[t]-this.VQx[t],Math.abs(this.Rr[t])<this.Rfppas?this.Rr[t]=0:this.Rr[t]>0?this.Rr[t]=this.Rr[t]-this.Rfppas:this.Rr[t]=this.Rr[t]+this.Rfppas),this.etat[t]==this.TSP){n=0;this.Vy[t]=0,this.Vx[t]=n;n=0;if(this.Rq[t]=0,this.Rp[t]=n,Math.abs(this.Rr[t])<this.Rfppas)return this.Rr[t]=0,this.date_arret[t]=this.date*this.pas,this.etat[t]=this.ARRET,!0;this.Rr[t]>0?this.Rr[t]=this.Rr[t]-2*this.Rfppas:this.Rr[t]=this.Rr[t]+2*this.Rfppas}return this.X[t]=this.X[t]+this.Vx[t]*this.pas,this.Y[t]=this.Y[t]+this.Vy[t]*this.pas,this.RAp[t]=this.RAp[t]+this.Rp[t]*this.pas,this.RAq[t]=this.RAq[t]+this.Rq[t]*this.pas,this.RAr[t]=this.RAr[t]+this.Rr[t]*this.pas,!1}},{key:"choc_adh",value:function(t){var i,s,e=NaN,a=NaN,h=NaN,n=NaN,r=NaN,o=0;e=Math.abs(this.VT)<1e-5?90:180/Math.PI*Math.atan(this.VN0/this.VT),this.effet=100*this.R/2*this.VRr/Math.sqrt(this.VN0*this.VN0+this.VT*this.VT),this.effet<=-1.5?this.effet=-1.499:this.effet>1.5&&(this.effet=1.499),Math.abs(this.VT)<1e-5?a=this.effet>0?this.sorties[28]+(this.sorties[29]-this.sorties[28])*(this.effet/1.5):this.sorties[27]+(this.sorties[28]-this.sorties[27])*(this.effet+1.5)/1.5:(e=180/Math.PI*Math.atan(this.VN0/this.VT),o=parseInt(e/10),a=(h=this.effet>0?this.sorties[3*o+1]+(this.sorties[3*o+2]-this.sorties[3*o+1])*(this.effet/1.5):this.sorties[3*o+0]+(this.sorties[3*o+1]-this.sorties[3*o+0])*(this.effet+1.5)/1.5)+((this.effet>0?this.sorties[3*(o+1)+1]+(this.sorties[3*(o+1)+2]-this.sorties[3*(o+1)+1])*(this.effet/1.5):this.sorties[3*(o+1)+0]+(this.sorties[3*(o+1)+1]-this.sorties[3*(o+1)+0])*(this.effet+1.5)/1.5)-h)/10*(e-10*o)),Math.abs(a-90)<1e-5?this.VT=0:this.VT=a<90?this.VN/Math.tan(a/180*Math.PI):-this.VN*Math.tan((a-90)/180*Math.PI),Math.abs(this.VT)<1e-5?this.effet>0?this.e_s=this.eff_s[28]+(this.eff_s[29]-this.eff_s[28])*(this.effet/1.5):this.e_s=this.eff_s[27]+(this.eff_s[28]-this.eff_s[27])*(this.effet+1.5)/1.5:(this.effet>0?(n=this.eff_s[3*o+1]+(this.eff_s[3*o+2]-this.eff_s[3*o+1])*(this.effet/1.5),r=this.eff_s[3*(o+1)+1]+(this.eff_s[3*(o+1)+2]-this.eff_s[3*(o+1)+1])*(this.effet/1.5)):(n=this.eff_s[3*o+0]+(this.eff_s[3*o+1]-this.eff_s[3*o+0])*(this.effet+1.5)/1.5,r=this.eff_s[3*(o+1)+0]+(this.eff_s[3*(o+1)+1]-this.eff_s[3*(o+1)+0])*(this.effet+1.5)/1.5),this.e_s=n+(r-n)/10*(e-10*o)),s=(5*this.VN+2*this.VRq)/7,i=(5*this.VT-2*this.VRp)/7,this.VRr=.02*this.e_s/this.R*Math.sqrt(s*s+i*i)}},{key:"recup_pars",value:function(t){this.X[t]>this.XMAX&&this.Vx[t]>0&&(this.Vx[t]=-this.VN,this.Rq[t]=-this.VRq,this.Vy[t]>0?(this.Vy[t]=this.VT,this.Rp[t]=this.VRp,this.Rr[t]=-this.VRr):(this.Vy[t]=-this.VT,this.Rp[t]=-this.VRp,this.Rr[t]=this.VRr)),this.X[t]<this.XMIN&&this.Vx[t]<0&&(this.Vx[t]=this.VN,this.Rq[t]=this.VRq,this.Vy[t]>0?(this.Vy[t]=this.VT,this.Rp[t]=this.VRp,this.Rr[t]=this.VRr):(this.Vy[t]=-this.VT,this.Rp[t]=-this.VRp,this.Rr[t]=-this.VRr)),this.Y[t]<this.YMIN&&this.Vy[t]<0&&(this.Vy[t]=this.VN,this.Rp[t]=-this.VRq,this.Vx[t]>0?(this.Vx[t]=this.VT,this.Rq[t]=-this.VRp,this.Rr[t]=-this.VRr):(this.Vx[t]=-this.VT,this.Rq[t]=this.VRp,this.Rr[t]=this.VRr)),this.Y[t]>this.YMAX&&this.Vy[t]>0&&(this.Vy[t]=-this.VN,this.Rp[t]=this.VRq,this.Vx[t]>0?(this.Vx[t]=this.VT,this.Rq[t]=-this.VRp,this.Rr[t]=this.VRr):(this.Vx[t]=-this.VT,this.Rq[t]=this.VRp,this.Rr[t]=-this.VRr))}},{key:"Symetrise_Params",value:function(t,i){1!=i&&4!=i||(this.X[t]=-this.X[t],this.Vx[t]=-this.Vx[t],this.VQx[t]=-this.VQx[t]),3!=i&&4!=i||(this.Y[t]=-this.Y[t],this.Vy[t]=-this.Vy[t],this.VQy[t]=-this.VQy[t])}},{key:"choc_gliss",value:function(t){this.VMz>0?(this.VT=this.VT-this.beta_gliss*Math.cos(this.alpha_bande),this.VRr=this.VRr+2.5*this.beta_gliss*Math.cos(this.alpha_bande)):(this.VT=this.VT+this.beta_gliss*Math.cos(this.alpha_bande),this.VRr=this.VRr-2.5*this.beta_gliss*Math.cos(this.alpha_bande))}},{key:"choc_billes",value:function(t){var i=0,s=0,e=!1,a=NaN,h=NaN,n=0,r=NaN,o=NaN,l=NaN,c=NaN,u=NaN,p=NaN,f=NaN,m=NaN,R=NaN,d=NaN,b=NaN,V=NaN,_=NaN,v=NaN,g=NaN,M=NaN,A=NaN,y=NaN,N=!1,Y=[];for(i=0;i<16;)Y[i]=!1,i++;for(i=0;i<16;){if(this.etat[i]!=this.EMPOCHEE&&!Y[i]){for(e=!1,n=i+1;n<16&&!e;){if(this.etat[n]!=this.EMPOCHEE&&(a=(this.X[i]-this.X[n])*(this.X[i]-this.X[n])+(this.Y[i]-this.Y[n])*(this.Y[i]-this.Y[n]))<this.D*this.D&&(this.etat[i]!=this.ARRET||this.etat[n]!=this.ARRET)&&(this.Vx[i]-this.Vx[n])*(this.X[n]-this.X[i])+(this.Vy[i]-this.Vy[n])*(this.Y[n]-this.Y[i])>0){e=!0;var q=!0;Y[n]=!0,Y[i]=q,s=n,N=!0,t[0]=i,t[1]=s}n++}if(e){q=!1;this.immobile[s]=!1,this.immobile[i]=q,this.add_clef(i),this.add_clef(s),Y[i]=!0,this.etat[i]==this.RSG&&(this.Rp[i]=-this.Vy[i],this.Rq[i]=this.Vx[i]),this.etat[i]==this.QCQ&&(this.Rp[i]=-this.Vy[i]+this.VQy[i],this.Rq[i]=this.Vx[i]-this.VQx[i]),this.etat[i]==this.ARRET&&(this.Rp[i]=0,this.Rq[i]=0),Y[s]=!0,this.etat[s]==this.RSG&&(this.Rp[s]=-this.Vy[s],this.Rq[s]=this.Vx[s]),this.etat[s]==this.QCQ&&(this.Rp[s]=-this.Vy[s]+this.VQy[s],this.Rq[s]=this.Vx[s]-this.VQx[s]),this.etat[s]==this.ARRET&&(this.Rp[s]=0,this.Rq[s]=0),r=(R=this.Vx[i]*(this.X[s]-this.X[i])+this.Vy[i]*(this.Y[s]-this.Y[i]))*(this.X[s]-this.X[i])/a,o=R*(this.Y[s]-this.Y[i])/a,l=this.Vx[i]-r,c=this.Vy[i]-o,u=(d=this.Vx[s]*(this.X[i]-this.X[s])+this.Vy[s]*(this.Y[i]-this.Y[s]))*(this.X[i]-this.X[s])/a,p=d*(this.Y[i]-this.Y[s])/a,f=this.Vx[s]-u,m=this.Vy[s]-p,V=r-u,_=o-p,this.intens=(V*V+_*_)/5,this.intens>1&&(this.intens=1),this.evts_son[this.nb_sons]=new nt,this.evts_son[this.nb_sons].played=!1,this.evts_son[this.nb_sons].temps=this.date*this.pas,this.evts_son[this.nb_sons].intensite=this.intens,this.evts_son[this.nb_sons].type_choc=2;q=this;var x=this.nb_sons+1;q.nb_sons=x,b=r,r=u,u=b,u*=this.RendementChoc,r*=this.RendementChoc,b=o,o=p,p=b,p*=this.RendementChoc,o*=this.RendementChoc,this.Vx[i]=r+l,this.Vy[i]=o+c,this.VQx[i]=this.Vx[i]-this.Rq[i],this.VQy[i]=this.Vy[i]+this.Rp[i],this.etat[s]==this.ARRET&&(this.Vx[s]=.94*this.Vx[s],this.Vy[s]=.94*this.Vy[s],R/=h=Math.sqrt(a),R=Math.abs(R),A=this.fbille*R,v=Math.abs(this.Rp[i]*(this.Y[s]-this.Y[i])-this.Rq[i]*(this.X[s]-this.X[i]))/h,M=(this.Vx[i]*(this.Y[s]-this.Y[i])-this.Vy[i]*(this.X[s]-this.X[i]))/h-this.Rr[i],g=Math.abs(M)<1e-5?Math.PI/2:Math.abs(Math.atan(v/M)),y=(M>0?1:-1)*A*Math.cos(g),this.Rr[s]=2.5*y,this.Rr[i]=this.Rr[i]-2.5*y,f=y*(this.Y[s]-this.Y[i])/h,m=-y*(this.X[s]-this.X[i])/h),this.Vx[s]=u+f,this.Vy[s]=p+m,this.VQx[s]=this.Vx[s]-this.Rq[s],this.VQy[s]=this.Vy[s]+this.Rp[s],this.etat[s]=this.QCQ,this.etat[i]=this.QCQ}}i++}return N}},{key:"fin_parcours",value:function(){var t=0;for(t=0;t<16;){if(this.etat[t]!=this.ARRET&&this.etat[t]!=this.EMPOCHEE){if(!(this.Vx[t]*this.Vx[t]+this.Vy[t]*this.Vy[t]<this.frpas*this.frpas))return!1;if(!(Math.abs(this.Rr[t])<this.Rfppas))return this.etat[t]=this.TSP,!1;this.date_arret[t]=this.date*this.pas,this.etat[t]=this.ARRET;var i=0;this.Vy[t]=0,this.Vx[t]=i;i=0;this.Rr[t]=0,this.Rq[t]=i,this.Rp[t]=i}t++}return!0}},{key:"choc_poche",value:function(t,i){var s,e=NaN;this.etat[t]==this.RSG?(this.Rp[t]=-this.Vy[t],this.Rq[t]=this.Vx[t]):this.etat[t]==this.QCQ&&(this.Rp[t]=-this.Vy[t]+this.VQy[t],this.Rq[t]=this.Vx[t]-this.VQx[t]),e=this.Vx[t]*Math.cos(i)+this.Vy[t]*Math.sin(i),s=-this.Vx[t]*Math.sin(i)+this.Vy[t]*Math.cos(i),e*=-this.EPSILON_COIN,this.Vx[t]=e*Math.cos(i)-s*Math.sin(i),this.Vy[t]=e*Math.sin(i)+s*Math.cos(i),this.VQx[t]=this.Vx[t]-this.Rq[t],this.VQy[t]=this.Vy[t]+this.Rp[t],this.etat[t]=this.QCQ}},{key:"add_clef",value:function(t){var i=this.nb_max_clefs*t+this.nb_clefs[t];this.evts[i]=new rt,this.evts[i].X=this.X[t],this.evts[i].Y=this.Y[t],this.evts[i].RAp=this.RAp[t],this.evts[i].RAq=this.RAq[t],this.evts[i].RAr=this.RAr[t],this.evts[i].time=this.date*this.pas;var s=this.nb_clefs,e=t,a=s[t]+1;s[e]=a,this.X0[t]=this.X[t],this.Y0[t]=this.Y[t],this.RAp0[t]=this.RAp[t],this.RAq0[t]=this.RAq[t],this.RAr0[t]=this.RAr[t]}},{key:"init_pars",value:function(t){this.X[t]>this.XMAX&&this.Vx[t]>0&&(this.VN=-this.Vx[t],this.VRq=-this.Rq[t],this.Vy[t]>0?(this.VT=this.Vy[t],this.VRp=this.Rp[t],this.VRr=-this.Rr[t]):(this.VT=-this.Vy[t],this.VRp=-this.Rp[t],this.VRr=this.Rr[t])),this.X[t]<this.XMIN&&this.Vx[t]<0&&(this.VN=this.Vx[t],this.VRq=this.Rq[t],this.Vy[t]>0?(this.VT=this.Vy[t],this.VRp=this.Rp[t],this.VRr=this.Rr[t]):(this.VT=-this.Vy[t],this.VRp=-this.Rp[t],this.VRr=-this.Rr[t])),this.Y[t]<this.YMIN&&this.Vy[t]<0&&(this.VN=this.Vy[t],this.VRq=-this.Rp[t],this.Vx[t]>0?(this.VT=this.Vx[t],this.VRp=-this.Rq[t],this.VRr=-this.Rr[t]):(this.VT=-this.Vx[t],this.VRp=this.Rq[t],this.VRr=this.Rr[t])),this.Y[t]>this.YMAX&&this.Vy[t]>0&&(this.VN=-this.Vy[t],this.VRq=this.Rp[t],this.Vx[t]>0?(this.VT=this.Vx[t],this.VRp=-this.Rq[t],this.VRr=this.Rr[t]):(this.VT=-this.Vx[t],this.VRp=this.Rq[t],this.VRr=-this.Rr[t]))}},{key:"Calcul",value:function(t){var i,s,e=0,a=0,h=0,n=NaN,r=[0,0];for(e=0;e<16;){for(this.nb_clefs[e]=0,a=0;a<this.nb_max_clefs;)this.evts[this.nb_max_clefs*e+a]=null,a++;e++}for(this.nb_sons=0,e=0;e<this.nb_max_sons;)this.evts_son[e]=null,e++;for(e=0;e<16;)this.X[e]=t.Xinit[e],this.Y[e]=t.Yinit[e],this.RAp[e]=t.RApInit[e],this.RAq[e]=t.RAqInit[e],this.RAr[e]=t.RArInit[e],this.add_clef(e),e++;this.el=t.el,this.er=t.er,this.alph=t.alphaQ,this.beta=t.betaQ,this.vqueue=t.Vqueue,this.calculs_finis=!1,this.nbandes=0,this.done=!1,this.distance13=2,this.first_bille_choquee=0,this.choc12=!1,this.choc13=!1,this.done=!1,this.deltaclef=this.resolution,this.date=0,this.beta=this.beta+Math.PI,this.Vinit=1.4*this.vqueue*Math.cos(this.alph/1.2),i=-2*this.Vinit/Math.cos(this.alph/1.1)*this.er/this.R;var o=Math.PI/20;n=this.alph>o?Math.PI/2/(Math.PI/2-o)*(this.alph-o):0,s=4*this.vqueue*Math.sin(n)*this.el/this.R,this.Vx[0]=this.Vinit*Math.cos(this.beta),this.Vx0=this.Vx[0],this.Vy[0]=this.Vinit*Math.sin(this.beta),this.Vy0=this.Vy[0];var l=i*Math.sin(this.beta)+s*Math.cos(this.beta);this.Rp[0]=i*Math.sin(this.beta)+s*Math.cos(this.beta),this.p0=l;l=-i*Math.cos(this.beta)+s*Math.sin(this.beta);this.Rq[0]=-i*Math.cos(this.beta)+s*Math.sin(this.beta),this.q0=l;l=2*this.el/this.R*this.Vinit;for(this.Rr[0]=2*this.el/this.R*this.Vinit,this.r0=l,this.VQx[0]=this.Vx[0]-this.Rq[0],this.VQy[0]=this.Vy[0]+this.Rp[0],this.etat[0]=this.QCQ,this.time_empochee[0]=1e3,this.immobile[0]=!1,this.date_arret[0]=1e3,e=1;e<16;)this.Vx[e]=0,this.Vy[e]=0,this.VQx[e]=0,this.VQy[e]=0,this.Rp[e]=0,this.Rq[e]=0,this.Rr[e]=0,t.empocheeInit[e]?(this.etat[e]=this.EMPOCHEE,this.time_empochee[e]=0):(this.etat[e]=this.ARRET,this.time_empochee[e]=1e3,this.immobile[e]=!0,this.date_arret[e]=1e3,this.add_clef(e)),e++;this.evts_son[this.nb_sons]=new nt,this.evts_son[this.nb_sons].played=!1,this.evts_son[this.nb_sons].temps=0,this.evts_son[this.nb_sons].intensite=this.Vinit/5.4,this.alph>Math.PI/4?this.evts_son[this.nb_sons].type_choc=0:this.evts_son[this.nb_sons].type_choc=1;l=this;var c=this.nb_sons+1;for(l.nb_sons=c;!this.fin_parcours();){l=this,c=this.date+1;for(l.date=c,this.choc_billes(r),e=0;e<16;){if(this.etat[e]!=this.ARRET&&this.etat[e]!=this.EMPOCHEE){if(1==(h=this.traiter_poches(e))&&this.choc_bande(e)){this.add_clef(e),this.evts_son[this.nb_sons]=new nt,this.evts_son[this.nb_sons].played=!1,this.evts_son[this.nb_sons].temps=this.date*this.pas,this.evts_son[this.nb_sons].intensite=this.intens,this.evts_son[this.nb_sons].type_choc=3;l=this,c=this.nb_sons+1;l.nb_sons=c}if(3==h&&this.add_clef(e),4==h){this.add_clef(e),this.evts_son[this.nb_sons]=new nt,this.evts_son[this.nb_sons].played=!1,this.evts_son[this.nb_sons].temps=this.date*this.pas,this.evts_son[this.nb_sons].intensite=.8,this.evts_son[this.nb_sons].type_choc=4;l=this,c=this.nb_sons+1;l.nb_sons=c}this.mise_a_jour(e)&&this.add_clef(e)}(Math.abs(this.X[e]-this.X0[e])>this.deltaclef||Math.abs(this.Y[e]-this.Y0[e])>this.deltaclef||Math.abs(this.RAp[e]-this.RAp0[e])>this.deltaclefRot||Math.abs(this.RAq[e]-this.RAq0[e])>this.deltaclefRot||Math.abs(this.RAr[e]-this.RAr0[e])>this.deltaclefRot)&&this.add_clef(e),e++}}if(this.fin_parcours()){for(this.calculs_finis=!0,e=0;e<16;)this.Xfin[e]=this.X[e],this.Yfin[e]=this.Y[e],this.RApfin[e]=this.RAp[e],this.RAqfin[e]=this.RAq[e],this.RArfin[e]=this.RAr[e],this.empochee_fin[e]=this.etat[e]==this.EMPOCHEE,this.add_clef(e),e++;this.duree=this.date*this.pas}else for(e=0;e<16;)this.add_clef(e),e++;return this.evts}},{key:"traiter_poches",value:function(t){var i=0,s=NaN,e=NaN,a=NaN,h=NaN;this.X[t]>0&&this.Y[t]>0&&(i=1),this.X[t]<0&&this.Y[t]>0&&(i=2),this.X[t]<0&&this.Y[t]<0&&(i=3),this.X[t]>0&&this.Y[t]<0&&(i=4),this.Symetrise_Params(t,i);var n=0;return Math.sqrt((this.X[t]-this.XTROU)*(this.X[t]-this.XTROU)+(this.Y[t]-this.YTROU)*(this.Y[t]-this.YTROU))<this.RTROU?(this.etat[t]=this.EMPOCHEE,this.time_empochee[t]=this.date*this.pas,n=4,this.Symetrise_Params(t,i),n):Math.sqrt((this.X[t]-this.XTROU2)*(this.X[t]-this.XTROU2)+(this.Y[t]-this.YTROU2)*(this.Y[t]-this.YTROU2))<this.RTROU?(this.etat[t]=this.EMPOCHEE,this.time_empochee[t]=this.date*this.pas,n=4,this.Symetrise_Params(t,i),n):(this.X[t]<this.XMIN&&(this.Y[t]<this.YA&&this.Vx[t]<0?n=1:(s=Math.sqrt((this.X[t]-this.XA)*(this.X[t]-this.XA)+(this.Y[t]-this.YA)*(this.Y[t]-this.YA)),5*Math.PI/180,s<this.R?this.Vx[t]*(this.X[t]-this.XA)+this.Vy[t]*(this.Y[t]-this.YA)<0&&(e=Math.acos((this.X[t]-this.XA)/s),this.choc_poche(t,e),n=3):this.Y[t]>this.YB&&(this.Vy[t]<0||Math.atan(-this.Vy[t]/this.Vx[t])<this.angle_poche_coin)&&this.Y[t]<this.a1*this.X[t]+this.b1?(this.choc_poche(t,Math.PI/2-this.angle_poche_coin),n=3):n=2)),this.Y[t]>this.YMAX&&(this.X[t]>this.XC&&this.X[t]<this.XE&&this.Vy[t]>0?n=1:this.X[t]<this.XC?(a=Math.sqrt((this.X[t]-this.XC)*(this.X[t]-this.XC)+(this.Y[t]-this.YC)*(this.Y[t]-this.YC)))<this.R?this.Vx[t]*(this.X[t]-this.XC)+this.Vy[t]*(this.Y[t]-this.YC)<0&&(e=Math.acos((this.XC-this.X[t])/a),this.choc_poche(t,e),n=3):this.Y[t]>this.YD&&(this.Vx[t]>0||Math.atan(-this.Vy[t]/this.Vx[t])>Math.PI/2-this.angle_poche_coin)&&this.Y[t]>this.a2*this.X[t]+this.b2&&(this.choc_poche(t,this.angle_poche_coin),n=3):this.X[t]>this.XE?(h=Math.sqrt((this.X[t]-this.XE)*(this.X[t]-this.XE)+(this.Y[t]-this.YE)*(this.Y[t]-this.YE)))<this.R&&this.Y[t]<this.YE?this.Vx[t]*(this.X[t]-this.XE)+this.Vy[t]*(this.Y[t]-this.YE)<0&&(e=Math.PI/2+Math.acos((this.YE-this.Y[t])/h),this.choc_poche(t,e),n=3):this.Y[t]>this.YE&&this.Y[t]>this.a3*this.X[t]+this.b3?(this.choc_poche(t,this.angle_poche_centrale),n=3):n=2:n=2),this.Symetrise_Params(t,i),n)}}]),t}(),lt=function(){function t(i,s,e,a){Object(r.a)(this,t),this.mode_jeu=7,this.RAp0=[],this.RAq0=[],this.cl=[],this.RAr0=[],this.ind_last_clef=[],this.ombre=[],this.ralenti=1,this.ecl=[],this.largeur_bandes=.26,this.billes=[];var h=0;this.cl=[],this.Ech=e,this.R=.03,this.Rb=36,this.type=0,this.taille(i),this.Params=new ht(2*(this.xmax+this.R),2*(this.ymax+this.R)),h=0,this.aff_trajets=!1,this.tous_trajets=!0,this.trajet_bille_joueur=!1,this.trajet_bille_visee=!1,this.cl[0]=16777215,this.cl[8]=0,this.cl[9]=16777113,this.cl[1]=16776960,this.cl[10]=10092543,this.cl[2]=255,this.cl[3]=16711680,this.cl[11]=16751001,this.cl[4]=16711935,this.cl[12]=16751103,this.cl[5]=16750848,this.cl[13]=16750950,this.cl[6]=65280,this.cl[14]=10092441,this.cl[7]=6684723,this.cl[15]=10053120,this.billes=[],this.bille_visee=1,this.ecl=[],h=0;for(this.dq0=1.5*this.R*this.Ech,this.alphamin=!0,this.Vqmax=4.2,this.Simulateur=new ot(this.xmax,this.ymax),this.ind_last_clef=[],h=0;h<16;)this.ind_last_clef[h]=this.Simulateur.nb_max_clefs*h,h++;for(this.calculs_faits=!1,this.ampl_recul_max=.1,this.RAp0=[],this.RAq0=[],this.RAr0=[],h=0;h<16;)this.RAp0[h]=0,this.RAq0[h]=0,this.RAr0[h]=0,h++;this.new_seq&&(this.seq.seq_id="",this.seq_origine.seq_id=""),this.alphamin=!1}return Object(o.a)(t,[{key:"tracer_grille",value:function(){var t=0;for(this.grille.graphics.clear(),this.grille.graphics.lineStyle(1,16776960,.2),t=-3;t<4;)this.grille.graphics.moveTo(this.ctrl.XC-this.Ech*(this.xmax+this.R),this.ctrl.YC+t*this.Ech*(this.ymax+this.R)/4),this.grille.graphics.lineTo(this.ctrl.XC+this.Ech*(this.xmax+this.R),this.ctrl.YC+t*this.Ech*(this.ymax+this.R)/4),t++;for(t=-7;t<8;)this.grille.graphics.moveTo(this.ctrl.XC+t*this.Ech*(this.xmax+this.R)/8,this.ctrl.YC+this.Ech*(this.ymax+this.R)),this.grille.graphics.lineTo(this.ctrl.XC+t*this.Ech*(this.xmax+this.R)/8,this.ctrl.YC-this.Ech*(this.ymax+this.R)),t++}},{key:"finir_init",value:function(){this.tracer_ligne_visee(),this.afficher_billes(),this.placer_queue(this.dq0),this.tracer_grille(),this.seq.titre=new String(this.ctrl.msg.msg[5])}},{key:"entier",value:function(t){var i=10*t;return t-(i/=10)>.5?i+1:i}},{key:"remettre_bille",value:function(t){var i=!1,s=0;if(!(9==this.mode_jeu&&t>9)&&!(10==this.mode_jeu&&t>10)){do{for(this.Params.Xinit[t]=2*(Math.random()-.5)*this.xmax,this.Params.Yinit[t]=2*(Math.random()-.5)*this.ymax,i=!0,s=0;s<16&&i;)this.Params.empocheeInit[s]||t==s||(this.Params.Xinit[t]-this.Params.Xinit[s])*(this.Params.Xinit[t]-this.Params.Xinit[s])+(this.Params.Yinit[t]-this.Params.Yinit[s])*(this.Params.Yinit[t]-this.Params.Yinit[s])<.004&&(i=!1),s++}while(!i);this.Params.empocheeInit[t]=!1}}},{key:"placer_queue",value:function(t){var i=-this.Params.betaQ;this.Ech,this.Params.el;this.alphamin?this.Params.alphaQ=NaN:this.Params.alphaQ<NaN&&(this.Params.alphaQ=NaN),this.queue.rotation=180*i/Math.PI,this.queue.scaleX=.25*Math.cos(this.Params.alphaQ)}},{key:"restore_seq",value:function(){var t=0,i=0;if(console.log("avant restore",this.seq.nb_points,this.seq_origine.nb_points),0!=this.seq_origine.nb_points){for(this.seq.nb_points=this.seq_origine.nb_points,this.seq.pt_courant=0,this.seq.auteur=this.seq_origine.auteur,this.seq.titre=this.seq_origine.titre,this.seq.seq_auto=this.seq_origine.seq_auto,this.ctrl.aff_auteur.text=this.seq.auteur,this.ctrl.aff_auteur.setTextFormat(this.ctrl.myFormatJauneKozoomCentre),this.ctrl.aff_titre.visible=!0,t=0;t<this.seq_origine.nb_points;){for(this.seq.points_b[t].taille_billard=this.seq_origine.points_b[t].taille_billard,this.seq.points_b[t].mode_jeu=this.seq_origine.points_b[t].mode_jeu,i=0;i<16;)this.seq.points_b[t].Xinit[i]=this.seq_origine.points_b[t].Xinit[i],this.seq.points_b[t].Yinit[i]=this.seq_origine.points_b[t].Yinit[i],i++;this.seq.points_b[t].Vqueue=this.seq_origine.points_b[t].Vqueue,this.seq.points_b[t].alphaQ=this.seq_origine.points_b[t].alphaQ,this.seq.points_b[t].betaQ=this.seq_origine.points_b[t].betaQ,this.seq.points_b[t].el=this.seq_origine.points_b[t].el,this.seq.points_b[t].er=this.seq_origine.points_b[t].er,t++}console.log("apres restore",this.seq.nb_points,this.seq_origine.nb_points)}}},{key:"Placer_billes_hasard",value:function(){var t=!1,i=0,s=0;for(i=0;i<16;){do{for(this.Params.Xinit[i]=2*(Math.random()-.5)*this.xmax,this.Params.Yinit[i]=2*(Math.random()-.5)*this.ymax,t=!0,s=0;s<i&&t;)(this.Params.Xinit[i]-this.Params.Xinit[s])*(this.Params.Xinit[i]-this.Params.Xinit[s])+(this.Params.Yinit[i]-this.Params.Yinit[s])*(this.Params.Yinit[i]-this.Params.Yinit[s])<.0016&&(t=!1),s++}while(!t);i++}}},{key:"charger_point",value:function(t,i){var s=0;for(s=0;s<16;)this.Params.Xinit[s]=t.Xinit[s],this.Params.Yinit[s]=t.Yinit[s],this.Params.empocheeInit[s]=t.empocheeInit[s],s++;this.Params.alphaQ=t.alphaQ,this.Params.betaQ=t.betaQ,this.Params.Vqueue=t.Vqueue,this.Params.el=t.el,this.Params.er=t.er,this.init_point(),i&&(this.Simulateur.Calcul(this.Params),this.calculs_faits=!0,this.aff_trajets=!0,this.afficher_trajets()),this.ctrl.modif_pt_seq=!1}},{key:"replacer",value:function(){this.arret_son(),this.ctrl.simulation_en_cours=!1,this.myTimer.stop(),this.afficher_billes(),this.placer_queue(this.dq0),this.queue.visible=!0}},{key:"afficher_trajets",value:function(){var t=0;for(t=0;t<16;){var i=!this.Params.empocheeInit[t];this.ombre[t].visible=!this.Params.empocheeInit[t],this.ecl[t].visible=i,this.billes[t].cont_bille.visible=i,t++}if(this.ligne_visee.visible=!0,this.trajets.graphics.clear(),this.tous_trajets||this.trajet_bille_joueur||this.trajet_bille_visee)if(this.calculs_faits||(this.Simulateur.Calcul(this.Params),this.calculs_faits=!0),this.tous_trajets)for(t=0;t<16;)this.aff_trajet_bille(t),t++;else this.trajet_bille_joueur&&this.aff_trajet_bille(0),this.trajet_bille_visee&&this.Params.noba&&this.aff_trajet_bille(this.bille_visee)}},{key:"timerHandler",value:function(t){var i=0,s=0,e=NaN,a=NaN,h=NaN,n=NaN,r=NaN,o=NaN,l=NaN;if(this.date<this.temps_recul)return this.queue.visible=!0,this.dq=this.dq0+this.Ampl_queue*(1-Math.cos(Math.PI*this.date/this.temps_recul)),void this.placer_queue(this.dq);if(this.date<this.t_debut&&(this.queue.visible=!0,this.dq=this.R*this.Ech+(2*this.Ampl_queue+this.dq0-this.R*this.Ech)*Math.cos(Math.PI/2*(this.date-this.temps_recul)/(this.t_debut-this.temps_recul)),this.placer_queue(this.dq)),this.date>this.t_debut+1&&(this.queue.visible=!1),!(this.date<this.t_debut)){if(!this.muet)for(i=this.nb_sons_played;i<this.Simulateur.nb_sons;){if(!this.Simulateur.evts_son[i].played&&this.Simulateur.evts_son[i].temps<this.date-this.t_debut){0==this.Simulateur.evts_son[i].type_choc?(this.canal_queue=this.son_queue_plat.play(0,1),this.trans=this.canal_queue.soundTransform,this.trans.volume=this.Simulateur.evts_son[i].intensite,this.canal_queue.soundTransform=this.trans):1==this.Simulateur.evts_son[i].type_choc?(this.canal_queue=this.son_queue_pique.play(0,1),this.trans=this.canal_queue.soundTransform,this.trans.volume=this.Simulateur.evts_son[i].intensite,this.canal_queue.soundTransform=this.trans):2==this.Simulateur.evts_son[i].type_choc?this.jouer_bille0?(this.canal_bille0=this.son_bille_bille.play(0,1),this.trans=this.canal_bille0.soundTransform,this.trans.volume=this.Simulateur.evts_son[i].intensite,this.canal_bille0.soundTransform=this.trans,null!=this.canal_bille1&&this.canal_bille1.stop(),this.jouer_bille0=!1):(this.canal_bille1=this.son_bille_bille.play(0,1),this.trans=this.canal_bille1.soundTransform,this.trans.volume=this.Simulateur.evts_son[i].intensite,this.canal_bille1.soundTransform=this.trans,null!=this.canal_bille0&&this.canal_bille0.stop(),this.jouer_bille0=!0):3==this.Simulateur.evts_son[i].type_choc?this.jouer_bande0?(this.canal_bande0=this.son_bille_bande.play(0,1),this.trans=this.canal_bande0.soundTransform,this.trans.volume=this.Simulateur.evts_son[i].intensite,this.canal_bande0.soundTransform=this.trans,null!=this.canal_bande1&&this.canal_bande1.stop(),this.jouer_bande0=!1):(this.canal_bande1=this.son_bille_bande.play(0,1),this.trans=this.canal_bande1.soundTransform,this.trans.volume=this.Simulateur.evts_son[i].intensite,this.canal_bande1.soundTransform=this.trans,null!=this.canal_bande0&&this.canal_bande0.stop(),this.jouer_bande0=!0):4==this.Simulateur.evts_son[i].type_choc&&(this.jouer_poche0?(this.canal_poche0=this.son_poche.play(0,1),this.trans=this.canal_poche0.soundTransform,this.trans.volume=this.Simulateur.evts_son[i].intensite,this.canal_poche0.soundTransform=this.trans,null!=this.canal_poche1&&this.canal_poche1.stop(),this.jouer_poche0=!1):(this.canal_poche1=this.son_poche.play(0,1),this.trans=this.canal_poche1.soundTransform,this.trans.volume=this.Simulateur.evts_son[i].intensite,this.canal_poche1.soundTransform=this.trans,null!=this.canal_poche0&&this.canal_poche0.stop(),this.jouer_poche0=!0)),this.Simulateur.evts_son[i].played=!0;var c=this,u=this.nb_sons_played+1;c.nb_sons_played=u}i++}for(i=0;i<16;){if(!this.Simulateur.immobile[i]&&this.Simulateur.date_arret[i]>this.date-this.t_debut)if(this.date-this.t_debut>this.Simulateur.time_empochee[i]){c=!1;this.ombre[i].visible=!1,this.ecl[i].visible=c,this.billes[i].cont_bille.visible=c}else{for(s=this.ind_last_clef[i];null!=this.Simulateur.evts[s+1]&&this.date-this.t_debut>this.Simulateur.evts[s+1].time;)s++;this.ind_last_clef[i]=s,null!=this.Simulateur.evts[s+1]&&(l=(this.date-this.t_debut-this.Simulateur.evts[s].time)/(this.Simulateur.evts[s+1].time-this.Simulateur.evts[s].time),this.billes[i].cont_bille.x=this.ctrl.XC+this.entier(this.Ech*(this.Simulateur.evts[s].X+(this.Simulateur.evts[s+1].X-this.Simulateur.evts[s].X)*l)),this.billes[i].cont_bille.y=this.ctrl.YC-this.entier(this.Ech*(this.Simulateur.evts[s].Y+(this.Simulateur.evts[s+1].Y-this.Simulateur.evts[s].Y)*l)),this.ecl[i].x=this.billes[i].cont_bille.x-this.Rb/4,this.ecl[i].y=this.billes[i].cont_bille.y-this.Rb/4,this.ombre[i].x=this.billes[i].cont_bille.x-this.Rb/3,this.ombre[i].y=this.billes[i].cont_bille.y-this.Rb/3,e=this.Simulateur.evts[s].RAp+(this.Simulateur.evts[s+1].RAp-this.Simulateur.evts[s].RAp)*l,a=this.Simulateur.evts[s].RAq+(this.Simulateur.evts[s+1].RAq-this.Simulateur.evts[s].RAq)*l,h=this.Simulateur.evts[s].RAr+(this.Simulateur.evts[s+1].RAr-this.Simulateur.evts[s].RAr)*l,n=(e-this.RAp0[i])/this.R,r=(a-this.RAq0[i])/this.R,o=(h-this.RAr0[i])/this.R,this.RAp0[i]=e,this.RAq0[i]=a,this.RAr0[i]=h,this.billes[i].tourner_bille(n,r,o))}i++}this.date-this.t_debut>this.Simulateur.duree&&(this.myTimer.stop(),this.aff_trajets=!0,this.afficher_trajets(),this.arret_son(),this.ctrl.FS&&this.replacer()),t.updateAfterEvent()}}},{key:"afficher_billes",value:function(){var t=0;for(t=0;t<16;)this.afficher_une_bille(t),t++}},{key:"replacer_rien",value:function(){var t=0;for(this.arret_son(),this.ctrl.simulation_en_cours=!1,this.myTimer.stop(),t=1;t<16;)this.Params.empocheeInit[t]=!0,t++;this.init_point()}},{key:"aff_trajet_bille",value:function(t){var i=0;for(i=this.Simulateur.nb_max_clefs*t,this.trajets.graphics.lineStyle(2,this.billes[t].couleur,.7),this.trajets.graphics.moveTo(this.ctrl.XC+this.Ech*this.Simulateur.evts[i].X,this.ctrl.YC-this.Ech*this.Simulateur.evts[i].Y);null!=this.Simulateur.evts[i+1];)i+=1,this.trajets.graphics.lineTo(this.ctrl.XC+this.Ech*this.Simulateur.evts[i].X,this.ctrl.YC-this.Ech*this.Simulateur.evts[i].Y)}},{key:"suivant",value:function(){var t=0,i=!1,s=0;for(this.arret_son(),this.ctrl.simulation_en_cours=!1,this.myTimer.stop(),this.calculs_faits||(this.Simulateur.Calcul(this.Params),this.calculs_faits=!0),t=0;t<16;)this.Params.Xinit[t]=this.Simulateur.Xfin[t],this.Params.Yinit[t]=this.Simulateur.Yfin[t],this.Params.RApInit[t]=0,this.Params.RAqInit[t]=0,this.Params.RArInit[t]=0,this.Params.empocheeInit[t]=this.Simulateur.empochee_fin[t],t++;if(this.Params.empocheeInit[0]){this.Params.empocheeInit[0]=!1;do{for(this.Params.Xinit[0]=2*(Math.random()-.5)*this.xmax,this.Params.Yinit[0]=2*(Math.random()-.5)*this.ymax,i=!0,s=1;s<16&&i;)this.Params.empocheeInit[s]||(this.Params.Xinit[0]-this.Params.Xinit[s])*(this.Params.Xinit[0]-this.Params.Xinit[s])+(this.Params.Yinit[0]-this.Params.Yinit[s])*(this.Params.Yinit[0]-this.Params.Yinit[s])<.004&&(i=!1),s++}while(!i)}this.init_point()}},{key:"tracer_ligne_visee",value:function(){var t=NaN,i=NaN,s=NaN,e=NaN,a=NaN,h=NaN;this.ligne_visee.graphics.clear(),this.Params.Quantite();var n=this.Params.betaQ+Math.PI,r=this.Params.Xinit[0],o=this.Params.Yinit[0],l=Math.tan(n);this.Params.noba?(h=Math.sqrt((this.Params.Xinit[this.Params.bille_visee]-r)*(this.Params.Xinit[this.Params.bille_visee]-r)+(this.Params.Yinit[this.Params.bille_visee]-o)*(this.Params.Yinit[this.Params.bille_visee]-o)),0!=Math.cos(n)?(e=r+h*Math.cos(n),a=o+h*Math.sin(n)):Math.sin(n)>0?(e=r,a=o+h):(e=r,a=o-h)):(i=this.largeur/2-.03,Math.cos(n)>0?t=this.longueur/2-.03:Math.cos(n)<0&&(t=-this.longueur/2+.03),0==Math.cos(n)?Math.sin(n)>0?(e=0,a=i):(e=0,a=-i):(s=(t-r)*l+o)>i?(e=r+(i-o)/l,a=i):s<-i?(e=r-(i+o)/l,a=-i):(e=t,a=(t-r)*l+o)),this.ligne_visee.graphics.lineStyle(1,16777215,.4),this.ligne_visee.graphics.moveTo(this.ctrl.XC+this.Ech*r,this.ctrl.YC-this.Ech*o),this.ligne_visee.graphics.lineTo(this.ctrl.XC+this.Ech*e,this.ctrl.YC-this.Ech*a)}},{key:"save_seq",value:function(){var t=0,i=0;for(console.log("avant save_seq",this.seq.nb_points,this.seq_origine.nb_points),this.seq_origine.nb_points=this.seq.nb_points,this.seq_origine.pt_courant=0,this.seq_origine.auteur=this.seq.auteur,this.seq_origine.titre=this.seq.titre,this.seq_origine.seq_auto=this.seq.seq_auto,t=0;t<this.seq.nb_points;){for(this.seq_origine.points_b[t].taille_billard=this.seq.points_b[t].taille_billard,this.seq_origine.points_b[t].mode_jeu=this.seq.points_b[t].mode_jeu,i=0;i<16;)this.seq_origine.points_b[t].Xinit[i]=this.seq.points_b[t].Xinit[i],this.seq_origine.points_b[t].Yinit[i]=this.seq.points_b[t].Yinit[i],i++;this.seq_origine.points_b[t].Vqueue=this.seq.points_b[t].Vqueue,this.seq_origine.points_b[t].alphaQ=this.seq.points_b[t].alphaQ,this.seq_origine.points_b[t].betaQ=this.seq.points_b[t].betaQ,this.seq_origine.points_b[t].el=this.seq.points_b[t].el,this.seq_origine.points_b[t].er=this.seq.points_b[t].er,t++}}},{key:"arret_son",value:function(){null!=this.canal_bille0&&this.canal_bille0.stop(),null!=this.canal_bille1&&this.canal_bille1.stop(),null!=this.canal_bande0&&this.canal_bande0.stop(),null!=this.canal_bande1&&this.canal_bande1.stop()}},{key:"init_point",value:function(){this.ctrl.simulation_en_cours=!1,this.arret_son(),this.myTimer.stop(),this.afficher_billes(),this.ctrl.aff_parametres(),this.placer_queue(this.dq0),this.queue.visible=!0,this.calculs_faits=!1,this.aff_trajets=!1,this.trajets.graphics.clear(),this.tracer_ligne_visee(),this.ligne_visee.visible=!0}},{key:"update_modejeu",value:function(t){var i=0;if(this.mode_jeu=t,this.ctrl.simulation_en_cours=!1,this.myTimer.stop(),7==t)for(i=10;i<16;)this.Params.empocheeInit[i]=!1,i++;if(8==t)for(i=10;i<16;)this.Params.empocheeInit[i]=!1,i++;if(9==t)for(i=10;i<16;)this.Params.empocheeInit[i]=!0,i++;if(10==t)for(i=11;i<16;)this.Params.empocheeInit[i]=!0,i++;this.afficher_billes()}},{key:"replacer_tout",value:function(){var t=0,i=0;for(this.arret_son(),this.ctrl.simulation_en_cours=!1,this.myTimer.stop(),this.mode_jeu<9&&(i=16),9==this.mode_jeu&&(i=10),10==this.mode_jeu&&(i=11),t=0;t<i;)this.Params.empocheeInit[t]&&this.remettre_bille(t),t++;this.init_point()}},{key:"Simuler",value:function(t,i){console.log("simulate");return this.ralenti=t,this.Params=i,this.Simulateur.Calcul(this.Params)}},{key:"taille",value:function(t){this.taille_billard=t,280==t&&(this.longueur=2.8),this.xmax=(this.longueur-this.largeur_bandes)/2-.03,this.ymax=(this.longueur-this.largeur_bandes)/4-.03,this.largeur=2*(this.ymax+.03)+this.largeur_bandes}},{key:"afficher_une_bille",value:function(t){var i=!this.Params.empocheeInit[t];this.ombre[t].visible=!this.Params.empocheeInit[t],this.ecl[t].visible=i,this.billes[t].cont_bille.visible=i,this.billes[t].cont_bille.x=this.ctrl.XC+this.entier(this.Params.Xinit[t]*this.Ech),this.billes[t].cont_bille.y=this.ctrl.YC-this.entier(this.Params.Yinit[t]*this.Ech),this.ombre[t].x=this.billes[t].cont_bille.x-this.Rb/3,this.ombre[t].y=this.billes[t].cont_bille.y-this.Rb/3,this.ecl[t].x=this.billes[t].cont_bille.x-this.Rb/4,this.ecl[t].y=this.billes[t].cont_bille.y-this.Rb/4,this.billes[t].positionner_texture()}}]),t}(),ct=function t(i,s){var e=this;Object(r.a)(this,t),this.getLights=function(){return e.lights},this.registerShadowObjects=function(t){var i=!0,s=!1,a=void 0;try{for(var h,n=e.shadowGenerators[Symbol.iterator]();!(i=(h=n.next()).done);i=!0){var r=h.value,o=!0,l=!1,c=void 0;try{for(var u,p=t[Symbol.iterator]();!(o=(u=p.next()).done);o=!0){var f=u.value;r.getShadowMap().renderList.push(f)}}catch(m){l=!0,c=m}finally{try{o||null==p.return||p.return()}finally{if(l)throw c}}}}catch(m){s=!0,a=m}finally{try{i||null==n.return||n.return()}finally{if(s)throw a}}},this.scene=i,this.lights=[],this.shadowGenerators=[];for(var a=[[-1,-1],[1,-1],[-1,1],[1,1]],h=0;h<a.length;h++){var n=s/2,o=a[h][0]*s/3,l=a[h][1]*s/6,c=new M.SpotLight("spotLight"+h,new M.Vector3(o,n,l),new M.Vector3(0,-1,0),Math.PI,1,i);this.lights.push(c);var u=new M.ShadowGenerator(512,c);u.useBlurExponentialShadowMap=!0,u.useKernelBlur=!0,u.blurKernel=64,u.forceBackFacesOnly=!0,u.getShadowMap().refreshRate=M.RenderTargetTexture.REFRESHRATE_RENDER_ONEVERYFRAME,this.shadowGenerators.push(u)}},ut=function(){function t(i,s,e,a,h){var n=this;Object(r.a)(this,t),this.drawBallPath=function(t){var i=n.pathData;if(i&&0!=i.length){var s=!0,e=!1,a=void 0;try{for(var h,r=n.pathes[Symbol.iterator]();!(s=(h=r.next()).done);s=!0){var o=h.value;o&&o.dispose()}}catch(R){e=!0,a=R}finally{try{s||null==r.return||r.return()}finally{if(e)throw a}}n.pathes=[];var l=[new M.Color4(1,1,1,1),new M.Color4(1,1,0,1),new M.Color4(.1,.2,.6,1),new M.Color4(.9,.2,.1,1),new M.Color4(.6,.1,.5,1),new M.Color4(1,.5,.1,1),new M.Color4(0,.6,.3,1),new M.Color4(.5,.1,.15,1),new M.Color4(0,0,0,1),new M.Color4(1,1,0,1),new M.Color4(.1,.12,.5,1),new M.Color4(.9,.2,.1,1),new M.Color4(.6,.1,.5,1),new M.Color4(.9,.5,0,1),new M.Color4(0,.6,.3,1),new M.Color4(.5,.1,.15,1)];if(t)for(var c=0;c<16;c++){for(var u=[],p=[],f=1e4*c;f<1e4*(c+1);f++)i[f]&&(u.push(new M.Vector3(Y*i[f].X/n.size,n.ballRadius/2,Y*i[f].Y/n.size)),p.push(l[c]));var m=M.MeshBuilder.CreateLines("lines",{points:u,colors:p},n.scene);n.pathes.push(m)}}},this.configCameras=function(){var t=n;t.cameras=new G(t.scene,t.canvas),t.changeView(t.currentView)},this.loadModels=function(){var t=n,i=n.modelStorePath;M.SceneLoader.ImportMesh("",i,N,t.scene,function(s){t.objects.bat=new D(t.scene,s[0]),M.SceneLoader.ImportMesh("",i,A,t.scene,function(s){console.log("generate table objects",i),t.objects.table=new K(t.scene,s,i),t.configCueBalls(),t.updateBat(t.controlOptions)})})},this.updateControlOptions=function(t){n.controlOptions=t,n.updateBat(t)},this.updateBat=function(t){var i=t.cueLine,s=t.cueAngle,e=t.sideEnglish,a=t.topSpin,h=n.size,r=n.ballRadius,o=n.cameras,l=n.objects,c=l.bat,u=l.balls,p=Y*e/h,f=Y*a/h,m=u[0].getPosition();u[0].isPotted()||(c.update({x:m.x-p*Math.sin(i)-f*Math.sin(s)*Math.cos(i),z:m.z+p*Math.cos(i)-f*Math.sin(s)*Math.sin(i),y:r/2+f*Math.cos(s)},{x:0,y:-i,z:Math.PI/2+s}),c.updateDirectionLine(m,Math.PI-i),o.updateTarget({x:m.x-p*Math.sin(i)-f*Math.sin(s)*Math.cos(i),z:m.z+p*Math.cos(i)-f*Math.sin(s)*Math.sin(i),y:r/2+f*Math.cos(s)},{x:0,y:-i,z:Math.PI/2+s}),o.changeView(n.currentView))},this.generateReflectionMaterial=function(t,i){for(var s=n.scene,e=new M.ReflectionProbe("satelliteProbe"+t.name,512,s),a=0;a<i.length;a++)e.renderList.push(i[a]);t.material.reflectionTexture=e.cubeTexture,t.material.reflectivityColor=new M.Color3(.3,.3,.3),t.material.reflectionFresnelParameters=new M.FresnelParameters,t.material.reflectionFresnelParameters.bias=0,e.attachToMesh(t)},this.configCueBalls=function(){var t=n,i=n.modelStorePath,s=n.ballRadius,e=n.ballPositions;t.objects.balls.push(new k(t.scene,"cue-ball-white",s,{x:e[0].x,y:s/2,z:e[0].z},i+"cueball-white.jpg",!0));for(var a=1;a<16;a++)t.objects.balls.push(new k(t.scene,"cue-ball-"+a,s,{x:e[a].x,y:s/2,z:e[a].z},i+"poolball/"+a+".jpg",!e[a].empocheeInit));var h=[];for(a=0;a<16;a++)h.push(t.objects.balls[a].getMesh());t.lights.registerShadowObjects(h)},this.configGrids=function(){for(var t=n,i=[new M.Color4(.7,.7,.7,1),new M.Color4(.7,.7,.7,1)],s=0;s<15;s++){var e=[new M.Vector3(7*-Y/16+s*Y/16,2,-Y/4),new M.Vector3(7*-Y/16+s*Y/16,2,Y/4)];t.grids.push(M.MeshBuilder.CreateLines("lines",{points:e,colors:i},t.scene))}for(s=0;s<7;s++){var a=[new M.Vector3(-Y/2,2,3*-Y/16+s*Y/16),new M.Vector3(Y/2,2,3*-Y/16+s*Y/16)];t.grids.push(M.MeshBuilder.CreateLines("lines",{points:a,colors:i},t.scene))}},this.toggleGrids=function(t){for(var i=n.grids,s=0;s<i.length;s++)i[s].visibility=t},this.initializeScene=function(t,i){var s=n;s.scene=t,s.canvas=i,s.scene.clearColor=new M.Color3(.05,.05,.05),s.lights=new ct(s.scene,Y),s.configCameras(),s.loadModels(),s.configGrids(),s.scene.getEngine().runRenderLoop(function(){t&&(t.render(),s.animateBalls())}),i.addEventListener("pointerdown",s.onPointerDown,!1),i.addEventListener("pointerup",s.onPointerUp,!1),i.addEventListener("pointermove",s.onPointerMove,!1)},this.getGroundPosition=function(){var t=n.scene,i=t.pick(t.pointerX,t.pointerY,function(t){return"carpet"==t.name});return i.hit?i.pickedPoint:null},this.onPointerDown=function(t){var i=n,s=n.scene;n.canvas;if(0===t.button&&"targetting"!=i.currentView){var e=s.pick(s.pointerX,s.pointerY,function(t){return t.name.includes("cue-ball")});e.hit&&(i.currentMesh=e.pickedMesh,i.startingPoint=i.getGroundPosition(t),i.startingPoint&&setTimeout(function(){i.cameras.enableControl(!1)},0))}},this.onPointerUp=function(){var t=n;if(n.startingPoint)return t.cameras.enableControl(!0),t.startingPoint=null,void(t.currentMesh=null)},this.onPointerMove=function(t){var i=n,s=n.startingPoint,e=n.currentMesh;if(s){var a=i.getGroundPosition(t);a&&(Math.abs(a.x)>=Y/2-n.ballRadius/2||Math.abs(a.z)>=Y/4-n.ballRadius/2||(e.position=a,e.position.y=i.ballRadius/2,s=a,i.updateBat(i.controlOptions)))}},this.moveAndRotateBall=function(t,i,s){var e,a=-1,h=n;for(e=1e4*s;e<1e4*(s+1)&&h.pathData[e];e++)h.pathData[e].time<i-h.t0&&(a=e);if(a>=0){var r=h.pathData[a],o=Y*r.X/h.size,l=Y*r.Y/h.size;t.updatePosition(o,l);var c=.6*h.ballRadius,u=Math.sqrt(Math.pow(Y/2-Math.abs(o),2)+Math.pow(Y/4-Math.abs(l),2)),p=Math.sqrt(Math.pow(Math.abs(o),2)+Math.pow(Y/4-Math.abs(l),2));return(u<c||p<c)&&!t.isPotted()&&(console.log("potting"),t.pot()),t.updateRotation(h.pathData[a].RAp,h.pathData[a].RAq,h.pathData[a].RAr),a!=e-1}},this.animateBalls=function(){var t=n,i=n.objects.balls;if(t.pathData&&0!=t.pathData.length&&void 0!=t.t0){for(var s=(new Date).getTime()/1e3,e=0,a=0;a<16;a++){0==n.moveAndRotateBall(i[a],s,a)&&e++}console.log(e),16==e&&(t.pathData=[],setTimeout(function(){t.updateBat(t.controlOptions)},1e3))}},this.playSimulation=function(){var t=n,i=n.controlOptions,s=n.objects.balls,e=[],a=[],h=[],r=!0,o=!1,l=void 0;try{for(var c,u=s[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var p=c.value,f=p.getPosition();e.push(t.size*f.x/Y),a.push(t.size*f.z/Y),h.push(!p.getVisibility())}}catch(R){o=!0,l=R}finally{try{r||null==u.return||u.return()}finally{if(o)throw l}}var m=n.billard.Simuler(1,{Xinit:e,Yinit:a,empocheeInit:h,RApInit:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],RAqInit:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],RArInit:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],el:i.sideEnglish,er:i.topSpin,alphaQ:i.cueAngle,betaQ:i.cueLine,Vqueue:i.speed});m&&0!=m.length&&(n.pathData=m,n.drawBallPath(!0),n.t0=(new Date).getTime()/1e3)},this.scene=void 0,this.canvas=void 0,this.size=i,this.ballRadius=Y*x/(100*this.size),this.modelStorePath=s,this.initBallPosition=a,this.ballPositions=[],console.log("init ball positions",a),console.log(this.ballPositions),this.currentView=e,this.cameras=void 0,this.objects={table:void 0,bat:void 0,balls:[]},this.controlOptions=h,this.grids=[],this.pathes=[],this.billard=new lt(280,void 0,300);for(var o=0;o<16;o++)this.ballPositions.push({x:Y*a.Xinit[o]/i,z:Y*a.Yinit[o]/i,empocheeInit:a.empocheeInit[o]})}return Object(o.a)(t,[{key:"changeView",value:function(t){this.currentView=t,this.cameras.changeView(t)}}]),t}(),pt=function(t){function i(t){var s;return Object(r.a)(this,i),(s=Object(l.a)(this,Object(c.a)(i).call(this,t))).meshPicked=function(t){},s.drawBallPath=function(t){s.board.drawBallPath(t)},s.onSceneMount=function(t){var i=t.canvas,e=t.scene;s.board.initializeScene(e,i)},s.toggleGrids=function(t){s.board.toggleGrids(t)},s.playSimulation=function(){s.board.playSimulation()},s.updateControlOptions=function(t){s.board.updateControlOptions(t)},s.componentDidMount=function(){},s.state={showPath:!1},s.board=new ut(s.props.size,s.props.modelStorePath,s.props.currentView,s.props.points,{cueLine:s.props.cueLine,cueAngle:s.props.cueAngle,sideEnglish:s.props.sideEnglish,topSpin:s.props.topSpin,speed:s.props.speed}),s.simulatorDom=new a.a.createRef,s}return Object(u.a)(i,t),Object(o.a)(i,[{key:"changeView",value:function(t){this.board.changeView(t)}},{key:"render",value:function(){return a.a.createElement(g.a,{canvasId:"carom-simulator-canvas"},a.a.createElement(g.b,{onMeshPicked:this.meshPicked,onSceneMount:this.onSceneMount}))}}]),i}(a.a.Component);a.a.Component;var ft=function(){return a.a.createElement("div",{className:"simulator-container"},a.a.createElement(at,{modelStorePath:"./models/"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.a.render(a.a.createElement(ft,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}],[[22,1,2]]]);
//# sourceMappingURL=main.32f6862f.chunk.js.map